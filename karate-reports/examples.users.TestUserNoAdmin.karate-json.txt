{"failedCount":0,"prefixedPath":"classpath:examples\/users\/TestUserNoAdmin.feature","packageQualifiedName":"examples.users.TestUserNoAdmin","loopIndex":-1,"relativePath":"examples\/users\/TestUserNoAdmin.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":1258000,"millis":1.258,"status":"passed"},"step":{"comments":["# Define a function to introduce a sleep in the test"],"background":true,"line":6,"prefix":"*","index":0,"text":"def wait = function(pause){ java.lang.Thread.sleep(pause) }"},"stepLog":"15:58:00.643 karate.env system property was: prod \n"},{"result":{"nanos":48100,"millis":0.0481,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":1,"text":"url httpUrl"}},{"result":{"nanos":37372100,"millis":37.3721,"status":"passed"},"step":{"comments":["#### Get the idToken for one of the user created by the admin. Datas are read from a JSON file"],"line":13,"prefix":"*","index":0,"text":"def datas = read('signinDatasUserNoAdmin.json')"}},{"result":{"nanos":928619200,"millis":928.6192,"status":"passed"},"step":{"comments":["# Call the feature to sign in the API with the JSON file that contains the user's datas"],"line":16,"prefix":"*","index":1,"text":"def signIn = call read('signin.feature') datas"},"callResults":[{"prefixedPath":"classpath:examples\/users\/signin.feature","loopIndex":-1,"callDepth":1,"description":"","resultDate":"2021-05-17 03:58:10 p. m.","durationMillis":906.0643,"callArg":{"password":"Password_1","clientId":"799hogucm363v55l7dk2n1l5u0","username":"user8@test.com"},"failedCount":0,"packageQualifiedName":"examples.users.signin","relativePath":"examples\/users\/signin.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":37400,"millis":0.0374,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"url httpUrl"}},{"result":{"nanos":5034800,"millis":5.0348,"status":"passed"},"step":{"endLine":14,"line":7,"prefix":"*","docString":"{\n  \t\t\"clientId\": \"#(clientId)\",\n        \"username\": \"#(username)\",\n  \t\t\"password\": \"#(password)\"\n\t}","index":0,"text":"def query ="}},{"result":{"nanos":4531400,"millis":4.5314,"status":"passed"},"step":{"line":15,"prefix":"*","index":1,"text":"print query"},"stepLog":"15:58:00.739 [print] {\n  \"clientId\": \"799hogucm363v55l7dk2n1l5u0\",\n  \"username\": \"user8@test.com\",\n  \"password\": \"Password_1\"\n}\n \n"},{"result":{"nanos":7076000,"millis":7.076,"status":"passed"},"step":{"line":17,"prefix":"Given","index":2,"text":"path '\/auth\/sign-in'"}},{"result":{"nanos":37400,"millis":0.0374,"status":"passed"},"step":{"line":18,"prefix":"And","index":3,"text":"request query"}},{"result":{"nanos":759100,"millis":0.7591,"status":"passed"},"step":{"line":19,"prefix":"And","index":4,"text":"header Content-Type = 'application\/json'"}},{"result":{"nanos":885555400,"millis":885.5554,"status":"passed"},"step":{"line":20,"prefix":"When","index":5,"text":"method post"},"stepLog":"15:58:00.946 request:\n1 > POST https:\/\/pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\/test-qa-estrella-prod\/auth\/sign-in\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 93\n1 > Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/16.0.1)\n1 > Accept-Encoding: gzip,deflate\n{\"password\":\"Password_1\",\"clientId\":\"799hogucm363v55l7dk2n1l5u0\",\"username\":\"user8@test.com\"}\n\n15:58:01.631 response time in milliseconds: 683\n1 < 200\n1 < Content-Type: application\/json\n1 < Content-Length: 3994\n1 < Connection: keep-alive\n1 < Date: Mon, 17 May 2021 13:58:02 GMT\n1 < x-amzn-RequestId: b2020764-9135-408a-8edc-95eacddba6e1\n1 < Access-Control-Allow-Origin: *\n1 < x-amz-apigw-id: fedwhGoJjoEFa0w=\n1 < X-Amzn-Trace-Id: Root=1-60a27669-3ad8f82c07fba3f557918d14\n1 < X-Cache: Miss from cloudfront\n1 < Via: 1.1 dadbd3993b5303886df72c2fdce172ca.cloudfront.net (CloudFront)\n1 < X-Amz-Cf-Pop: MAD51-C2\n1 < X-Amz-Cf-Id: wVApkbQs_C9j8vUb_Enl-eRTSRVSLtHIeSFHssbuw2Uk1YPnyGw_-w==\n{\"expiresIn\":\"3600\",\"idToken\":\"eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw\",\"accessToken\":\"eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjEyNTk4ODEsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTI2MzQ4MSwiaWF0IjoxNjIxMjU5ODgyLCJqdGkiOiI0OWQzZGE2YS0wZjQ1LTRhMTctYWQ3ZC1lZjRlMzYyYzY1OWIiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIn0.MVZWmX1wwxZX4X2r63Om5FBMoDgfw8hv-EXGgmI-Rhvp5DRRJkne1cCYTujavymD62dN8-lROZjqxIhKxtx57bOU560kaAeyq4NBNEh9NOIdWLiB5RHGdoqoDGSwbAKJnQqB2piFDAqoThtEVEIOHkmKFSYYliXyQBWXrtHkDETPwb-i7-upwPCa98q7euTbBYM-mXgP1yGF7zGqAGgFyw7LGNkGOGKQU_kspEsDbnmEtlAMH_LJ3v8_JjRd_tBOJYrmHERTH1IWG1o9jiTKBsuc225MWu6aIB-1H9K7U7QwN5tA-Bcy6pX7M-RnHVmVPWkl30YvyziYkrYUtQt9HQ\",\"tokenType\":\"Bearer\",\"refreshToken\":\"eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.cEIO8gPpGDudi4GhhmY2UGJ3KJOvUCBqqG5SmudulUfLr8iedG38eOMnqgfYOupYexpAiOGi2P_ygsrV_4Ji37eZiuKGIo19iqT1ztD13PPdWEf7eXdyKtwL4d19fPHiLtcGIV6LKdNCRUoB1Cy-6QVlW7fQ9HwmA09EAZXCQGhQWVW3TozOjLmIxIIj9-UkOlDmNROFOf7GyJikllVv01Q8S0ewdBjN53vKjpGXVgR_IaSdne0yj8-jalQxsbltT6P94Vtg11TkYC_2B6De5VvXFChVPx0xxH0KrI9sJhCJ5528-kPLV0as-W0JXePG0DG7ybEWglk5oM6CzU8lyQ.9eZ1y5HCu8EwO6vg.vv5JQHsgc1La1hI4iQo5yq9epOYhAaWHziLJ8fXh5wcRoDjxBqi8mgTD54idxn7kdHKjULnYInRkJ7SEQKrRem9zIhLjbf9FgBP-TsWKW7c9wHNrE9dPcU9Byejfo6M7IjKNSy0btQkPGhaW3BcBwWhe650sQZLUWq58fTIchjZkjdCrGr5Oo-QrzQb3ih-Peni4hRkB6FF00ILj4M1BBakMp30unnkzOxyhV7QQqq62pagGCrn9Lw2pj1N7FHPrPEajQxQHHrjMM6ppGAa672mL9X_rPPJbpZ6X_rzIbfjPkoMlldNGPKhaP43MqT5bwajSNxOWmT4nRLWhztapU7n0HTSko0JNvTZSI7Dr4akl8nSpjSGYGLzNSp0VrzJtatvMYOFHVO9jiqXuXK-MOKzIwK5YW3XHNMfps6G23rQvmYglSUTgFtcjzrH-FhfB8rkrnx7ym_Aata9PwLfL9-svJjfZzG0PF8jOEBQeFpo3FnXCMb9mThmJ836P2aTPNAizkM4McKfcuSbCQxow4PV5RnKeUzhru1wsgpwNPAOtsvj42dNZXZxpnjQGGAOBTThp7UJQbAYuUnyz6e0wX7VFAkTJbj9CTshyZSNeT3FbNz-TrDjrhm7e1jEaxVYDd_rO5P4j-cbkbePW6iV1zqurymrk1J52iKbuw81Zh6Omws6Asw5KIdszDMouTqnK58siR-DeQ-fjkzGs3AukhVvVe0CkCILoxGBvcf5NhgcHj2Tya4ZPbSHPC-TqTZIcR_L7Y1XHkUylXYJym7BKM__tYHhWKBz6VuVNS5rfNHShZ_E0JMDgVvsLDBkDqdLPaMokJHi11ki5uJ4CfJVoEAdY3qUs4RZLwCixtBFwujCnic4A6N6XUfA5sekyd-cmTpHSF6a_4ueO8EiEW7MuihVCEvekUdKHd_oeR1UMP5hcZYBPZ6BKR5UXg6cPx_KvPdTSeCKvLfG4a_ax9TKjyc3HdOoDPcHmFqyrPHYCbJCBoUXPAwNy35UUgIWRoun86nHI_TYdvkbX-4mVyJSTP-UiLuMY9kUrxpjBcDYx4du4qMysXftqCrd3lFqnnxarjV3-akac03ViCyX-HYxkTTaxeso8AgSPXWo3i5qzGhnCTyEu3qXSBsSRTwoHQfa3k1lmHPG4gN3SoSj980OwAkMjSc4_uXes6F2wQshm78rlUDhaq7CVDzbFDbQoTdFiF0_O0cdsAlUpZYq8h6-GeccVEDCzyOnkzKKlcbUKBefn5TyT5cTZpq6Wm7XIKaq4J3ieKi08TcYrcTJyS1kBn6EzfqgL3CQGTF2s_iIAK7kdzZvlrY-gAAv_c0kAePM.QyzhA8fb1g3wekfl8TbqYw\"}\n"},{"result":{"nanos":21100,"millis":0.0211,"status":"passed"},"step":{"line":21,"prefix":"Then","index":6,"text":"status 200"}},{"result":{"nanos":1097100,"millis":1.0971,"status":"passed"},"step":{"comments":["#Get the idToken for the user"],"line":24,"prefix":"*","index":7,"text":"def tokenid = response.idToken"}},{"result":{"nanos":1914600,"millis":1.9146,"status":"passed"},"step":{"line":25,"prefix":"*","index":8,"text":"print tokenid"},"stepLog":"15:58:01.636 [print] eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw \n"}],"executorName":"main","line":6,"name":"obtain a token for the admin user","description":"","durationMillis":906.0643,"startTime":1621259880729,"failed":false,"refId":"[1:6]","endTime":1621259881636,"exampleIndex":-1}],"name":"Get a token for the user to sign in the API","passedCount":1}]},{"result":{"nanos":1583700,"millis":1.5837,"status":"passed"},"step":{"line":17,"prefix":"*","index":2,"text":"print signIn.response"},"stepLog":"15:58:01.640 [print] {\n  \"expiresIn\": \"3600\",\n  \"idToken\": \"eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw\",\n  \"accessToken\": \"eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjEyNTk4ODEsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTI2MzQ4MSwiaWF0IjoxNjIxMjU5ODgyLCJqdGkiOiI0OWQzZGE2YS0wZjQ1LTRhMTctYWQ3ZC1lZjRlMzYyYzY1OWIiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIn0.MVZWmX1wwxZX4X2r63Om5FBMoDgfw8hv-EXGgmI-Rhvp5DRRJkne1cCYTujavymD62dN8-lROZjqxIhKxtx57bOU560kaAeyq4NBNEh9NOIdWLiB5RHGdoqoDGSwbAKJnQqB2piFDAqoThtEVEIOHkmKFSYYliXyQBWXrtHkDETPwb-i7-upwPCa98q7euTbBYM-mXgP1yGF7zGqAGgFyw7LGNkGOGKQU_kspEsDbnmEtlAMH_LJ3v8_JjRd_tBOJYrmHERTH1IWG1o9jiTKBsuc225MWu6aIB-1H9K7U7QwN5tA-Bcy6pX7M-RnHVmVPWkl30YvyziYkrYUtQt9HQ\",\n  \"tokenType\": \"Bearer\",\n  \"refreshToken\": \"eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.cEIO8gPpGDudi4GhhmY2UGJ3KJOvUCBqqG5SmudulUfLr8iedG38eOMnqgfYOupYexpAiOGi2P_ygsrV_4Ji37eZiuKGIo19iqT1ztD13PPdWEf7eXdyKtwL4d19fPHiLtcGIV6LKdNCRUoB1Cy-6QVlW7fQ9HwmA09EAZXCQGhQWVW3TozOjLmIxIIj9-UkOlDmNROFOf7GyJikllVv01Q8S0ewdBjN53vKjpGXVgR_IaSdne0yj8-jalQxsbltT6P94Vtg11TkYC_2B6De5VvXFChVPx0xxH0KrI9sJhCJ5528-kPLV0as-W0JXePG0DG7ybEWglk5oM6CzU8lyQ.9eZ1y5HCu8EwO6vg.vv5JQHsgc1La1hI4iQo5yq9epOYhAaWHziLJ8fXh5wcRoDjxBqi8mgTD54idxn7kdHKjULnYInRkJ7SEQKrRem9zIhLjbf9FgBP-TsWKW7c9wHNrE9dPcU9Byejfo6M7IjKNSy0btQkPGhaW3BcBwWhe650sQZLUWq58fTIchjZkjdCrGr5Oo-QrzQb3ih-Peni4hRkB6FF00ILj4M1BBakMp30unnkzOxyhV7QQqq62pagGCrn9Lw2pj1N7FHPrPEajQxQHHrjMM6ppGAa672mL9X_rPPJbpZ6X_rzIbfjPkoMlldNGPKhaP43MqT5bwajSNxOWmT4nRLWhztapU7n0HTSko0JNvTZSI7Dr4akl8nSpjSGYGLzNSp0VrzJtatvMYOFHVO9jiqXuXK-MOKzIwK5YW3XHNMfps6G23rQvmYglSUTgFtcjzrH-FhfB8rkrnx7ym_Aata9PwLfL9-svJjfZzG0PF8jOEBQeFpo3FnXCMb9mThmJ836P2aTPNAizkM4McKfcuSbCQxow4PV5RnKeUzhru1wsgpwNPAOtsvj42dNZXZxpnjQGGAOBTThp7UJQbAYuUnyz6e0wX7VFAkTJbj9CTshyZSNeT3FbNz-TrDjrhm7e1jEaxVYDd_rO5P4j-cbkbePW6iV1zqurymrk1J52iKbuw81Zh6Omws6Asw5KIdszDMouTqnK58siR-DeQ-fjkzGs3AukhVvVe0CkCILoxGBvcf5NhgcHj2Tya4ZPbSHPC-TqTZIcR_L7Y1XHkUylXYJym7BKM__tYHhWKBz6VuVNS5rfNHShZ_E0JMDgVvsLDBkDqdLPaMokJHi11ki5uJ4CfJVoEAdY3qUs4RZLwCixtBFwujCnic4A6N6XUfA5sekyd-cmTpHSF6a_4ueO8EiEW7MuihVCEvekUdKHd_oeR1UMP5hcZYBPZ6BKR5UXg6cPx_KvPdTSeCKvLfG4a_ax9TKjyc3HdOoDPcHmFqyrPHYCbJCBoUXPAwNy35UUgIWRoun86nHI_TYdvkbX-4mVyJSTP-UiLuMY9kUrxpjBcDYx4du4qMysXftqCrd3lFqnnxarjV3-akac03ViCyX-HYxkTTaxeso8AgSPXWo3i5qzGhnCTyEu3qXSBsSRTwoHQfa3k1lmHPG4gN3SoSj980OwAkMjSc4_uXes6F2wQshm78rlUDhaq7CVDzbFDbQoTdFiF0_O0cdsAlUpZYq8h6-GeccVEDCzyOnkzKKlcbUKBefn5TyT5cTZpq6Wm7XIKaq4J3ieKi08TcYrcTJyS1kBn6EzfqgL3CQGTF2s_iIAK7kdzZvlrY-gAAv_c0kAePM.QyzhA8fb1g3wekfl8TbqYw\"\n}\n \n"},{"result":{"nanos":690900,"millis":0.6909,"status":"passed"},"step":{"comments":["#### Create the Authorization header"],"line":20,"prefix":"*","index":3,"text":"def idToken = signIn.response.idToken"}},{"result":{"nanos":5077400,"millis":5.0774,"status":"passed"},"step":{"line":21,"prefix":"*","index":4,"text":"def user_header = \"Bearer \" + idToken"}},{"result":{"nanos":778800,"millis":0.7788,"status":"passed"},"step":{"endLine":28,"comments":["#### An user can create a new customer"],"line":25,"prefix":"*","docString":"read('SaveCustomer.graphql')","index":5,"text":"def query ="}},{"result":{"nanos":720000,"millis":0.72,"status":"passed"},"step":{"comments":["# JSON file with the new user's datas","# In this case, the photoUrl field isn't filled"],"line":31,"prefix":"*","index":6,"text":"def new_customerNoPhoto = read('NewCustomerNoPhoto.json')"}},{"result":{"nanos":323100,"millis":0.3231,"status":"passed"},"step":{"line":33,"prefix":"Given","index":7,"text":"path 'graphql'"}},{"result":{"nanos":1755100,"millis":1.7551,"status":"passed"},"step":{"line":34,"prefix":"And","index":8,"text":"header Authorization = signIn.response.tokenType + ' ' + signIn.response.idToken"}},{"result":{"nanos":2170600,"millis":2.1706,"status":"passed"},"step":{"line":35,"prefix":"And","index":9,"text":"request { query: '#(query)',  variables: '#(new_customerNoPhoto)'}"}},{"result":{"nanos":233288000,"millis":233.288,"status":"passed"},"step":{"line":36,"prefix":"When","index":10,"text":"method post"},"stepLog":"15:58:01.654 request:\n1 > POST https:\/\/pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\/test-qa-estrella-prod\/graphql\n1 > Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 284\n1 > Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/16.0.1)\n1 > Accept-Encoding: gzip,deflate\n{\"variables\":{\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"photo\":\"\",\"id\":\"20000000nophoto\"},\"query\":\"mutation SaveCustomer($id: ID, $name: String, $surname: String, $photo: String) {\\r\\n    SaveCustomer(input: {id: $id, name: $name, surname: $surname, photo: $photo})\\r\\n} \"}\n\n15:58:01.884 response time in milliseconds: 229\n1 < 200\n1 < Content-Type: application\/json\n1 < Content-Length: 30\n1 < Connection: keep-alive\n1 < Date: Mon, 17 May 2021 13:58:02 GMT\n1 < x-amzn-RequestId: 0a1f1726-4ac3-458e-ba3e-fdf5cf6a2d41\n1 < Access-Control-Allow-Origin: *\n1 < x-amz-apigw-id: fedwnEdJjoEFf6A=\n1 < X-Amzn-Trace-Id: Root=1-60a2766a-12f92b304138fd651647f4b3;Sampled=0\n1 < X-Cache: Miss from cloudfront\n1 < Via: 1.1 4ddf42f206fdf10afe67b89baac28c46.cloudfront.net (CloudFront)\n1 < X-Amz-Cf-Pop: MAD51-C2\n1 < X-Amz-Cf-Id: KnPc95iV9frGU1Fz7IqXoVNqfkQdF6yBFEtUxieqA6zOg_TPB5FVlg==\n{\"data\":{\"SaveCustomer\":true}}\n"},{"result":{"nanos":17900,"millis":0.0179,"status":"passed"},"step":{"line":37,"prefix":"Then","index":11,"text":"status 200"}},{"result":{"nanos":4027035500,"millis":4027.0355,"status":"passed"},"step":{"comments":["# Introduce a pause so the user can be saved before the next test"],"line":39,"prefix":"*","index":12,"text":"wait(4000)"}},{"result":{"nanos":2260900,"millis":2.2609,"status":"passed"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":41,"prefix":"*","index":13,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":5011800,"millis":5.0118,"status":"passed"},"step":{"comments":["# If the customer is saved, the response shouldn't contain a field \"error\""],"line":43,"prefix":"*","index":14,"text":"match response.errors == '#notpresent'"}},{"result":{"nanos":952900,"millis":0.9529,"status":"passed"},"step":{"comments":["# This time, the photoUrl is filled"],"line":46,"prefix":"*","index":15,"text":"def new_customerPhoto = read('NewCustomerPhoto.json')"}},{"result":{"nanos":419200,"millis":0.4192,"status":"passed"},"step":{"line":48,"prefix":"Given","index":16,"text":"path 'graphql'"}},{"result":{"nanos":611600,"millis":0.6116,"status":"passed"},"step":{"line":49,"prefix":"And","index":17,"text":"header Authorization = signIn.response.tokenType + ' ' + signIn.response.idToken"}},{"result":{"nanos":529000,"millis":0.529,"status":"passed"},"step":{"line":50,"prefix":"And","index":18,"text":"request { query: '#(query)',  variables: '#(new_customerPhoto)'}"}},{"result":{"nanos":191741600,"millis":191.7416,"status":"passed"},"step":{"line":51,"prefix":"When","index":19,"text":"method post"},"stepLog":"15:58:05.924 request:\n2 > POST https:\/\/pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\/test-qa-estrella-prod\/graphql\n2 > Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw\n2 > Content-Type: application\/json; charset=UTF-8\n2 > Content-Length: 290\n2 > Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\n2 > Connection: Keep-Alive\n2 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/16.0.1)\n2 > Accept-Encoding: gzip,deflate\n{\"variables\":{\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"photo\":\"photo.jpg\",\"id\":\"2000000photo\"},\"query\":\"mutation SaveCustomer($id: ID, $name: String, $surname: String, $photo: String) {\\r\\n    SaveCustomer(input: {id: $id, name: $name, surname: $surname, photo: $photo})\\r\\n} \"}\n\n15:58:06.113 response time in milliseconds: 188\n2 < 200\n2 < Content-Type: application\/json\n2 < Content-Length: 30\n2 < Connection: keep-alive\n2 < Date: Mon, 17 May 2021 13:58:06 GMT\n2 < x-amzn-RequestId: d2859b22-6bfb-4715-a4f3-0ca482747620\n2 < Access-Control-Allow-Origin: *\n2 < x-amz-apigw-id: fedxRHHRjoEFqaQ=\n2 < X-Amzn-Trace-Id: Root=1-60a2766e-061bd56d4eba82dd4450e42f;Sampled=0\n2 < X-Cache: Miss from cloudfront\n2 < Via: 1.1 09a2315feedfb8ccf5e3835ff7abd08a.cloudfront.net (CloudFront)\n2 < X-Amz-Cf-Pop: MAD51-C2\n2 < X-Amz-Cf-Id: PiQTYm45VUtu5E7JuhcVJ4_0hDHbmA6jgiU_sxDjuAvmnYNEXAkl1g==\n{\"data\":{\"SaveCustomer\":true}}\n"},{"result":{"nanos":15200,"millis":0.0152,"status":"passed"},"step":{"line":52,"prefix":"Then","index":20,"text":"status 200"}},{"result":{"nanos":4003584000,"millis":4003.584,"status":"passed"},"step":{"comments":["# Introduce a pause so the user can be saved before the next test"],"line":54,"prefix":"*","index":21,"text":"wait(4000)"}},{"result":{"nanos":376400,"millis":0.3764,"status":"passed"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":56,"prefix":"*","index":22,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":597500,"millis":0.5975,"status":"passed"},"step":{"comments":["# If the customer is saved, the response shouldn't contain a field \"error\""],"line":58,"prefix":"*","index":23,"text":"match response.errors == '#notpresent'"}},{"result":{"nanos":2199500,"millis":2.1995,"status":"passed"},"step":{"endLine":65,"comments":["#### Now, list the customers previously saved by id and check if datas are correct"],"line":62,"prefix":"*","docString":"read('CustomerReadModel.graphql')","index":24,"text":"def query ="},"stepLog":"15:58:10.121 over-writing existing variable 'query' with new value: read('CustomerReadModel.graphql')\n"},{"result":{"nanos":789500,"millis":0.7895,"status":"passed"},"step":{"comments":["# Get the id of the customer previously saved without photo"],"line":67,"prefix":"*","index":25,"text":"def customer_savedNoPhoto = read('NewCustomerNoPhoto.json')"}},{"result":{"nanos":128900,"millis":0.1289,"status":"passed"},"step":{"line":69,"prefix":"Given","index":26,"text":"path 'graphql'"}},{"result":{"nanos":236500,"millis":0.2365,"status":"passed"},"step":{"line":70,"prefix":"And","index":27,"text":"header Authorization = signIn.response.tokenType + ' ' + signIn.response.idToken"}},{"result":{"nanos":367700,"millis":0.3677,"status":"passed"},"step":{"line":71,"prefix":"And","index":28,"text":"request { query: '#(query)', variables: '#(customer_savedNoPhoto)'}"}},{"result":{"nanos":183357900,"millis":183.3579,"status":"passed"},"step":{"line":72,"prefix":"When","index":29,"text":"method post"},"stepLog":"15:58:10.125 request:\n3 > POST https:\/\/pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\/test-qa-estrella-prod\/graphql\n3 > Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw\n3 > Content-Type: application\/json; charset=UTF-8\n3 > Content-Length: 284\n3 > Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\n3 > Connection: Keep-Alive\n3 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/16.0.1)\n3 > Accept-Encoding: gzip,deflate\n{\"variables\":{\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"photo\":\"\",\"id\":\"20000000nophoto\"},\"query\":\"query CustomerReadModel($id: ID!) {\\r\\n    CustomerReadModel(id: $id) {\\r\\n        id\\r\\n        name\\r\\n        surname\\r\\n        photoUrl\\r\\n        userId\\r\\n    }\\r\\n}\"}\n\n15:58:10.306 response time in milliseconds: 180\n3 < 200\n3 < Content-Type: application\/json\n3 < Content-Length: 147\n3 < Connection: keep-alive\n3 < Date: Mon, 17 May 2021 13:58:10 GMT\n3 < x-amzn-RequestId: bac3b8a4-daa9-490c-9a36-283fb09bf8af\n3 < Access-Control-Allow-Origin: *\n3 < x-amz-apigw-id: fedx7EpPDoEFfLw=\n3 < X-Amzn-Trace-Id: Root=1-60a27672-4d89a5466a7465ec12ffc98f;Sampled=0\n3 < X-Cache: Miss from cloudfront\n3 < Via: 1.1 ed24ed7fbec751651346c1accbcfe3e5.cloudfront.net (CloudFront)\n3 < X-Amz-Cf-Pop: MAD51-C2\n3 < X-Amz-Cf-Id: eTXHpgI9WMQ_kRR1yKHEnv7oudCUNqU6a5Cv-1VMfMnvObCGVHUP8g==\n{\"data\":{\"CustomerReadModel\":{\"photoUrl\":\"\",\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"id\":\"20000000nophoto\",\"userId\":\"user8@test.com\"}}}\n"},{"result":{"nanos":15100,"millis":0.0151,"status":"passed"},"step":{"line":73,"prefix":"Then","index":30,"text":"status 200"}},{"result":{"nanos":395800,"millis":0.3958,"status":"passed"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":75,"prefix":"*","index":31,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":4021500,"millis":4.0215,"status":"passed"},"step":{"comments":["# Check that the datas of the customer are the same as we saved and it has the Id of the user who created it, in this case, the same as it's signed"],"line":77,"prefix":"*","index":32,"text":"match response.data.CustomerReadModel == {id: '#(customer_savedNoPhoto.id)', name: '#(customer_savedNoPhoto.name)', surname: '#(customer_savedNoPhoto.surname)', photoUrl: '#(customer_savedNoPhoto.photo)', userId: '#(datas.username)' }"}},{"result":{"nanos":688300,"millis":0.6883,"status":"passed"},"step":{"comments":["# Get the id of the customer previously saved with photo"],"line":80,"prefix":"*","index":33,"text":"def customer_savedPhoto = read('NewCustomerPhoto.json')"}},{"result":{"nanos":254100,"millis":0.2541,"status":"passed"},"step":{"line":82,"prefix":"Given","index":34,"text":"path 'graphql'"}},{"result":{"nanos":317100,"millis":0.3171,"status":"passed"},"step":{"line":83,"prefix":"And","index":35,"text":"header Authorization = signIn.response.tokenType + ' ' + signIn.response.idToken"}},{"result":{"nanos":634100,"millis":0.6341,"status":"passed"},"step":{"line":84,"prefix":"And","index":36,"text":"request { query: '#(query)', variables: '#(customer_savedPhoto)'}"}},{"result":{"nanos":233500900,"millis":233.5009,"status":"passed"},"step":{"line":85,"prefix":"When","index":37,"text":"method post"},"stepLog":"15:58:10.315 request:\n4 > POST https:\/\/pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\/test-qa-estrella-prod\/graphql\n4 > Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw\n4 > Content-Type: application\/json; charset=UTF-8\n4 > Content-Length: 290\n4 > Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\n4 > Connection: Keep-Alive\n4 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/16.0.1)\n4 > Accept-Encoding: gzip,deflate\n{\"variables\":{\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"photo\":\"photo.jpg\",\"id\":\"2000000photo\"},\"query\":\"query CustomerReadModel($id: ID!) {\\r\\n    CustomerReadModel(id: $id) {\\r\\n        id\\r\\n        name\\r\\n        surname\\r\\n        photoUrl\\r\\n        userId\\r\\n    }\\r\\n}\"}\n\n15:58:10.547 response time in milliseconds: 232\n4 < 200\n4 < Content-Type: application\/json\n4 < Content-Length: 144\n4 < Connection: keep-alive\n4 < Date: Mon, 17 May 2021 13:58:10 GMT\n4 < x-amzn-RequestId: 656991ab-f910-41e2-a3e5-5c092dcbe82a\n4 < Access-Control-Allow-Origin: *\n4 < x-amz-apigw-id: fedx-FDMDoEFYnw=\n4 < X-Amzn-Trace-Id: Root=1-60a27672-3bfbd6537b964b7c085c9ec7;Sampled=0\n4 < X-Cache: Miss from cloudfront\n4 < Via: 1.1 71a0472adc0e71a3b21b29ba3bec35f2.cloudfront.net (CloudFront)\n4 < X-Amz-Cf-Pop: MAD51-C2\n4 < X-Amz-Cf-Id: GfDI7BCqW7FFBHzDlonNUfdynbS5Xxq0UtrywNJgb4aMiZBCQ-41pw==\n{\"data\":{\"CustomerReadModel\":{\"photoUrl\":\"\",\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"id\":\"2000000photo\",\"userId\":\"user8@test.com\"}}}\n"},{"result":{"nanos":15300,"millis":0.0153,"status":"passed"},"step":{"line":86,"prefix":"Then","index":38,"text":"status 200"}},{"result":{"nanos":349200,"millis":0.3492,"status":"passed"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":88,"prefix":"*","index":39,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":2067900,"millis":2.0679,"status":"passed"},"step":{"endLine":97,"comments":["# Check that the datas of the customer are the same as we saved and it has the Id of the user who created it, in this case, the same as it's signed","####  * match response.data.CustomerReadModel == {id: '#(customer_savedPhoto.id)', name: '#(customer_savedPhoto.name)', surname: '#(customer_savedPhoto.surname)', photoUrl: '#(customer_savedPhoto.photo)', userId: '#(datas.username)' }","#### Users can list all the customers"],"line":94,"prefix":"*","docString":"read('CustomerReadModels.graphql')","index":40,"text":"def query ="},"stepLog":"15:58:10.549 over-writing existing variable 'query' with new value: read('CustomerReadModels.graphql')\n"},{"result":{"nanos":263100,"millis":0.2631,"status":"passed"},"step":{"line":99,"prefix":"Given","index":41,"text":"path 'graphql'"}},{"result":{"nanos":151400,"millis":0.1514,"status":"passed"},"step":{"line":100,"prefix":"And","index":42,"text":"header Authorization = signIn.response.tokenType + ' ' + signIn.response.idToken"}},{"result":{"nanos":134000,"millis":0.134,"status":"passed"},"step":{"line":101,"prefix":"And","index":43,"text":"request { query: '#(query)'}"}},{"result":{"nanos":156553500,"millis":156.5535,"status":"passed"},"step":{"line":102,"prefix":"When","index":44,"text":"method post"},"stepLog":"15:58:10.553 request:\n5 > POST https:\/\/pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\/test-qa-estrella-prod\/graphql\n5 > Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw\n5 > Content-Type: application\/json; charset=UTF-8\n5 > Content-Length: 167\n5 > Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\n5 > Connection: Keep-Alive\n5 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/16.0.1)\n5 > Accept-Encoding: gzip,deflate\n{\"query\":\"query CustomerReadModels {\\r\\n    CustomerReadModels {\\r\\n        id\\r\\n        name\\r\\n        surname\\r\\n        photoUrl\\r\\n        userId\\r\\n    }\\r\\n}\"}\n\n15:58:10.707 response time in milliseconds: 153\n5 < 200\n5 < Content-Type: application\/json\n5 < Content-Length: 960\n5 < Connection: keep-alive\n5 < Date: Mon, 17 May 2021 13:58:11 GMT\n5 < x-amzn-RequestId: 3694180b-225a-4b28-afd1-c2b1152c195e\n5 < Access-Control-Allow-Origin: *\n5 < x-amz-apigw-id: fedx_EYxjoEFYrg=\n5 < X-Amzn-Trace-Id: Root=1-60a27673-2aeba5de5669313f586c3173;Sampled=0\n5 < X-Cache: Miss from cloudfront\n5 < Via: 1.1 552a19732149a49fbfc2659a98c93d87.cloudfront.net (CloudFront)\n5 < X-Amz-Cf-Pop: MAD51-C2\n5 < X-Amz-Cf-Id: qB5hpHD_On4QcSTsdJ1BlaqM93Q53Zxu4Ln87wlxkK9EHdkrLnq9ag==\n{\"data\":{\"CustomerReadModels\":[{\"photoUrl\":\"\",\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"id\":\"2000000011a\",\"userId\":\"user8@test.com\"},{\"photoUrl\":\"\",\"surname\":\"Customer2 Surname\",\"name\":\"Customer2\",\"id\":\"2\",\"userId\":\"admin@theagilemonkeys.com\"},{\"photoUrl\":\"\",\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"id\":\"20000000aa\",\"userId\":\"admin@theagilemonkeys.com\"},{\"photoUrl\":\"\",\"surname\":\"Customer4 surname\",\"name\":\"Customer4 name\",\"id\":\"20000000bb\",\"userId\":\"admin@theagilemonkeys.com\"},{\"photoUrl\":\"\",\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"id\":\"2000000012a\",\"userId\":\"user8@test.com\"},{\"photoUrl\":\"\",\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"id\":\"2000000photo\",\"userId\":\"user8@test.com\"},{\"photoUrl\":\"\",\"surname\":\"Customer3 Surname\",\"name\":\"Customer3\",\"id\":\"3\",\"userId\":\"admin@theagilemonkeys.com\"},{\"photoUrl\":\"\",\"surname\":\"Customer surname\",\"name\":\"Customer name\",\"id\":\"20000000nophoto\",\"userId\":\"user8@test.com\"}]}}\n"},{"result":{"nanos":12300,"millis":0.0123,"status":"passed"},"step":{"line":103,"prefix":"Then","index":45,"text":"status 200"}},{"result":{"nanos":217600,"millis":0.2176,"status":"passed"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":105,"prefix":"*","index":46,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":413600,"millis":0.4136,"status":"passed"},"step":{"comments":["# Check that the response doesn't contains a field \"error\""],"line":107,"prefix":"*","index":47,"text":"match response.errors == '#notpresent'"}},{"result":{"nanos":464600,"millis":0.4646,"status":"passed"},"step":{"line":108,"prefix":"*","index":48,"text":"match response.data.CustomerReadModels contains {id: '#ignore', name: '#ignore', surname: '#ignore', photoUrl: '#ignore', userId: '#ignore' }"}},{"result":{"nanos":1008500,"millis":1.0085,"status":"passed"},"step":{"comments":["# Save the body of the response"],"line":110,"prefix":"*","index":49,"text":"def list_customers = response.data.CustomerReadModels"}},{"result":{"nanos":1170200,"millis":1.1702,"status":"passed"},"step":{"line":111,"prefix":"*","index":50,"text":"print list_customers"},"stepLog":"15:58:10.711 [print] [\n  {\n    \"photoUrl\": \"\",\n    \"surname\": \"Customer surname\",\n    \"name\": \"Customer name\",\n    \"id\": \"2000000011a\",\n    \"userId\": \"user8@test.com\"\n  },\n  {\n    \"photoUrl\": \"\",\n    \"surname\": \"Customer2 Surname\",\n    \"name\": \"Customer2\",\n    \"id\": \"2\",\n    \"userId\": \"admin@theagilemonkeys.com\"\n  },\n  {\n    \"photoUrl\": \"\",\n    \"surname\": \"Customer surname\",\n    \"name\": \"Customer name\",\n    \"id\": \"20000000aa\",\n    \"userId\": \"admin@theagilemonkeys.com\"\n  },\n  {\n    \"photoUrl\": \"\",\n    \"surname\": \"Customer4 surname\",\n    \"name\": \"Customer4 name\",\n    \"id\": \"20000000bb\",\n    \"userId\": \"admin@theagilemonkeys.com\"\n  },\n  {\n    \"photoUrl\": \"\",\n    \"surname\": \"Customer surname\",\n    \"name\": \"Customer name\",\n    \"id\": \"2000000012a\",\n    \"userId\": \"user8@test.com\"\n  },\n  {\n    \"photoUrl\": \"\",\n    \"surname\": \"Customer surname\",\n    \"name\": \"Customer name\",\n    \"id\": \"2000000photo\",\n    \"userId\": \"user8@test.com\"\n  },\n  {\n    \"photoUrl\": \"\",\n    \"surname\": \"Customer3 Surname\",\n    \"name\": \"Customer3\",\n    \"id\": \"3\",\n    \"userId\": \"admin@theagilemonkeys.com\"\n  },\n  {\n    \"photoUrl\": \"\",\n    \"surname\": \"Customer surname\",\n    \"name\": \"Customer name\",\n    \"id\": \"20000000nophoto\",\n    \"userId\": \"user8@test.com\"\n  }\n]\n \n"},{"result":{"nanos":469100,"millis":0.4691,"status":"passed"},"step":{"endLine":118,"comments":["#### List a customers by Id that doesn't exist"],"line":115,"prefix":"*","docString":"read('CustomerReadModel.graphql')","index":51,"text":"def query ="},"stepLog":"15:58:10.711 over-writing existing variable 'query' with new value: read('CustomerReadModel.graphql')\n"},{"result":{"nanos":1057200,"millis":1.0572,"status":"passed"},"step":{"comments":["# Define the id of a customer to list"],"line":120,"prefix":"*","index":52,"text":"def customer_no_exist = read('CustomerReadModelNoExist.json')"}},{"result":{"nanos":669000,"millis":0.669,"status":"passed"},"step":{"endLine":126,"line":121,"prefix":"*","docString":"{ \n   \"id\": \"#(customer_no_exist.id)\"\n}","index":53,"text":"def id ="}},{"result":{"nanos":118200,"millis":0.1182,"status":"passed"},"step":{"line":127,"prefix":"Given","index":54,"text":"path 'graphql'"}},{"result":{"nanos":194600,"millis":0.1946,"status":"passed"},"step":{"line":128,"prefix":"And","index":55,"text":"header Authorization = signIn.response.tokenType + ' ' + signIn.response.idToken"}},{"result":{"nanos":348700,"millis":0.3487,"status":"passed"},"step":{"line":129,"prefix":"And","index":56,"text":"request { query: '#(query)', variables: '#(id)'}"}},{"result":{"nanos":196033300,"millis":196.0333,"status":"passed"},"step":{"line":130,"prefix":"When","index":57,"text":"method post"},"stepLog":"15:58:10.716 request:\n6 > POST https:\/\/pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\/test-qa-estrella-prod\/graphql\n6 > Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw\n6 > Content-Type: application\/json; charset=UTF-8\n6 > Content-Length: 219\n6 > Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com\n6 > Connection: Keep-Alive\n6 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/16.0.1)\n6 > Accept-Encoding: gzip,deflate\n{\"variables\":{\"id\":\"20aassadfasfd\"},\"query\":\"query CustomerReadModel($id: ID!) {\\r\\n    CustomerReadModel(id: $id) {\\r\\n        id\\r\\n        name\\r\\n        surname\\r\\n        photoUrl\\r\\n        userId\\r\\n    }\\r\\n}\"}\n\n15:58:10.910 response time in milliseconds: 194\n6 < 200\n6 < Content-Type: application\/json\n6 < Content-Length: 35\n6 < Connection: keep-alive\n6 < Date: Mon, 17 May 2021 13:58:11 GMT\n6 < x-amzn-RequestId: f704eda7-26cc-4ec7-a957-29cca89cd03d\n6 < Access-Control-Allow-Origin: *\n6 < x-amz-apigw-id: fedyBEOkDoEFXeQ=\n6 < X-Amzn-Trace-Id: Root=1-60a27673-0705cf02286be7300f84dd6e;Sampled=0\n6 < X-Cache: Miss from cloudfront\n6 < Via: 1.1 c1f1733266ff22358c2c3dd7a5454d9d.cloudfront.net (CloudFront)\n6 < X-Amz-Cf-Pop: MAD51-C2\n6 < X-Amz-Cf-Id: t1WX2yBLzqXmUgaRwcvFabpxXOkJeW1vrM5f9lbz3WY1BURoq_HM0A==\n{\"data\":{\"CustomerReadModel\":null}}\n"},{"result":{"nanos":16000,"millis":0.016,"status":"passed"},"step":{"line":131,"prefix":"Then","index":58,"text":"status 200"}},{"result":{"nanos":328700,"millis":0.3287,"status":"passed"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":133,"prefix":"*","index":59,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":707000,"millis":0.707,"status":"passed"},"step":{"comments":["# Check that the response contains an error"],"line":135,"prefix":"*","index":60,"text":"match response.data.CustomerReadModel != {id: '#(customer_no_exist.id)', name: '#ignore', surname: '#ignore', photoUrl: '', userId: '#ignore' }"}},{"result":{"nanos":1659900,"millis":1.6599,"status":"passed"},"step":{"comments":["#### Users can update a customer","# Get a customer to update from the list of customer 'list_customers'"],"line":141,"prefix":"*","index":61,"text":"def fun = function(json){ return(json[0]) }"}},{"result":{"nanos":2822700,"millis":2.8227,"status":"passed"},"step":{"line":142,"prefix":"*","index":62,"text":"def customer_inList = call fun list_customers"}},{"result":{"nanos":1349800,"millis":1.3498,"status":"passed"},"step":{"line":143,"prefix":"*","index":63,"text":"print fun"},"stepLog":"15:58:10.918 [print] function(json){ return(json[0]) } \n"}],"executorName":"main","line":10,"name":"Querys for an user not admin","description":"","durationMillis":10242.3408,"startTime":1621259880522,"failed":false,"refId":"[1:10]","endTime":1621259890918,"exampleIndex":-1}],"callDepth":0,"name":"Test the query that an user not admin is allowed to do in the environment set from the java class","description":"","resultDate":"2021-05-17 03:58:10 p. m.","durationMillis":10242.3408,"passedCount":1}