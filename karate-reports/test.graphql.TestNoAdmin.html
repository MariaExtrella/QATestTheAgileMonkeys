<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="res/bootstrap.min.css" type="text/css"/>
    <link rel="stylesheet" href="res/karate-report.css" type="text/css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <script type="text/javascript" src="res/jquery.min.js"></script>
    <script type="text/javascript" src="res/jquery.tablesorter.min.js"></script>
    <script type="text/javascript" src="res/bootstrap.min.js"></script>
    <script type="text/javascript" src="res/karate-report.js"></script>
    <title>test.graphql.TestNoAdmin</title>  
  </head>
  <body>   
    <div id="root-container">
      <div id="leftnav">
                
        <div>
  <div class="nav-logo">
    <a href="karate-summary.html">
      <img src="karate-logo.svg" alt="Karate"/>
    </a>
    <div class="nav-count">
      <div id="nav-pass" class="bg-success">1</div>
      <div id="nav-fail" class="bg-danger">0</div>
    </div>
  </div>
  <div id="nav-type">
    <div>Scenarios</div>
  </div>         
  <div id="nav-date">
    <div>2021-05-20 07:22:29 p.Â m.</div>
  </div>        
</div>

        <div class="nav-container">
          <div class="nav-item passed">
            <a href="#[1:6]"><span>[1:6]</span> <span>Test if the API met the acceptance criteria for an admin user</span></a>
          </div>
        </div>
      </div>
      <div id="content">
        <div class="page-heading alert alert-primary">
          <a href="karate-summary.html">Summary</a><span class="feature-label">|</span>
          <a href="karate-tags.html">Tags</a><span class="feature-label">|</span>
          <span class="feature-label">Feature:</span>
          <span class="feature-path">test/graphql/TestNoAdmin.feature</span><span class="feature-label">|</span>
          <span class="feature-name">Test the graphql API for admin and not admin users</span>
          <span class="feature-description"></span>
        </div>
        <div class="scenario">
          <div class="scenario-heading" id="[1:6]">
            <div class="heading-container">
              <div class="scenario-tags">
                
              </div>
              <div class="scenario-keyword">
                Scenario: <span>[1:6]</span>
                <span class="scenario-name">Test if the API met the acceptance criteria for an admin user</span>
                <span></span>
              </div>
            </div>
            <div class="scenario-time passed">
              <span>ms:</span>&nbsp;<span>41588</span>
            </div>
          </div>
          <div class="step-row">
            <div class="step-container" id="[1:6]bg">
              <div class="step-ref bg-step">&gt;&gt;</div>
              <div class="step-cell passed">Background:</div>
            </div>
            <div class="time-cell passed"></div>
          </div>
          <div data-parent="[1:6]bg"><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.4">
      <div class="step-ref bg-step">4</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.4">19:21:47.582 karate.env system property was: prod 
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># It is necessary to sign in the API as admin to create a new user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Read the admin datas from a *.json file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.9">
      <div class="step-ref passed">9</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def adminDatas = read(&#39;signinDatasUser.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">36</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Call the feature to sign in the API with the JSON file that contains the admin&#39;s datas</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.12">
      <div class="step-ref passed">12</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def signIn = call read(&#39;signin.feature&#39;) adminDatas</span>
      </div>
    </div>
    <div class="time-cell passed">1078</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.12.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.signin</div>
      </div>
      <div class="time-cell passed">1060</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.12.0.call.0.7">{
  		&quot;clientId&quot;: &quot;#(clientId)&quot;,
        &quot;username&quot;: &quot;#(username)&quot;,
  		&quot;password&quot;: &quot;#(password)&quot;
	}</div>

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print query</span>
      </div>
    </div>
    <div class="time-cell passed">3</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.12.0.call.0.15">19:21:47.663 [print] {
  &quot;clientId&quot;: &quot;799hogucm363v55l7dk2n1l5u0&quot;,
  &quot;username&quot;: &quot;admin@theagilemonkeys.com&quot;,
  &quot;password&quot;: &quot;Admin.2020&quot;
}
 
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;/auth/sign-in&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">4</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request query</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.19">
      <div class="step-ref passed">19</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Content-Type = &#39;application/json&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.20">
      <div class="step-ref passed">20</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">1048</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.12.0.call.0.20">19:21:47.899 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/auth/sign-in
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 104
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;password&quot;:&quot;Admin.2020&quot;,&quot;clientId&quot;:&quot;799hogucm363v55l7dk2n1l5u0&quot;,&quot;username&quot;:&quot;admin@theagilemonkeys.com&quot;}

19:21:48.714 response time in milliseconds: 812
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 4011
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:21:48 GMT
1 &lt; x-amzn-RequestId: 0238c009-83fd-4a9a-a9db-f49c452c09a1
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0a7GbTjoEF0Sg=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69aac-4483b3d466afb1797df1cf0d
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 66709b7391664c627ccebe2d9c55dd7f.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: dIrXk6f_9ONhWMLnVzTT4sX13ajQzgrb2WRgp8e7fM77nVvhGQbORQ==
{&quot;expiresIn&quot;:&quot;3600&quot;,&quot;idToken&quot;:&quot;eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhZWIzZjJhNy0zZTllLTRhOTctYWNlOC1mZTQxYWQxMTg4OTAiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZXZlbnRfaWQiOiIxM2Q3YzE1MC1lZTE4LTRmOWQtYjRlOS1jMDcxYTZlODlmODEiLCJ0b2tlbl91c2UiOiJpZCIsImF1dGhfdGltZSI6MTYyMTUzMTMwOCwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tXC9ldS13ZXN0LTFfbUh1ZUFyMlF1IiwiY29nbml0bzp1c2VybmFtZSI6ImFlYjNmMmE3LTNlOWUtNGE5Ny1hY2U4LWZlNDFhZDExODg5MCIsImV4cCI6MTYyMTUzNDkwOCwiY3VzdG9tOnJvbGUiOiJBZG1pbiIsImlhdCI6MTYyMTUzMTMwOCwiZW1haWwiOiJhZG1pbkB0aGVhZ2lsZW1vbmtleXMuY29tIn0.Tl5m29iwrJhKoLaB-OAUu_PKgHeQadJ6NrUhsBZuf44BzHnjyDtxjuyJ-qVlNmOdCnyrRIoZT81E1stTCb5UFikIZpJe334VZjLBCCk4JvNPtaRGNuSam13UYOhbIU4i4PZCCw6cXGo7ENwkYO105nk1OJyfQSirjRrmQB9XKypgYaSztxc8OrPuEAtIIwlto862mcI22M0RyCeYvu-MBfvgNOqplA0a9GDcu4yHrayfS4FJEPZwL_EFx0N8PxqcTFHE1DYmf17MQeogZuSf8tMOibnjDK-pzg-ROpjD4MoLjYVGZeECjBJEYNv1kpNduYuIIAjAwvO-z9dOPQY9UQ&quot;,&quot;accessToken&quot;:&quot;eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJhZWIzZjJhNy0zZTllLTRhOTctYWNlOC1mZTQxYWQxMTg4OTAiLCJldmVudF9pZCI6IjEzZDdjMTUwLWVlMTgtNGY5ZC1iNGU5LWMwNzFhNmU4OWY4MSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjE1MzEzMDgsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTUzNDkwOCwiaWF0IjoxNjIxNTMxMzA4LCJqdGkiOiJkMTdjNjAyNC02ZjdmLTRiMTYtYjEzMC1lOWRiMGYwYWVhOWQiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiYWViM2YyYTctM2U5ZS00YTk3LWFjZTgtZmU0MWFkMTE4ODkwIn0.yuiAqEEtWiIO7Jao_nQ5X9eGoV37LqJofGS-cDFgr8epW-CDJmi4mB9lK0KCPLRQho3Ig_VncNUygOIgNX5JV9qdf1xyhQi-wxmvaFTan0xK-O21FqXS5TlsmE1HxtuaaEdcS2qM73LjoT1SgcV5biPSOTX_D8NMWeEA6lLNAkpNG0InbIcSJJiAbHhh7QMPf7s1NP07HRQUXiB3lMZDnYERdywqUXvG59itJ5wL01loogR4qR3_BXiLJI0aoCwJLmMogpVIY24n6NaVUVCabUoEhZorqchVgGdF4-b1VreJFh_4oUhxb-1_U0wFolcdbG9YRK2HIoD_ASvHuAg91w&quot;,&quot;tokenType&quot;:&quot;Bearer&quot;,&quot;refreshToken&quot;:&quot;eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.ggP1c86F9tB-Wx_Vx-hAo9nHt9ZrYQzw_Dp3XlKQvY_vFtWn8QG4lSPgJUupjOFDK7rOER_s-UdX0AQuD-gbwmXFMxr6vAG9031VHdRLd07ZLMiyTZHlVkw8wbcUyJYQ8hrbPtL2IEp68I2FBMStV7oxOmyD1unugyP-h3k4FpEBWNWKHC7nJlKwzU5ER6cdyLBAQDEJSTxqJihOJKzsHyBt85Up9jkkRQ0EmN8JWFSmoA2aQElZKcOYMB-DjRY53gubj81GVjTMunDqo1Ed7CuEprl-ZO6OxKTQvtQxIRLKlgwuqm7dIERBvVzQOo-gomBErF-L1w57OTP61Ks_9w.qnsfMASmQW90ukAk.OuOZ4whAmAl8VX876pvhOeMQYWxVvFpVKcA2BIIXiU4TbxBKFpct6aDe-Tu2eb7FN6yRC3x72BjrBiCq-pse4QPrT6-hRDkoXmz0Oq-Ej7sxecz0wf3a_jWh-v8drL0W1o_thGCM5D1DeKlI-ybpaVKIta4gOc2fIM4SLsf_eR2zCGG40K9v21bq6v10dp3U6gf2WW62L_clNo4kUqgb4esR3EgGs6LZ-GPTVURT4bt9fen9LdcXzIL3zc3eEK0wkqE2oBbB7RepkZbEAEKE5tJofNFoYXpDaq7IVqLdfNtmS3adSazkVq8EOxR1ct1nxbhnXnUOw1L8cesLEgCM8fxM18nM16Teyo9GSUcgfHCURAcUloQtRw3CDiF3HcWlJDirErZitG0jyEcpZyMFqI91tF51v-DtuKP3LkrfeFf3gz5GlGtiH0Hej8Lm3jsrM6f1QVKggugSdtdF3FWwycs2LmQi96Ypjtg8jwVYRpyT4djpTv3UbfRdmoEFrm6JaWnvpKDmhgCt1_k6MquaQqdAlkN3xvD0yb5FzCiCKM-0xg2Tj688uZNwNlhOQsl7OY8wxHMFBPv55pK86WTfsF9IU2PoHasyCr0kuJF4DphHJFLnKI3NdZrxrn1-OOxfWSLY-RdctlQdzHco9xkhzTuyizudhqboIh9OAZhKGiUfW7X1ldOsehpxJMJuBPZpyk_anhUQFgWB5sK805exZnmO6TawZry0IPl83xkIqDDLihGL3Fqjx6PNmvz0-QbcNshNeJKjwww1nijn_1EZY7HiC_DXJzn_2XKaSqQgGdGMqETQ04rZ1iIi_KYb2jUNORWv2-D73U8RqFSPEOYk0k0Y0RbOt55TrwJ_tIszOFfwM8oeixvoHcXNqofbQY_lZ0neujeL097KWa5Fx4dq44u8VXWLnP8qifha6TzqK63eUNuigkAoCSU_Pvmw4sv5MWkHjqKkFLIHXv3Sl-ug_RTH3giQzL1tgjPGQ0FHt8jHtFcVAG8VnlmQD8rXBn4uFTX-k1FCEZcZH9mLIsaCvHphbApNJSzndCeH29UxMZP2moQiLR7MNJaJzlyASrjfaVmzfrMscAjsZ5njSNW8peBuVNqtzDcrMoxyg9zJYFeRUIh-Jec2uLanPMbTM-tHl7pR7Vp7BavBrDBMzCknDOgTZopT1CbdPadhvKivLaoqhIQ5lSjF_xNRa9Lg1Nnyl_sN9TPx1m1V6iq0i0l0PuDMUzDiGe_MBDYEJTrc-ijtlMlozCTO-U2fvCytZhMbKr-ioHkV0KdHxe9_KLJFK3ZxgNUk9SWzlpLEE3gswRaq44BNn2jsX0Dp1-QoKms.SF-iNH1FYyJW54p7Ssyv4A&quot;}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.21">
      <div class="step-ref passed">21</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment">#Get the idToken for the user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.24">
      <div class="step-ref passed">24</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def tokenid = response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.12.0.call">
    <div class="step-container" id="0.12.0.call.0.25">
      <div class="step-ref passed">25</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print tokenid</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.12.0.call.0.25">19:21:48.719 [print] eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhZWIzZjJhNy0zZTllLTRhOTctYWNlOC1mZTQxYWQxMTg4OTAiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZXZlbnRfaWQiOiIxM2Q3YzE1MC1lZTE4LTRmOWQtYjRlOS1jMDcxYTZlODlmODEiLCJ0b2tlbl91c2UiOiJpZCIsImF1dGhfdGltZSI6MTYyMTUzMTMwOCwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tXC9ldS13ZXN0LTFfbUh1ZUFyMlF1IiwiY29nbml0bzp1c2VybmFtZSI6ImFlYjNmMmE3LTNlOWUtNGE5Ny1hY2U4LWZlNDFhZDExODg5MCIsImV4cCI6MTYyMTUzNDkwOCwiY3VzdG9tOnJvbGUiOiJBZG1pbiIsImlhdCI6MTYyMTUzMTMwOCwiZW1haWwiOiJhZG1pbkB0aGVhZ2lsZW1vbmtleXMuY29tIn0.Tl5m29iwrJhKoLaB-OAUu_PKgHeQadJ6NrUhsBZuf44BzHnjyDtxjuyJ-qVlNmOdCnyrRIoZT81E1stTCb5UFikIZpJe334VZjLBCCk4JvNPtaRGNuSam13UYOhbIU4i4PZCCw6cXGo7ENwkYO105nk1OJyfQSirjRrmQB9XKypgYaSztxc8OrPuEAtIIwlto862mcI22M0RyCeYvu-MBfvgNOqplA0a9GDcu4yHrayfS4FJEPZwL_EFx0N8PxqcTFHE1DYmf17MQeogZuSf8tMOibnjDK-pzg-ROpjD4MoLjYVGZeECjBJEYNv1kpNduYuIIAjAwvO-z9dOPQY9UQ 
</div>   

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.13">
      <div class="step-ref passed">13</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print signIn.response</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.13">19:21:48.723 [print] {
  &quot;expiresIn&quot;: &quot;3600&quot;,
  &quot;idToken&quot;: &quot;eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhZWIzZjJhNy0zZTllLTRhOTctYWNlOC1mZTQxYWQxMTg4OTAiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZXZlbnRfaWQiOiIxM2Q3YzE1MC1lZTE4LTRmOWQtYjRlOS1jMDcxYTZlODlmODEiLCJ0b2tlbl91c2UiOiJpZCIsImF1dGhfdGltZSI6MTYyMTUzMTMwOCwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tXC9ldS13ZXN0LTFfbUh1ZUFyMlF1IiwiY29nbml0bzp1c2VybmFtZSI6ImFlYjNmMmE3LTNlOWUtNGE5Ny1hY2U4LWZlNDFhZDExODg5MCIsImV4cCI6MTYyMTUzNDkwOCwiY3VzdG9tOnJvbGUiOiJBZG1pbiIsImlhdCI6MTYyMTUzMTMwOCwiZW1haWwiOiJhZG1pbkB0aGVhZ2lsZW1vbmtleXMuY29tIn0.Tl5m29iwrJhKoLaB-OAUu_PKgHeQadJ6NrUhsBZuf44BzHnjyDtxjuyJ-qVlNmOdCnyrRIoZT81E1stTCb5UFikIZpJe334VZjLBCCk4JvNPtaRGNuSam13UYOhbIU4i4PZCCw6cXGo7ENwkYO105nk1OJyfQSirjRrmQB9XKypgYaSztxc8OrPuEAtIIwlto862mcI22M0RyCeYvu-MBfvgNOqplA0a9GDcu4yHrayfS4FJEPZwL_EFx0N8PxqcTFHE1DYmf17MQeogZuSf8tMOibnjDK-pzg-ROpjD4MoLjYVGZeECjBJEYNv1kpNduYuIIAjAwvO-z9dOPQY9UQ&quot;,
  &quot;accessToken&quot;: &quot;eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJhZWIzZjJhNy0zZTllLTRhOTctYWNlOC1mZTQxYWQxMTg4OTAiLCJldmVudF9pZCI6IjEzZDdjMTUwLWVlMTgtNGY5ZC1iNGU5LWMwNzFhNmU4OWY4MSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjE1MzEzMDgsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTUzNDkwOCwiaWF0IjoxNjIxNTMxMzA4LCJqdGkiOiJkMTdjNjAyNC02ZjdmLTRiMTYtYjEzMC1lOWRiMGYwYWVhOWQiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiYWViM2YyYTctM2U5ZS00YTk3LWFjZTgtZmU0MWFkMTE4ODkwIn0.yuiAqEEtWiIO7Jao_nQ5X9eGoV37LqJofGS-cDFgr8epW-CDJmi4mB9lK0KCPLRQho3Ig_VncNUygOIgNX5JV9qdf1xyhQi-wxmvaFTan0xK-O21FqXS5TlsmE1HxtuaaEdcS2qM73LjoT1SgcV5biPSOTX_D8NMWeEA6lLNAkpNG0InbIcSJJiAbHhh7QMPf7s1NP07HRQUXiB3lMZDnYERdywqUXvG59itJ5wL01loogR4qR3_BXiLJI0aoCwJLmMogpVIY24n6NaVUVCabUoEhZorqchVgGdF4-b1VreJFh_4oUhxb-1_U0wFolcdbG9YRK2HIoD_ASvHuAg91w&quot;,
  &quot;tokenType&quot;: &quot;Bearer&quot;,
  &quot;refreshToken&quot;: &quot;eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.ggP1c86F9tB-Wx_Vx-hAo9nHt9ZrYQzw_Dp3XlKQvY_vFtWn8QG4lSPgJUupjOFDK7rOER_s-UdX0AQuD-gbwmXFMxr6vAG9031VHdRLd07ZLMiyTZHlVkw8wbcUyJYQ8hrbPtL2IEp68I2FBMStV7oxOmyD1unugyP-h3k4FpEBWNWKHC7nJlKwzU5ER6cdyLBAQDEJSTxqJihOJKzsHyBt85Up9jkkRQ0EmN8JWFSmoA2aQElZKcOYMB-DjRY53gubj81GVjTMunDqo1Ed7CuEprl-ZO6OxKTQvtQxIRLKlgwuqm7dIERBvVzQOo-gomBErF-L1w57OTP61Ks_9w.qnsfMASmQW90ukAk.OuOZ4whAmAl8VX876pvhOeMQYWxVvFpVKcA2BIIXiU4TbxBKFpct6aDe-Tu2eb7FN6yRC3x72BjrBiCq-pse4QPrT6-hRDkoXmz0Oq-Ej7sxecz0wf3a_jWh-v8drL0W1o_thGCM5D1DeKlI-ybpaVKIta4gOc2fIM4SLsf_eR2zCGG40K9v21bq6v10dp3U6gf2WW62L_clNo4kUqgb4esR3EgGs6LZ-GPTVURT4bt9fen9LdcXzIL3zc3eEK0wkqE2oBbB7RepkZbEAEKE5tJofNFoYXpDaq7IVqLdfNtmS3adSazkVq8EOxR1ct1nxbhnXnUOw1L8cesLEgCM8fxM18nM16Teyo9GSUcgfHCURAcUloQtRw3CDiF3HcWlJDirErZitG0jyEcpZyMFqI91tF51v-DtuKP3LkrfeFf3gz5GlGtiH0Hej8Lm3jsrM6f1QVKggugSdtdF3FWwycs2LmQi96Ypjtg8jwVYRpyT4djpTv3UbfRdmoEFrm6JaWnvpKDmhgCt1_k6MquaQqdAlkN3xvD0yb5FzCiCKM-0xg2Tj688uZNwNlhOQsl7OY8wxHMFBPv55pK86WTfsF9IU2PoHasyCr0kuJF4DphHJFLnKI3NdZrxrn1-OOxfWSLY-RdctlQdzHco9xkhzTuyizudhqboIh9OAZhKGiUfW7X1ldOsehpxJMJuBPZpyk_anhUQFgWB5sK805exZnmO6TawZry0IPl83xkIqDDLihGL3Fqjx6PNmvz0-QbcNshNeJKjwww1nijn_1EZY7HiC_DXJzn_2XKaSqQgGdGMqETQ04rZ1iIi_KYb2jUNORWv2-D73U8RqFSPEOYk0k0Y0RbOt55TrwJ_tIszOFfwM8oeixvoHcXNqofbQY_lZ0neujeL097KWa5Fx4dq44u8VXWLnP8qifha6TzqK63eUNuigkAoCSU_Pvmw4sv5MWkHjqKkFLIHXv3Sl-ug_RTH3giQzL1tgjPGQ0FHt8jHtFcVAG8VnlmQD8rXBn4uFTX-k1FCEZcZH9mLIsaCvHphbApNJSzndCeH29UxMZP2moQiLR7MNJaJzlyASrjfaVmzfrMscAjsZ5njSNW8peBuVNqtzDcrMoxyg9zJYFeRUIh-Jec2uLanPMbTM-tHl7pR7Vp7BavBrDBMzCknDOgTZopT1CbdPadhvKivLaoqhIQ5lSjF_xNRa9Lg1Nnyl_sN9TPx1m1V6iq0i0l0PuDMUzDiGe_MBDYEJTrc-ijtlMlozCTO-U2fvCytZhMbKr-ioHkV0KdHxe9_KLJFK3ZxgNUk9SWzlpLEE3gswRaq44BNn2jsX0Dp1-QoKms.SF-iNH1FYyJW54p7Ssyv4A&quot;
}
 
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># The token for the admin user is the input parameter for the callable feature where are defined the steps of the tests</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.15">
      <div class="step-ref passed">15</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def userToken = signIn.response</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Create a new user different from admin to sign in the API</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># The body of the graphql request is a JSON with the generated values</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.19">
      <div class="step-ref passed">19</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def newUser =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.19">{ 
	&quot;username&quot;: &quot;userNotAdmin@test.com&quot;, 
	&quot;password&quot;: &quot;Password_1&quot;, 
	&quot;role&quot;: &quot;user&quot;
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.28">
      <div class="step-ref passed">28</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def saveUser = call read(&#39;SaveUser.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">5093</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.28.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.SaveUser</div>
      </div>
      <div class="time-cell passed">5078</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def querySaveUser = read(&#39;SaveUser.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">10</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.16">
      <div class="step-ref passed">16</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(querySaveUser)&#39;,  variables: &#39;#(newUser)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">1036</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.28.0.call.0.17">19:21:48.749 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhZWIzZjJhNy0zZTllLTRhOTctYWNlOC1mZTQxYWQxMTg4OTAiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZXZlbnRfaWQiOiIxM2Q3YzE1MC1lZTE4LTRmOWQtYjRlOS1jMDcxYTZlODlmODEiLCJ0b2tlbl91c2UiOiJpZCIsImF1dGhfdGltZSI6MTYyMTUzMTMwOCwiaXNzIjoiaHR0cHM6XC9cL2NvZ25pdG8taWRwLmV1LXdlc3QtMS5hbWF6b25hd3MuY29tXC9ldS13ZXN0LTFfbUh1ZUFyMlF1IiwiY29nbml0bzp1c2VybmFtZSI6ImFlYjNmMmE3LTNlOWUtNGE5Ny1hY2U4LWZlNDFhZDExODg5MCIsImV4cCI6MTYyMTUzNDkwOCwiY3VzdG9tOnJvbGUiOiJBZG1pbiIsImlhdCI6MTYyMTUzMTMwOCwiZW1haWwiOiJhZG1pbkB0aGVhZ2lsZW1vbmtleXMuY29tIn0.Tl5m29iwrJhKoLaB-OAUu_PKgHeQadJ6NrUhsBZuf44BzHnjyDtxjuyJ-qVlNmOdCnyrRIoZT81E1stTCb5UFikIZpJe334VZjLBCCk4JvNPtaRGNuSam13UYOhbIU4i4PZCCw6cXGo7ENwkYO105nk1OJyfQSirjRrmQB9XKypgYaSztxc8OrPuEAtIIwlto862mcI22M0RyCeYvu-MBfvgNOqplA0a9GDcu4yHrayfS4FJEPZwL_EFx0N8PxqcTFHE1DYmf17MQeogZuSf8tMOibnjDK-pzg-ROpjD4MoLjYVGZeECjBJEYNv1kpNduYuIIAjAwvO-z9dOPQY9UQ
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 257
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;password&quot;:&quot;Password_1&quot;,&quot;role&quot;:&quot;user&quot;,&quot;username&quot;:&quot;userNotAdmin@test.com&quot;},&quot;query&quot;:&quot;mutation SaveUser($username: String, $password: String, $role: String) {\r\n    SaveUser(input: {username: $username, password: $password, role: $role})\r\n} &quot;}

19:21:49.782 response time in milliseconds: 1032
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 26
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:21:49 GMT
1 &lt; x-amzn-RequestId: 68e5e387-d4c3-4670-bc5f-232ceda6739d
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0bCHXnjoEF0QA=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69aac-3c1911227a0282f23a12c4c6;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 c5c852ebeabe49b08625d425153869fe.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: MlDJwSp9D2UnuRnH15tYqXAZB0DYxICSawjaHsjPGlqEYSZ2_vFqdQ==
{&quot;data&quot;:{&quot;SaveUser&quot;:true}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Introduce a pause so the user can be saved before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.20">
      <div class="step-ref passed">20</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4026</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.28.0.call">
    <div class="step-container" id="0.28.0.call.0.23">
      <div class="step-ref passed">23</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.29">
      <div class="step-ref passed">29</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match saveUser.response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">14</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Sign now with the new user to get a new authorization token</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># To call the feature it is necessary to over write the sign in values with the new user&#39;s</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.33">
      <div class="step-ref passed">33</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def newUserSign =</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.33">{
     &quot;clientId&quot;: &quot;#(adminDatas.clientId)&quot;,
     &quot;username&quot;: &quot;#(newUser.username)&quot;,
     &quot;password&quot;: &quot;#(newUser.password)&quot; 
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.41">
      <div class="step-ref passed">41</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def signIn = call read(&#39;signin.feature&#39;) newUserSign</span>
      </div>
    </div>
    <div class="time-cell passed">466</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.41.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.signin</div>
      </div>
      <div class="time-cell passed">454</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.41.0.call.0.4">19:21:53.833 over-writing existing variable &#39;signIn&#39; with new value: call read(&#39;signin.feature&#39;) newUserSign
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.41.0.call.0.7">{
  		&quot;clientId&quot;: &quot;#(clientId)&quot;,
        &quot;username&quot;: &quot;#(username)&quot;,
  		&quot;password&quot;: &quot;#(password)&quot;
	}</div>

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print query</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.41.0.call.0.15">19:21:53.844 [print] {
  &quot;clientId&quot;: &quot;799hogucm363v55l7dk2n1l5u0&quot;,
  &quot;username&quot;: &quot;userNotAdmin@test.com&quot;,
  &quot;password&quot;: &quot;Password_1&quot;
}
 
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;/auth/sign-in&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request query</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.19">
      <div class="step-ref passed">19</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Content-Type = &#39;application/json&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.20">
      <div class="step-ref passed">20</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">449</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.41.0.call.0.20">19:21:53.846 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/auth/sign-in
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 100
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;password&quot;:&quot;Password_1&quot;,&quot;clientId&quot;:&quot;799hogucm363v55l7dk2n1l5u0&quot;,&quot;username&quot;:&quot;userNotAdmin@test.com&quot;}

19:21:54.292 response time in milliseconds: 443
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 4003
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:21:54 GMT
1 &lt; x-amzn-RequestId: ba704311-83cd-4d9d-ace0-e432451879c1
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0b1F6BjoEF1VQ=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ab2-1eae399f2966bc1a2e34cf32
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 02d3291a1ad341b65154c2216e21838b.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: Ay1n8ByZBWwNu0S_NjsbBbuTOVT6o10HJITh3yQ9z7NpswbaUuRgYQ==
{&quot;expiresIn&quot;:&quot;3600&quot;,&quot;idToken&quot;:&quot;eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA&quot;,&quot;accessToken&quot;:&quot;eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjE1MzEzMTQsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTUzNDkxNCwiaWF0IjoxNjIxNTMxMzE0LCJqdGkiOiJiOTNmNjM2MS03MzUwLTQ1M2YtOGY1ZS0xNWE3ZDEzODRkMzEiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4In0.p_p0F58fDk2zldpM-awtVn5LqOe5C7-hpol31at3C8XZuMxkYevf7y7o5ojV5e9YmKr38nSk8FY_56RED5KayDt8NxjyXBTURrUfjGH-vEPdr-ZPMDJa5YW8Sq3yJ4DO4NfXSoOWbFjYJVFgnJkvic8JcAjzlPk5dH-FG4zHIrOvdD6epzAVNsN2pA4KjO3COQ9j0nYaniV2RopEVb2lPVuD-lel94l7xsrkDpXdG2qDnBgSpgzqaPW5MUtesvhtJgeTmXZ1h06fYLnLm6S2lmOuZiLxeTH559AjBFrdWX78RIIxgmQ17PohjXh0bmdvTV4ANFK7_GLqNCC5yH9QgQ&quot;,&quot;tokenType&quot;:&quot;Bearer&quot;,&quot;refreshToken&quot;:&quot;eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.QiK-I2RUGvbZofiHTKAVrxMMKwvgq51BMoNDu_J5QPzgHsZFXDpkky_YdvK8SbTAFKhoCOkHWYKQ7IDQy0AYFEB1rHV2c7I60iPbhhU8anmjSsZScy1nVWyxIKgynox8upoOC9gulk7US858TMXum0h1qcLEy_1lnHtOBdiKfvs2Fxrtg1vBLN3jsRcpn7DAfvT_TGpwK3nDtLRfWMLKhFb9QwK2w_lNXke_ZBtfvifQTakAzJhvaPHolDJ9DIqZqaC_dfRK6oV7L5sZWcQFpLkbxB3K5o-K_AQtgBGbqADgiv0PnSnQTFkYu2wDWOjt7rRQFtBZCvdBL6zPAiIvpA.xX7BKwdnoK14HzPr.CavoFHTufpE6rcg6OSGUQ9inVBwaD0Da2LTfI60E6c4fkaGnORKoTMFJVD4wfubG4H1Lj6_SHOfSmmsLv3CDm-6Kk4io-lXht6J36e-uSFVMXX8iokkFZNQ4Tj2zzn0szAYl_Kjibd4ItqMgqIGPffvERIpnRzLO7Z3IAlW5gvIAs25EWSJi2OL4yuWzGg5eJRBwEy57F1NKqCpvXDaaGtJag7UEsL3PA5VDsCrW3UloVNJgEmBFks2SIFH9MHrqsw-VosWESbcT_Xw3RRhCC3LXFArISBsei6mIrigh91hREur8n7B50Jq-YCJtczuyN1c02ZuyhGYVjJHCTNn06fA7q6sXB6NdcpDcFu1VL-LjCs5EmgfACWtf1h-yQO2iktkOSm2X--SgQ9rween4fqKxs_VncSaNs7OWS7eLj7_DZBt88iqkqMIPy9FEeonHGrDIU-_lLTfZ_OLLc_ZFGW0E6ulQjJD--ycB1ZwGAyXblfp0qqGdk0nNCvFcrnruI7D-XDIusEUYvlBzcWd7PG9pt6WgHC39M-r3REhP_IlkecM2ouZCFj7nd__6riMJ0HAJRGfmLKULsVhOiRarmV9l6mozlE7qGLRV38SzUnfJBcsONXNb_SB49oLKHMkncwDDdgGvvHGXcKuyo1y03Y7gyE0yTUMp5WWbjr6lDZJlYH8dsSwkEjRyrTA_g9vsqBjpdUVWBOfUguL8WjzpBNveaKLo3S_WA1HRIcbO-Yn9_K_i8XsiJCXsZmEky7qT33_CWoQ7NDs-9yTVDOhh5uE9TLRH9WQR4B_BQEJf7eeI3XJx-CNTNSH37AzhYfvO6-Uft-ekPiR9NHdqSO5p8k7RpN01UMviQqcVuLloSz4T85NbWVy9_sC7R_HCh5ePesGsm25WlJiuknGln6q9omd3ATLzEUeUmRifKXT-bHLWLk2jifz7Kxmm-zcJwWdCH9rgEumH2KqVuHawcvbqHbrKkfrmmwNR_hSdRjEnQbS6CZFvzWj4KBxUxYkupP3lvbti79rRhsvseVXTIG_guEw6f-EXnCLl5Hg1IoyjRH1SAkLl_SGISwfNGFzOyhSDCeVzpfI0vrZa_AbbgKmoczhz8vH-OqmAR1SJS-oSyw7jftB9KQEjFSHuYtbKtnSIrbXYt8EQq9G05lpHZNclI7vRh0aJqUAK715kwz-D-Ao0WtQeeCusnjg3VIx4ED1cG72m6GA2h3XPIv-m5VGX-0MMMwXrZydObOX8AdHEpHMfhXEiwZXmyabukF2AQrU6R9CwlaG0fa5sLZxJdTZ3GLZKC0tZEp0mAiyykDodvzKFHUQoeOJgxGB83EVJhCU.FcvNsk68CdlDSh5QmfSuLQ&quot;}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.21">
      <div class="step-ref passed">21</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment">#Get the idToken for the user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.24">
      <div class="step-ref passed">24</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def tokenid = response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.41.0.call">
    <div class="step-container" id="0.41.0.call.0.25">
      <div class="step-ref passed">25</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print tokenid</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.41.0.call.0.25">19:21:54.297 [print] eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA 
</div>   

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.42">
      <div class="step-ref passed">42</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print signIn.response</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.42">19:21:54.302 [print] {
  &quot;expiresIn&quot;: &quot;3600&quot;,
  &quot;idToken&quot;: &quot;eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA&quot;,
  &quot;accessToken&quot;: &quot;eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjE1MzEzMTQsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTUzNDkxNCwiaWF0IjoxNjIxNTMxMzE0LCJqdGkiOiJiOTNmNjM2MS03MzUwLTQ1M2YtOGY1ZS0xNWE3ZDEzODRkMzEiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4In0.p_p0F58fDk2zldpM-awtVn5LqOe5C7-hpol31at3C8XZuMxkYevf7y7o5ojV5e9YmKr38nSk8FY_56RED5KayDt8NxjyXBTURrUfjGH-vEPdr-ZPMDJa5YW8Sq3yJ4DO4NfXSoOWbFjYJVFgnJkvic8JcAjzlPk5dH-FG4zHIrOvdD6epzAVNsN2pA4KjO3COQ9j0nYaniV2RopEVb2lPVuD-lel94l7xsrkDpXdG2qDnBgSpgzqaPW5MUtesvhtJgeTmXZ1h06fYLnLm6S2lmOuZiLxeTH559AjBFrdWX78RIIxgmQ17PohjXh0bmdvTV4ANFK7_GLqNCC5yH9QgQ&quot;,
  &quot;tokenType&quot;: &quot;Bearer&quot;,
  &quot;refreshToken&quot;: &quot;eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.QiK-I2RUGvbZofiHTKAVrxMMKwvgq51BMoNDu_J5QPzgHsZFXDpkky_YdvK8SbTAFKhoCOkHWYKQ7IDQy0AYFEB1rHV2c7I60iPbhhU8anmjSsZScy1nVWyxIKgynox8upoOC9gulk7US858TMXum0h1qcLEy_1lnHtOBdiKfvs2Fxrtg1vBLN3jsRcpn7DAfvT_TGpwK3nDtLRfWMLKhFb9QwK2w_lNXke_ZBtfvifQTakAzJhvaPHolDJ9DIqZqaC_dfRK6oV7L5sZWcQFpLkbxB3K5o-K_AQtgBGbqADgiv0PnSnQTFkYu2wDWOjt7rRQFtBZCvdBL6zPAiIvpA.xX7BKwdnoK14HzPr.CavoFHTufpE6rcg6OSGUQ9inVBwaD0Da2LTfI60E6c4fkaGnORKoTMFJVD4wfubG4H1Lj6_SHOfSmmsLv3CDm-6Kk4io-lXht6J36e-uSFVMXX8iokkFZNQ4Tj2zzn0szAYl_Kjibd4ItqMgqIGPffvERIpnRzLO7Z3IAlW5gvIAs25EWSJi2OL4yuWzGg5eJRBwEy57F1NKqCpvXDaaGtJag7UEsL3PA5VDsCrW3UloVNJgEmBFks2SIFH9MHrqsw-VosWESbcT_Xw3RRhCC3LXFArISBsei6mIrigh91hREur8n7B50Jq-YCJtczuyN1c02ZuyhGYVjJHCTNn06fA7q6sXB6NdcpDcFu1VL-LjCs5EmgfACWtf1h-yQO2iktkOSm2X--SgQ9rween4fqKxs_VncSaNs7OWS7eLj7_DZBt88iqkqMIPy9FEeonHGrDIU-_lLTfZ_OLLc_ZFGW0E6ulQjJD--ycB1ZwGAyXblfp0qqGdk0nNCvFcrnruI7D-XDIusEUYvlBzcWd7PG9pt6WgHC39M-r3REhP_IlkecM2ouZCFj7nd__6riMJ0HAJRGfmLKULsVhOiRarmV9l6mozlE7qGLRV38SzUnfJBcsONXNb_SB49oLKHMkncwDDdgGvvHGXcKuyo1y03Y7gyE0yTUMp5WWbjr6lDZJlYH8dsSwkEjRyrTA_g9vsqBjpdUVWBOfUguL8WjzpBNveaKLo3S_WA1HRIcbO-Yn9_K_i8XsiJCXsZmEky7qT33_CWoQ7NDs-9yTVDOhh5uE9TLRH9WQR4B_BQEJf7eeI3XJx-CNTNSH37AzhYfvO6-Uft-ekPiR9NHdqSO5p8k7RpN01UMviQqcVuLloSz4T85NbWVy9_sC7R_HCh5ePesGsm25WlJiuknGln6q9omd3ATLzEUeUmRifKXT-bHLWLk2jifz7Kxmm-zcJwWdCH9rgEumH2KqVuHawcvbqHbrKkfrmmwNR_hSdRjEnQbS6CZFvzWj4KBxUxYkupP3lvbti79rRhsvseVXTIG_guEw6f-EXnCLl5Hg1IoyjRH1SAkLl_SGISwfNGFzOyhSDCeVzpfI0vrZa_AbbgKmoczhz8vH-OqmAR1SJS-oSyw7jftB9KQEjFSHuYtbKtnSIrbXYt8EQq9G05lpHZNclI7vRh0aJqUAK715kwz-D-Ao0WtQeeCusnjg3VIx4ED1cG72m6GA2h3XPIv-m5VGX-0MMMwXrZydObOX8AdHEpHMfhXEiwZXmyabukF2AQrU6R9CwlaG0fa5sLZxJdTZ3GLZKC0tZEp0mAiyykDodvzKFHUQoeOJgxGB83EVJhCU.FcvNsk68CdlDSh5QmfSuLQ&quot;
}
 
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.43">
      <div class="step-ref passed">43</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def userToken = signIn.response</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.43">19:21:54.302 over-writing existing variable &#39;userToken&#39; with new value: signIn.response
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># The token for the admin user is the input parameter for the callable feature where are defined the steps of the tests</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.46">
      <div class="step-ref passed">46</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def userToken = signIn.response</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.46">19:21:54.303 over-writing existing variable &#39;userToken&#39; with new value: signIn.response
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Create new customers</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># It is necessary to define the userId as the username of the user who create the customers to be read as id in the feature</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.51">
      <div class="step-ref passed">51</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def id = adminDatas.username</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.52">
      <div class="step-ref passed">52</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def saveCustomers = call read(&#39;SaveCustomersNotAdmin.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">12707</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.52">19:22:07.009 dynamic expression complete at index: 3, not map-like: [type: NULL, value: null]
</div>   

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.52.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.SaveCustomersNotAdmin</div>
      </div>
      <div class="time-cell passed">12665</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to generate Customers with a different name than the customers created by the admin</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.10">
      <div class="step-ref passed">10</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def generatorCustomer = function(i){ if (i == 3) return null; return { idCust: &#39;CustNotAdmin&#39; + i, nameCust: &#39;Cutomer Name&#39;, surnameCust: &#39;Customer Surname&#39;, photoCust: &#39;photo.jpg&#39; } }</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def querySaveCustomer = read(&#39;SaveCustomer.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def newCust =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.52.0.call.1.17">{ 
	&quot;id&quot;: &quot;#(idCust)&quot;, 
	&quot;name&quot;: &quot;#(nameCust)&quot;, 
	&quot;surname&quot;: &quot;#(surnameCust)&quot;,
	&quot;photo&quot;: &quot;#(photoCust)&quot;
}</div>

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.27">
      <div class="step-ref passed">27</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.28">
      <div class="step-ref passed">28</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.30">
      <div class="step-ref passed">30</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(querySaveCustomer)&#39;,  variables: &#39;#(newCust)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.31">
      <div class="step-ref passed">31</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">130</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.52.0.call.1.31">19:21:54.339 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 290
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;surname&quot;:&quot;Customer Surname&quot;,&quot;name&quot;:&quot;Cutomer Name&quot;,&quot;photo&quot;:&quot;photo.jpg&quot;,&quot;id&quot;:&quot;CustNotAdmin0&quot;},&quot;query&quot;:&quot;mutation SaveCustomer($id: ID, $name: String, $surname: String, $photo: String) {\r\n    SaveCustomer(input: {id: $id, name: $name, surname: $surname, photo: $photo})\r\n} &quot;}

19:21:54.465 response time in milliseconds: 125
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 30
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:21:54 GMT
1 &lt; x-amzn-RequestId: 5b3debc7-1bb3-465d-9ac0-545847555693
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0b5HXWjoEFo2w=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ab2-087eb2dc39d3f93f1f6f1f7f;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 e9c760453b6eccd1556a68a55a4a90c5.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: Xg-z4QvTLKO0-tzSIbLoXNGncby0q7R3IMuP7ND6W9GFhvVSlrKw7g==
{&quot;data&quot;:{&quot;SaveCustomer&quot;:true}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.32">
      <div class="step-ref passed">32</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.34">
      <div class="step-ref passed">34</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4013</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.37">
      <div class="step-ref passed">37</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.1.40">
      <div class="step-ref passed">40</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to generate Customers with a different name than the customers created by the admin</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.10">
      <div class="step-ref passed">10</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def generatorCustomer = function(i){ if (i == 3) return null; return { idCust: &#39;CustNotAdmin&#39; + i, nameCust: &#39;Cutomer Name&#39;, surnameCust: &#39;Customer Surname&#39;, photoCust: &#39;photo.jpg&#39; } }</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def querySaveCustomer = read(&#39;SaveCustomer.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def newCust =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.52.0.call.2.17">{ 
	&quot;id&quot;: &quot;#(idCust)&quot;, 
	&quot;name&quot;: &quot;#(nameCust)&quot;, 
	&quot;surname&quot;: &quot;#(surnameCust)&quot;,
	&quot;photo&quot;: &quot;#(photoCust)&quot;
}</div>

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.27">
      <div class="step-ref passed">27</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.28">
      <div class="step-ref passed">28</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.30">
      <div class="step-ref passed">30</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(querySaveCustomer)&#39;,  variables: &#39;#(newCust)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.31">
      <div class="step-ref passed">31</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">203</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.52.0.call.2.31">19:21:58.490 request:
2 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
2 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
2 &gt; Content-Type: application/json; charset=UTF-8
2 &gt; Content-Length: 290
2 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
2 &gt; Connection: Keep-Alive
2 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
2 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;surname&quot;:&quot;Customer Surname&quot;,&quot;name&quot;:&quot;Cutomer Name&quot;,&quot;photo&quot;:&quot;photo.jpg&quot;,&quot;id&quot;:&quot;CustNotAdmin1&quot;},&quot;query&quot;:&quot;mutation SaveCustomer($id: ID, $name: String, $surname: String, $photo: String) {\r\n    SaveCustomer(input: {id: $id, name: $name, surname: $surname, photo: $photo})\r\n} &quot;}

19:21:58.691 response time in milliseconds: 200
2 &lt; 200
2 &lt; Content-Type: application/json
2 &lt; Content-Length: 30
2 &lt; Connection: keep-alive
2 &lt; Date: Thu, 20 May 2021 17:21:58 GMT
2 &lt; x-amzn-RequestId: 9533530c-c5e4-42a3-a459-01ea078a2fbc
2 &lt; Access-Control-Allow-Origin: *
2 &lt; x-amz-apigw-id: fo0cjFYxDoEFUXA=
2 &lt; X-Amzn-Trace-Id: Root=1-60a69ab6-34bc79283b86778366eae00a;Sampled=0
2 &lt; X-Cache: Miss from cloudfront
2 &lt; Via: 1.1 ddbdcc33fa1a8a511d1bd00cf3e020d6.cloudfront.net (CloudFront)
2 &lt; X-Amz-Cf-Pop: MAD51-C2
2 &lt; X-Amz-Cf-Id: sr8OpgnkIF5V14G5MYcQGwCIrKbX02n3x3mZjlXg-LnkvDkChYEXrQ==
{&quot;data&quot;:{&quot;SaveCustomer&quot;:true}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.32">
      <div class="step-ref passed">32</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.34">
      <div class="step-ref passed">34</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4006</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.37">
      <div class="step-ref passed">37</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.2.40">
      <div class="step-ref passed">40</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to generate Customers with a different name than the customers created by the admin</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.10">
      <div class="step-ref passed">10</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def generatorCustomer = function(i){ if (i == 3) return null; return { idCust: &#39;CustNotAdmin&#39; + i, nameCust: &#39;Cutomer Name&#39;, surnameCust: &#39;Customer Surname&#39;, photoCust: &#39;photo.jpg&#39; } }</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def querySaveCustomer = read(&#39;SaveCustomer.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def newCust =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.52.0.call.3.17">{ 
	&quot;id&quot;: &quot;#(idCust)&quot;, 
	&quot;name&quot;: &quot;#(nameCust)&quot;, 
	&quot;surname&quot;: &quot;#(surnameCust)&quot;,
	&quot;photo&quot;: &quot;#(photoCust)&quot;
}</div>

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.27">
      <div class="step-ref passed">27</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.28">
      <div class="step-ref passed">28</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.30">
      <div class="step-ref passed">30</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(querySaveCustomer)&#39;,  variables: &#39;#(newCust)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.31">
      <div class="step-ref passed">31</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">285</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.52.0.call.3.31">19:22:02.709 request:
3 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
3 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
3 &gt; Content-Type: application/json; charset=UTF-8
3 &gt; Content-Length: 290
3 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
3 &gt; Connection: Keep-Alive
3 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
3 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;surname&quot;:&quot;Customer Surname&quot;,&quot;name&quot;:&quot;Cutomer Name&quot;,&quot;photo&quot;:&quot;photo.jpg&quot;,&quot;id&quot;:&quot;CustNotAdmin2&quot;},&quot;query&quot;:&quot;mutation SaveCustomer($id: ID, $name: String, $surname: String, $photo: String) {\r\n    SaveCustomer(input: {id: $id, name: $name, surname: $surname, photo: $photo})\r\n} &quot;}

19:22:02.991 response time in milliseconds: 282
3 &lt; 200
3 &lt; Content-Type: application/json
3 &lt; Content-Length: 30
3 &lt; Connection: keep-alive
3 &lt; Date: Thu, 20 May 2021 17:22:02 GMT
3 &lt; x-amzn-RequestId: 81a5cad2-699c-417a-ae6c-24c8909741d7
3 &lt; Access-Control-Allow-Origin: *
3 &lt; x-amz-apigw-id: fo0dOFY1joEF9vQ=
3 &lt; X-Amzn-Trace-Id: Root=1-60a69aba-0e15bf6c70761e0735a285d2;Sampled=0
3 &lt; X-Cache: Miss from cloudfront
3 &lt; Via: 1.1 9809ca806cde9d8f9a57379e55ece5b7.cloudfront.net (CloudFront)
3 &lt; X-Amz-Cf-Pop: MAD51-C2
3 &lt; X-Amz-Cf-Id: BWTRxhic4zFqffXzLhYg8aBdr2NOiaIobgmL558UC1Xi7NJfeRl9sQ==
{&quot;data&quot;:{&quot;SaveCustomer&quot;:true}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.32">
      <div class="step-ref passed">32</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.34">
      <div class="step-ref passed">34</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4015</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.37">
      <div class="step-ref passed">37</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.52.0.call">
    <div class="step-container" id="0.52.0.call.3.40">
      <div class="step-ref passed">40</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### List all customers</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.56">
      <div class="step-ref passed">56</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def listCustomers = call read(&#39;CustomerReadModels.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">295</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.56.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.CustomerReadModels</div>
      </div>
      <div class="time-cell passed">283</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.8">
      <div class="step-ref passed">8</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def queryCustomerReadModels = read(&#39;CustomerReadModels.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.10">
      <div class="step-ref passed">10</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(queryCustomerReadModels)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">275</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.56.0.call.0.14">19:22:07.021 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 167
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;query&quot;:&quot;query CustomerReadModels {\r\n    CustomerReadModels {\r\n        id\r\n        name\r\n        surname\r\n        photoUrl\r\n        userId\r\n    }\r\n}&quot;}

19:22:07.293 response time in milliseconds: 271
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 396
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:07 GMT
1 &lt; x-amzn-RequestId: 7be24756-1068-46a0-9a99-47859b91d9fc
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0d5GCyjoEFuyQ=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69abf-13a0210256484dd47ada5715;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 e9fa09c7497a12fe8b4961214200fa71.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: VAppksBOfFBgDfbsef2zUNViwtqKDyaqhuPvq5tKOZGB1y775p5dkA==
{&quot;data&quot;:{&quot;CustomerReadModels&quot;:[{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer Surname&quot;,&quot;name&quot;:&quot;Cutomer Name&quot;,&quot;id&quot;:&quot;CustNotAdmin2&quot;,&quot;userId&quot;:&quot;userNotAdmin@test.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer Surname&quot;,&quot;name&quot;:&quot;Cutomer Name&quot;,&quot;id&quot;:&quot;CustNotAdmin1&quot;,&quot;userId&quot;:&quot;userNotAdmin@test.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer Surname&quot;,&quot;name&quot;:&quot;Cutomer Name&quot;,&quot;id&quot;:&quot;CustNotAdmin0&quot;,&quot;userId&quot;:&quot;userNotAdmin@test.com&quot;}]}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Check that the query doesn&#39;t fail</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.21">
      <div class="step-ref passed">21</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Print the response</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.24">
      <div class="step-ref passed">24</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print response.data.CustomerReadModels</span>
      </div>
    </div>
    <div class="time-cell passed">4</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.56.0.call.0.24">19:22:07.300 [print] [
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer Surname&quot;,
    &quot;name&quot;: &quot;Cutomer Name&quot;,
    &quot;id&quot;: &quot;CustNotAdmin2&quot;,
    &quot;userId&quot;: &quot;userNotAdmin@test.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer Surname&quot;,
    &quot;name&quot;: &quot;Cutomer Name&quot;,
    &quot;id&quot;: &quot;CustNotAdmin1&quot;,
    &quot;userId&quot;: &quot;userNotAdmin@test.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer Surname&quot;,
    &quot;name&quot;: &quot;Cutomer Name&quot;,
    &quot;id&quot;: &quot;CustNotAdmin0&quot;,
    &quot;userId&quot;: &quot;userNotAdmin@test.com&quot;
  }
]
 
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.56.0.call">
    <div class="step-container" id="0.56.0.call.0.25">
      <div class="step-ref passed">25</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.data.CustomerReadModels contains {id: &#39;#ignore&#39;, name: &#39;#ignore&#39;, surname: &#39;#ignore&#39;, photoUrl: &#39;#ignore&#39;, userId: &#39;#ignore&#39; }</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Update customers</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Take the first customer of the above response to modify</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.61">
      <div class="step-ref passed">61</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def first_customer = listCustomers.response.data.CustomerReadModels[0]</span>
      </div>
    </div>
    <div class="time-cell passed">3</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.63">
      <div class="step-ref passed">63</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>set first_customer.name = &quot;name changed&quot;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.64">
      <div class="step-ref passed">64</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>set first_customer.surname = &quot;surname changed&quot;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.65">
      <div class="step-ref passed">65</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>set first_customer.photoURL = &quot;newPhoto.jpg&quot;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.68">
      <div class="step-ref passed">68</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def updateCustomer = call read(&#39;SaveCustomer.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">4310</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.68.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.SaveCustomer</div>
      </div>
      <div class="time-cell passed">4292</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def querySaveCustomer = read(&#39;SaveCustomer.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The body of the graphql request is a JSON with the generated values</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def newCust =</span>
      </div>
    </div>
    <div class="time-cell passed">4</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.68.0.call.0.14">{ 
	&quot;id&quot;: &quot;#(first_customer.id)&quot;, 
	&quot;name&quot;: &quot;#(first_customer.name)&quot;, 
	&quot;surname&quot;: &quot;#(first_customer.surname)&quot;,
	&quot;photo&quot;: &quot;#(first_customer.photo)&quot;
}</div>

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.24">
      <div class="step-ref passed">24</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.25">
      <div class="step-ref passed">25</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.27">
      <div class="step-ref passed">27</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(querySaveCustomer)&#39;,  variables: &#39;#(newCust)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.28">
      <div class="step-ref passed">28</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">279</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.68.0.call.0.28">19:22:07.329 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 282
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;surname&quot;:&quot;surname changed&quot;,&quot;name&quot;:&quot;name changed&quot;,&quot;photo&quot;:null,&quot;id&quot;:&quot;CustNotAdmin2&quot;},&quot;query&quot;:&quot;mutation SaveCustomer($id: ID, $name: String, $surname: String, $photo: String) {\r\n    SaveCustomer(input: {id: $id, name: $name, surname: $surname, photo: $photo})\r\n} &quot;}

19:22:07.606 response time in milliseconds: 276
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 30
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:07 GMT
1 &lt; x-amzn-RequestId: ca1f5156-3c07-404e-9705-3b48ee28650f
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0d8FZkjoEFZlQ=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69abf-7592b71d081479c44071946a;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 bb4bb14bfdc4b50fa6e1881933804946.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: bEgQpg3gODJKk-AI2WX9XORTrHZi6gR4blsXrPUPwQiQzj56Bo_g3A==
{&quot;data&quot;:{&quot;SaveCustomer&quot;:true}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.29">
      <div class="step-ref passed">29</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Introduce a pause so the customer can be saved before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.31">
      <div class="step-ref passed">31</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4007</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.34">
      <div class="step-ref passed">34</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># If the customer is saved, the response shouldn&#39;t contain a field &quot;error&quot;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.68.0.call">
    <div class="step-container" id="0.68.0.call.0.37">
      <div class="step-ref passed">37</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### List a customer by id</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Check if the customer was updated properly and it has the reference of the last user who modified</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.73">
      <div class="step-ref passed">73</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def id_Customer =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.73">{
   &quot;id&quot;: &quot;#(first_customer.id)&quot; 
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.79">
      <div class="step-ref passed">79</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def listCustomerId = call read(&#39;CustomerReadModel.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">157</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.79.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.CustomerReadModel</div>
      </div>
      <div class="time-cell passed">131</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.8">
      <div class="step-ref passed">8</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def queryCustomerReadModel = read(&#39;CustomerReadModel.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.10">
      <div class="step-ref passed">10</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(queryCustomerReadModel)&#39;, variables: &#39;#(id_Customer)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">122</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.79.0.call.0.14">19:22:11.646 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 219
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;id&quot;:&quot;CustNotAdmin2&quot;},&quot;query&quot;:&quot;query CustomerReadModel($id: ID!) {\r\n    CustomerReadModel(id: $id) {\r\n        id\r\n        name\r\n        surname\r\n        photoUrl\r\n        userId\r\n    }\r\n}&quot;}

19:22:11.766 response time in milliseconds: 119
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 150
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:11 GMT
1 &lt; x-amzn-RequestId: 28c5b6c3-a1ea-4c60-bcbf-7a0b1a977bac
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0emGxIjoEFr3Q=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ac3-4d9f1a746bce14607ae270fa;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 dadbd3993b5303886df72c2fdce172ca.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: D9zDczV-MXRKzQ8qhD_B8WIdNuHCYRyxzYLnFInRSEAGrd9DK1z8nQ==
{&quot;data&quot;:{&quot;CustomerReadModel&quot;:{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;surname changed&quot;,&quot;name&quot;:&quot;name changed&quot;,&quot;id&quot;:&quot;CustNotAdmin2&quot;,&quot;userId&quot;:&quot;userNotAdmin@test.com&quot;}}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Check that the query doesn&#39;t fail</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.21">
      <div class="step-ref passed">21</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Print the response</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.79.0.call">
    <div class="step-container" id="0.79.0.call.0.24">
      <div class="step-ref passed">24</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print response.data.CustomerReadModel</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.79.0.call.0.24">19:22:11.772 [print] {
  &quot;photoUrl&quot;: &quot;&quot;,
  &quot;surname&quot;: &quot;surname changed&quot;,
  &quot;name&quot;: &quot;name changed&quot;,
  &quot;id&quot;: &quot;CustNotAdmin2&quot;,
  &quot;userId&quot;: &quot;userNotAdmin@test.com&quot;
}
 
</div>   

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#    * match listCustomerId.response.data.CustomerReadModel == {id: &#39;#(first_customer.id)&#39;, name: &#39;#(first_customer.name)&#39;, surname: &#39;#(first_customer.surname)&#39;, photoUrl: &#39;#(first_customer.photoURL)&#39;, userId: &#39;#(newUser.username)&#39; }</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.81">
      <div class="step-ref passed">81</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match listCustomerId.response.data.CustomerReadModel == {id: &#39;#(first_customer.id)&#39;, name: &#39;#(first_customer.name)&#39;, surname: &#39;#(first_customer.surname)&#39;, photoUrl: &#39;#ignore&#39;, userId: &#39;#(newUser.username)&#39; }</span>
      </div>
    </div>
    <div class="time-cell passed">3</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Delete a customer</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Get the last customer from the list obtained before &#39;listCustomers&#39; to delete</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.86">
      <div class="step-ref passed">86</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def numCustomers = listCustomers.response.data.CustomerReadModels.length - 1</span>
      </div>
    </div>
    <div class="time-cell passed">3</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.87">
      <div class="step-ref passed">87</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def customerToDelete = listCustomers.response.data.CustomerReadModels[numCustomers]</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.89">
      <div class="step-ref passed">89</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def customerDelete =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.89">{
   &quot;id&quot;: &quot;#(customerToDelete.id)&quot;
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.95">
      <div class="step-ref passed">95</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def deleteCustomer = call read(&#39;DeleteCustomer.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">4241</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.95.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.DeleteCustomer</div>
      </div>
      <div class="time-cell passed">4218</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def queryDeleteCustomer = read(&#39;DeleteCustomer.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.16">
      <div class="step-ref passed">16</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(queryDeleteCustomer)&#39;,  variables: &#39;#(customerDelete)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">198</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.95.0.call.0.17">19:22:11.807 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 131
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;id&quot;:&quot;CustNotAdmin0&quot;},&quot;query&quot;:&quot;mutation DeleteCustomer($id: ID) {\r\n    DeleteCustomer(input: {id: $id})\r\n} \r\n&quot;}

19:22:12.002 response time in milliseconds: 195
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 32
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:12 GMT
1 &lt; x-amzn-RequestId: eb9f15fd-371a-4def-95db-3a3952edadfa
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0eoHECDoEF7tA=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ac3-38408de810df71ef4703c0e5;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 fc84dd3d81f101f017733b4720a09e8c.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: -I1znogfvRubMxmJ39jWfV-ZPLWR9T8yzLbeY_7yIXvkQ7unU-dI8A==
{&quot;data&quot;:{&quot;DeleteCustomer&quot;:true}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Introduce a pause so the customer can be delete before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.20">
      <div class="step-ref passed">20</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4017</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.23">
      <div class="step-ref passed">23</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># If the customer was delete, the response shouldn&#39;t contain a field &quot;error&quot;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.95.0.call">
    <div class="step-container" id="0.95.0.call.0.26">
      <div class="step-ref passed">26</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### List the customer to check that it was properly delete</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.98">
      <div class="step-ref passed">98</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def id_Customer =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.98">{
   &quot;id&quot;: &quot;#(customerToDelete.id)&quot; 
}</div>

  

  <div class="preformatted" data-parent="0.98">19:22:16.028 over-writing existing variable &#39;id_Customer&#39; with new value: {
   &quot;id&quot;: &quot;#(customerToDelete.id)&quot; 
}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.104">
      <div class="step-ref passed">104</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def listCustomerDelete = call read(&#39;CustomerReadModel.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">235</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.104.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.CustomerReadModel</div>
      </div>
      <div class="time-cell passed">200</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.8">
      <div class="step-ref passed">8</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def queryCustomerReadModel = read(&#39;CustomerReadModel.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.10">
      <div class="step-ref passed">10</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(queryCustomerReadModel)&#39;, variables: &#39;#(id_Customer)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">195</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.104.0.call.0.14">19:22:16.053 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 219
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;id&quot;:&quot;CustNotAdmin0&quot;},&quot;query&quot;:&quot;query CustomerReadModel($id: ID!) {\r\n    CustomerReadModel(id: $id) {\r\n        id\r\n        name\r\n        surname\r\n        photoUrl\r\n        userId\r\n    }\r\n}&quot;}

19:22:16.244 response time in milliseconds: 191
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 35
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:16 GMT
1 &lt; x-amzn-RequestId: e60138e8-d01e-4806-97ff-c4d0af85d992
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0fTGdmjoEF_bw=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ac8-2cd3c28d55863dc45c15b6c3;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 84edc0906da5023aac71c5fb4a35cd89.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: EWVP3SPTN5KPeSdbPGL0zR9JCf8VrTUaDt_BODAd03r4_hE6OgzqJw==
{&quot;data&quot;:{&quot;CustomerReadModel&quot;:null}}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Check that the query doesn&#39;t fail</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.21">
      <div class="step-ref passed">21</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Print the response</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.104.0.call">
    <div class="step-container" id="0.104.0.call.0.24">
      <div class="step-ref passed">24</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print response.data.CustomerReadModel</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.104.0.call.0.24">19:22:16.249 [print] null 
</div>   

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.105">
      <div class="step-ref passed">105</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match listCustomerDelete.response.data.CusotmerReadModel == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Test the features not allowed to a not admin user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Read user models</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># List all the users of the API, it should fail because it is not an admin user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.113">
      <div class="step-ref passed">113</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def listUsers = call read(&#39;UserReadModels.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">127</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.113.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.UserReadModels</div>
      </div>
      <div class="time-cell passed">95</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container" id="0.113.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container" id="0.113.0.call.0.8">
      <div class="step-ref passed">8</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def queryUserReadModels = read(&#39;UserReadModels.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container" id="0.113.0.call.0.10">
      <div class="step-ref passed">10</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container" id="0.113.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container" id="0.113.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(queryUserReadModels)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container" id="0.113.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">93</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.113.0.call.0.14">19:22:16.281 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 102
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;query&quot;:&quot;query UserReadModels {\r\n    UserReadModels {\r\n        id\r\n        role\r\n    }\r\n}&quot;}

19:22:16.372 response time in milliseconds: 91
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 162
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:16 GMT
1 &lt; x-amzn-RequestId: e23b6ab8-d90d-47bf-b363-f050c0bae868
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0fVHygjoEF9pA=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ac8-0750d4de094fabde553410bd;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 c317421ad77a6a1c3629f150c353ffe5.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: 4AeapDqm0yiI8oHfbGI8IEQZAz2sgOfgCnG3p4n5IM6ayeaHTSv-0w==
{&quot;data&quot;:{&quot;UserReadModels&quot;:null},&quot;errors&quot;:[{&quot;path&quot;:[&quot;UserReadModels&quot;],&quot;locations&quot;:[{&quot;line&quot;:2,&quot;column&quot;:5}],&quot;message&quot;:&quot;Access denied for read model UserReadModel&quot;}]}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container" id="0.113.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.113.0.call">
    <div class="step-container" id="0.113.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.114">
      <div class="step-ref passed">114</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match listUsers.response.errors contains deep { message: &#39;Access denied for read model UserReadModel&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Save new users</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.118">
      <div class="step-ref passed">118</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def newUser =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.118">{ 
	&quot;username&quot;: &quot;user@test.com&quot;, 
	&quot;password&quot;: &quot;Password_1&quot;, 
	&quot;role&quot;: &quot;user&quot;
}</div>

  

  <div class="preformatted" data-parent="0.118">19:22:16.392 over-writing existing variable &#39;newUser&#39; with new value: { 
	&quot;username&quot;: &quot;user@test.com&quot;, 
	&quot;password&quot;: &quot;Password_1&quot;, 
	&quot;role&quot;: &quot;user&quot;
}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.126">
      <div class="step-ref passed">126</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def saveUser = call read(&#39;SaveUser.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">4206</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.126.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.SaveUser</div>
      </div>
      <div class="time-cell passed">4172</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.126.0.call.0.4">19:22:16.392 over-writing existing variable &#39;saveUser&#39; with new value: call read(&#39;SaveUser.feature&#39;) userToken
</div>   

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def querySaveUser = read(&#39;SaveUser.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.16">
      <div class="step-ref passed">16</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(querySaveUser)&#39;,  variables: &#39;#(newUser)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">159</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.126.0.call.0.17">19:22:16.416 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 249
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;password&quot;:&quot;Password_1&quot;,&quot;role&quot;:&quot;user&quot;,&quot;username&quot;:&quot;user@test.com&quot;},&quot;query&quot;:&quot;mutation SaveUser($username: String, $password: String, $role: String) {\r\n    SaveUser(input: {username: $username, password: $password, role: $role})\r\n} &quot;}

19:22:16.572 response time in milliseconds: 156
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 144
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:16 GMT
1 &lt; x-amzn-RequestId: 3b50cf90-dcdd-428c-a9ca-70e01fc8473d
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0fXFwPDoEFhkA=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ac8-3bacd2d01a72f8ad560e0780;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 bb4bb14bfdc4b50fa6e1881933804946.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: aXy8eMQ1xLTYvRMSFNhdeWOFRKJBSdm_W1QfOgJDgxPwtGcFyefAyA==
{&quot;data&quot;:{&quot;SaveUser&quot;:null},&quot;errors&quot;:[{&quot;path&quot;:[&quot;SaveUser&quot;],&quot;locations&quot;:[{&quot;line&quot;:2,&quot;column&quot;:5}],&quot;message&quot;:&quot;Access denied for command &#39;SaveUser&#39;&quot;}]}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Introduce a pause so the user can be saved before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.20">
      <div class="step-ref passed">20</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4010</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.126.0.call">
    <div class="step-container" id="0.126.0.call.0.23">
      <div class="step-ref passed">23</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.127">
      <div class="step-ref passed">127</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def expected =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.127">{
   &quot;message&quot;: &quot;Access denied for command &#39;SaveUser&#39;&quot;
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.133">
      <div class="step-ref passed">133</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match saveUser.response.errors contains deep expected</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Delete user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># It isn&#39;t necessary that the user exist because it should response with a message of &#39;Access denied&#39;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.137">
      <div class="step-ref passed">137</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def usernameDelete =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.137">{
   &quot;username&quot;: &quot;user@test.com&quot;
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.143">
      <div class="step-ref passed">143</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def deleteUser = call read(&#39;DeleteUser.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">4248</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.143.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.DeleteUser</div>
      </div>
      <div class="time-cell passed">4202</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def queryDeleteUser = read(&#39;DeleteUser.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.16">
      <div class="step-ref passed">16</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(queryDeleteUser)&#39;,  variables: &#39;#(usernameDelete)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">186</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.143.0.call.0.17">19:22:20.625 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 146
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;username&quot;:&quot;user@test.com&quot;},&quot;query&quot;:&quot;mutation DeleteUser($username: String) {\r\n    DeleteUser(input: {username: $username})\r\n}&quot;}

19:22:20.809 response time in milliseconds: 183
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 150
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:20 GMT
1 &lt; x-amzn-RequestId: 0f2846d3-c757-4dfc-b109-8571c2c369a8
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0gBHTcDoEF1VQ=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69acc-553daf6861e4d99f501ee208;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 32713ef80c317f26bc1691bc0aad3819.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: t0RnWuj0EgM1uQ2GzvrG-Sb0wQipxvbv1UxANyPScGSGbnW8jKQbyQ==
{&quot;data&quot;:{&quot;DeleteUser&quot;:null},&quot;errors&quot;:[{&quot;path&quot;:[&quot;DeleteUser&quot;],&quot;locations&quot;:[{&quot;line&quot;:2,&quot;column&quot;:5}],&quot;message&quot;:&quot;Access denied for command &#39;DeleteUser&#39;&quot;}]}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Introduce a pause so the user can be delete before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.20">
      <div class="step-ref passed">20</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4013</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.143.0.call">
    <div class="step-container" id="0.143.0.call.0.23">
      <div class="step-ref passed">23</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.144">
      <div class="step-ref passed">144</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def expected =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.144">{
   &quot;message&quot;: &quot;Access denied for command &#39;DeleteUser&#39;&quot;
}</div>

  

  <div class="preformatted" data-parent="0.144">19:22:24.847 over-writing existing variable &#39;expected&#39; with new value: {
   &quot;message&quot;: &quot;Access denied for command &#39;DeleteUser&#39;&quot;
}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.150">
      <div class="step-ref passed">150</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match deleteUser.response.errors contains deep expected</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### List a user by id</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># It isn&#39;t necessary that the user exist because it should response with a message of &#39;Access denied&#39;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.154">
      <div class="step-ref passed">154</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def id =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.154">{
	&quot;id&quot;: &quot;user@test.com&quot;
}</div>

  

  <div class="preformatted" data-parent="0.154">19:22:24.849 over-writing existing variable &#39;id&#39; with new value: {
	&quot;id&quot;: &quot;user@test.com&quot;
}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.160">
      <div class="step-ref passed">160</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def listUserDelete = call read(&#39;UserReadModel.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">167</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.160.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.UserReadModel</div>
      </div>
      <div class="time-cell passed">118</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container" id="0.160.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container" id="0.160.0.call.0.8">
      <div class="step-ref passed">8</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def queryUserReadModel = read(&#39;UserReadModel.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container" id="0.160.0.call.0.10">
      <div class="step-ref passed">10</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container" id="0.160.0.call.0.11">
      <div class="step-ref passed">11</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container" id="0.160.0.call.0.13">
      <div class="step-ref passed">13</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(queryUserReadModel)&#39;, variables: &#39;#(id)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container" id="0.160.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">116</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.160.0.call.0.14">19:22:24.873 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 154
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;id&quot;:&quot;user@test.com&quot;},&quot;query&quot;:&quot;query UserReadModel($id: ID!) {\r\n    UserReadModel(id: $id) {\r\n        id\r\n        role\r\n    }\r\n}&quot;}

19:22:24.986 response time in milliseconds: 112
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 160
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:25 GMT
1 &lt; x-amzn-RequestId: 51f66d96-0c65-4604-9f9f-182971c78a9c
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0grEAtDoEFXIA=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ad1-1a7853833a559d48313be223;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 158bf65e81ba82d619c73dde6c7796a9.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: 4b1o6RM7izXpoiYtlYgMmBQHYmPXrhd7dzbqDAQ7JBzyShXdcmd9aQ==
{&quot;data&quot;:{&quot;UserReadModel&quot;:null},&quot;errors&quot;:[{&quot;path&quot;:[&quot;UserReadModel&quot;],&quot;locations&quot;:[{&quot;line&quot;:2,&quot;column&quot;:5}],&quot;message&quot;:&quot;Access denied for read model UserReadModel&quot;}]}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container" id="0.160.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.160.0.call">
    <div class="step-container" id="0.160.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.161">
      <div class="step-ref passed">161</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match listUserDelete.response.errors contains deep { message: &#39;Access denied for read model UserReadModel&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">### Change the role of one user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># It isn&#39;t necessary that the user exist because it should response with a message of &#39;Access denied&#39;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.165">
      <div class="step-ref passed">165</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def userChangeRole =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.165">{
  &quot;username&quot;: &quot;user@test.com&quot;,
  &quot;role&quot;: &quot;role&quot;
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.172">
      <div class="step-ref passed">172</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def change_role = call read(&#39;ChangeUserRole.feature&#39;) userToken</span>
      </div>
    </div>
    <div class="time-cell passed">4181</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.172.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">test.graphql.ChangeUserRole</div>
      </div>
      <div class="time-cell passed">4110</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># The query is read from a *.graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.12">
      <div class="step-ref passed">12</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def queryChangeUserRole = read(&#39;ChangeUserRole.graphql&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.14">
      <div class="step-ref passed">14</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = userToken.tokenType + &#39; &#39; + userToken.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(queryChangeUserRole)&#39;,  variables: &#39;#(userChangeRole)&#39;  }</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">93</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.172.0.call.0.18">19:22:25.058 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjNzUyYzVhYS04YzhkLTQxMjQtYjlkYy0yNWFjMTljMDFmYzgiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6ImQ1ODdiMzQwLTYyZjgtNGZiYi1hNDM0LTQ4ODU4ZGRkZTgzZCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxNTMxMzE0LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiYzc1MmM1YWEtOGM4ZC00MTI0LWI5ZGMtMjVhYzE5YzAxZmM4IiwiZXhwIjoxNjIxNTM0OTE0LCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjE1MzEzMTQsImVtYWlsIjoidXNlck5vdEFkbWluQHRlc3QuY29tIn0.XSZgFXJjAVsutr4f9n40b2LhfBdxO07SZr1IXHqUlVdpMIkCmamZWx3_eWFxb4-S1Sp69wcgrxTzXwYDe_dJOMGuUYpVoF7BvGrL7LWAwWH3ONZuSBq9a9ifD_v3MrCqFyxHLodb7x7e9aZ3VQrmxf6XdvyCH2hPtgx5Xdw73bVFIGj52OuupJhgc6gcB1uxxpJWwuV4WUoP9gH0JOhpYL01fBV_5XsspkxGsLb3Ex9HxkpVb1XUugYPPdNu3olVVtZ-8jfDH5i01_xvfdgJ1A_U0noVG06c8YI1bOK4g5_XKk1U43F3Hx5902nTcLDQHEDPB1lyisSbDZzggfYAGA
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 194
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;role&quot;:&quot;role&quot;,&quot;username&quot;:&quot;user@test.com&quot;},&quot;query&quot;:&quot;mutation ChangeUserRole($username: String, $role: String) {\r\n  ChangeUserRole(input: {username: $username, role: $role})\r\n}&quot;}

19:22:25.148 response time in milliseconds: 89
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 162
1 &lt; Connection: keep-alive
1 &lt; Date: Thu, 20 May 2021 17:22:25 GMT
1 &lt; x-amzn-RequestId: 389f9b11-3306-44e7-9e76-9db69fee00bc
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fo0gsHiFjoEF1VQ=
1 &lt; X-Amzn-Trace-Id: Root=1-60a69ad1-6952902b47ea9eef0ccd2595;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 83f9969abb9f43b17789799503ae532d.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: u9qzbOCu3sShl8Qm_vQLc5wFJs6Tw_VOzE4jMluVXRLqan1Q_8vJNg==
{&quot;data&quot;:{&quot;ChangeUserRole&quot;:null},&quot;errors&quot;:[{&quot;path&quot;:[&quot;ChangeUserRole&quot;],&quot;locations&quot;:[{&quot;line&quot;:2,&quot;column&quot;:3}],&quot;message&quot;:&quot;Access denied for command &#39;ChangeUserRole&#39;&quot;}]}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.19">
      <div class="step-ref passed">19</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment"># Introduce a pause so the user can be saved before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.172.0.call">
    <div class="step-container" id="0.172.0.call.0.21">
      <div class="step-ref passed">21</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4014</div>
  </div>

   
  
  

  

     

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.173">
      <div class="step-ref passed">173</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def expected =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.173">{
   &quot;message&quot;: &quot;Access denied for command &#39;ChangeUserRole&#39;&quot;
}</div>

  

  <div class="preformatted" data-parent="0.173">19:22:29.198 over-writing existing variable &#39;expected&#39; with new value: {
   &quot;message&quot;: &quot;Access denied for command &#39;ChangeUserRole&#39;&quot;
}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.179">
      <div class="step-ref passed">179</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match change_role.response.errors contains deep expected</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
        </div>
      </div>
    </div>
  </body>
</html>

