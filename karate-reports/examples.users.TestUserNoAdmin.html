<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="res/bootstrap.min.css" type="text/css"/>
    <link rel="stylesheet" href="res/karate-report.css" type="text/css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <script type="text/javascript" src="res/jquery.min.js"></script>
    <script type="text/javascript" src="res/jquery.tablesorter.min.js"></script>
    <script type="text/javascript" src="res/bootstrap.min.js"></script>
    <script type="text/javascript" src="res/karate-report.js"></script>
    <title>examples.users.TestUserNoAdmin</title>  
  </head>
  <body>   
    <div id="root-container">
      <div id="leftnav">
                
        <div>
  <div class="nav-logo">
    <a href="karate-summary.html">
      <img src="karate-logo.svg" alt="Karate"/>
    </a>
    <div class="nav-count">
      <div id="nav-pass" class="bg-success">1</div>
      <div id="nav-fail" class="bg-danger">0</div>
    </div>
  </div>
  <div id="nav-type">
    <div>Scenarios</div>
  </div>         
  <div id="nav-date">
    <div>2021-05-17 03:58:10 p.Â m.</div>
  </div>        
</div>

        <div class="nav-container">
          <div class="nav-item passed">
            <a href="#[1:10]"><span>[1:10]</span> <span>Querys for an user not admin</span></a>
          </div>
        </div>
      </div>
      <div id="content">
        <div class="page-heading alert alert-primary">
          <a href="karate-summary.html">Summary</a><span class="feature-label">|</span>
          <a href="karate-tags.html">Tags</a><span class="feature-label">|</span>
          <span class="feature-label">Feature:</span>
          <span class="feature-path">examples/users/TestUserNoAdmin.feature</span><span class="feature-label">|</span>
          <span class="feature-name">Test the query that an user not admin is allowed to do in the environment set from the java class</span>
          <span class="feature-description"></span>
        </div>
        <div class="scenario">
          <div class="scenario-heading" id="[1:10]">
            <div class="heading-container">
              <div class="scenario-tags">
                
              </div>
              <div class="scenario-keyword">
                Scenario: <span>[1:10]</span>
                <span class="scenario-name">Querys for an user not admin</span>
                <span></span>
              </div>
            </div>
            <div class="scenario-time passed">
              <span>ms:</span>&nbsp;<span>10242</span>
            </div>
          </div>
          <div class="step-row">
            <div class="step-container" id="[1:10]bg">
              <div class="step-ref bg-step">&gt;&gt;</div>
              <div class="step-cell passed">Background:</div>
            </div>
            <div class="time-cell passed"></div>
          </div>
          <div data-parent="[1:10]bg"><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.6">
      <div class="step-ref bg-step">6</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.6">15:58:00.643 karate.env system property was: prod 
</div>   

  

</div>
</div>
          <div data-parent="[1:10]bg"><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.8">
      <div class="step-ref bg-step">8</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#### Get the idToken for one of the user created by the admin. Datas are read from a JSON file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.13">
      <div class="step-ref passed">13</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def datas = read(&#39;signinDatasUserNoAdmin.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">37</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Call the feature to sign in the API with the JSON file that contains the user&#39;s datas</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.16">
      <div class="step-ref passed">16</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def signIn = call read(&#39;signin.feature&#39;) datas</span>
      </div>
    </div>
    <div class="time-cell passed">929</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.16.0.call">
        <div class="step-ref passed">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">examples.users.signin</div>
      </div>
      <div class="time-cell passed">906</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.4">
      <div class="step-ref passed">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.7">
      <div class="step-ref passed">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">5</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.16.0.call.0.7">{
  		&quot;clientId&quot;: &quot;#(clientId)&quot;,
        &quot;username&quot;: &quot;#(username)&quot;,
  		&quot;password&quot;: &quot;#(password)&quot;
	}</div>

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.15">
      <div class="step-ref passed">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print query</span>
      </div>
    </div>
    <div class="time-cell passed">5</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.16.0.call.0.15">15:58:00.739 [print] {
  &quot;clientId&quot;: &quot;799hogucm363v55l7dk2n1l5u0&quot;,
  &quot;username&quot;: &quot;user8@test.com&quot;,
  &quot;password&quot;: &quot;Password_1&quot;
}
 
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.17">
      <div class="step-ref passed">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;/auth/sign-in&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">7</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.18">
      <div class="step-ref passed">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request query</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.19">
      <div class="step-ref passed">19</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Content-Type = &#39;application/json&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.20">
      <div class="step-ref passed">20</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">886</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.16.0.call.0.20">15:58:00.946 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/auth/sign-in
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 93
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;password&quot;:&quot;Password_1&quot;,&quot;clientId&quot;:&quot;799hogucm363v55l7dk2n1l5u0&quot;,&quot;username&quot;:&quot;user8@test.com&quot;}

15:58:01.631 response time in milliseconds: 683
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 3994
1 &lt; Connection: keep-alive
1 &lt; Date: Mon, 17 May 2021 13:58:02 GMT
1 &lt; x-amzn-RequestId: b2020764-9135-408a-8edc-95eacddba6e1
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fedwhGoJjoEFa0w=
1 &lt; X-Amzn-Trace-Id: Root=1-60a27669-3ad8f82c07fba3f557918d14
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 dadbd3993b5303886df72c2fdce172ca.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: wVApkbQs_C9j8vUb_Enl-eRTSRVSLtHIeSFHssbuw2Uk1YPnyGw_-w==
{&quot;expiresIn&quot;:&quot;3600&quot;,&quot;idToken&quot;:&quot;eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw&quot;,&quot;accessToken&quot;:&quot;eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjEyNTk4ODEsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTI2MzQ4MSwiaWF0IjoxNjIxMjU5ODgyLCJqdGkiOiI0OWQzZGE2YS0wZjQ1LTRhMTctYWQ3ZC1lZjRlMzYyYzY1OWIiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIn0.MVZWmX1wwxZX4X2r63Om5FBMoDgfw8hv-EXGgmI-Rhvp5DRRJkne1cCYTujavymD62dN8-lROZjqxIhKxtx57bOU560kaAeyq4NBNEh9NOIdWLiB5RHGdoqoDGSwbAKJnQqB2piFDAqoThtEVEIOHkmKFSYYliXyQBWXrtHkDETPwb-i7-upwPCa98q7euTbBYM-mXgP1yGF7zGqAGgFyw7LGNkGOGKQU_kspEsDbnmEtlAMH_LJ3v8_JjRd_tBOJYrmHERTH1IWG1o9jiTKBsuc225MWu6aIB-1H9K7U7QwN5tA-Bcy6pX7M-RnHVmVPWkl30YvyziYkrYUtQt9HQ&quot;,&quot;tokenType&quot;:&quot;Bearer&quot;,&quot;refreshToken&quot;:&quot;eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.cEIO8gPpGDudi4GhhmY2UGJ3KJOvUCBqqG5SmudulUfLr8iedG38eOMnqgfYOupYexpAiOGi2P_ygsrV_4Ji37eZiuKGIo19iqT1ztD13PPdWEf7eXdyKtwL4d19fPHiLtcGIV6LKdNCRUoB1Cy-6QVlW7fQ9HwmA09EAZXCQGhQWVW3TozOjLmIxIIj9-UkOlDmNROFOf7GyJikllVv01Q8S0ewdBjN53vKjpGXVgR_IaSdne0yj8-jalQxsbltT6P94Vtg11TkYC_2B6De5VvXFChVPx0xxH0KrI9sJhCJ5528-kPLV0as-W0JXePG0DG7ybEWglk5oM6CzU8lyQ.9eZ1y5HCu8EwO6vg.vv5JQHsgc1La1hI4iQo5yq9epOYhAaWHziLJ8fXh5wcRoDjxBqi8mgTD54idxn7kdHKjULnYInRkJ7SEQKrRem9zIhLjbf9FgBP-TsWKW7c9wHNrE9dPcU9Byejfo6M7IjKNSy0btQkPGhaW3BcBwWhe650sQZLUWq58fTIchjZkjdCrGr5Oo-QrzQb3ih-Peni4hRkB6FF00ILj4M1BBakMp30unnkzOxyhV7QQqq62pagGCrn9Lw2pj1N7FHPrPEajQxQHHrjMM6ppGAa672mL9X_rPPJbpZ6X_rzIbfjPkoMlldNGPKhaP43MqT5bwajSNxOWmT4nRLWhztapU7n0HTSko0JNvTZSI7Dr4akl8nSpjSGYGLzNSp0VrzJtatvMYOFHVO9jiqXuXK-MOKzIwK5YW3XHNMfps6G23rQvmYglSUTgFtcjzrH-FhfB8rkrnx7ym_Aata9PwLfL9-svJjfZzG0PF8jOEBQeFpo3FnXCMb9mThmJ836P2aTPNAizkM4McKfcuSbCQxow4PV5RnKeUzhru1wsgpwNPAOtsvj42dNZXZxpnjQGGAOBTThp7UJQbAYuUnyz6e0wX7VFAkTJbj9CTshyZSNeT3FbNz-TrDjrhm7e1jEaxVYDd_rO5P4j-cbkbePW6iV1zqurymrk1J52iKbuw81Zh6Omws6Asw5KIdszDMouTqnK58siR-DeQ-fjkzGs3AukhVvVe0CkCILoxGBvcf5NhgcHj2Tya4ZPbSHPC-TqTZIcR_L7Y1XHkUylXYJym7BKM__tYHhWKBz6VuVNS5rfNHShZ_E0JMDgVvsLDBkDqdLPaMokJHi11ki5uJ4CfJVoEAdY3qUs4RZLwCixtBFwujCnic4A6N6XUfA5sekyd-cmTpHSF6a_4ueO8EiEW7MuihVCEvekUdKHd_oeR1UMP5hcZYBPZ6BKR5UXg6cPx_KvPdTSeCKvLfG4a_ax9TKjyc3HdOoDPcHmFqyrPHYCbJCBoUXPAwNy35UUgIWRoun86nHI_TYdvkbX-4mVyJSTP-UiLuMY9kUrxpjBcDYx4du4qMysXftqCrd3lFqnnxarjV3-akac03ViCyX-HYxkTTaxeso8AgSPXWo3i5qzGhnCTyEu3qXSBsSRTwoHQfa3k1lmHPG4gN3SoSj980OwAkMjSc4_uXes6F2wQshm78rlUDhaq7CVDzbFDbQoTdFiF0_O0cdsAlUpZYq8h6-GeccVEDCzyOnkzKKlcbUKBefn5TyT5cTZpq6Wm7XIKaq4J3ieKi08TcYrcTJyS1kBn6EzfqgL3CQGTF2s_iIAK7kdzZvlrY-gAAv_c0kAePM.QyzhA8fb1g3wekfl8TbqYw&quot;}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.21">
      <div class="step-ref passed">21</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment">#Get the idToken for the user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.24">
      <div class="step-ref passed">24</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def tokenid = response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.16.0.call">
    <div class="step-container" id="0.16.0.call.0.25">
      <div class="step-ref passed">25</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print tokenid</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.16.0.call.0.25">15:58:01.636 [print] eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw 
</div>   

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.17">
      <div class="step-ref passed">17</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print signIn.response</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.17">15:58:01.640 [print] {
  &quot;expiresIn&quot;: &quot;3600&quot;,
  &quot;idToken&quot;: &quot;eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw&quot;,
  &quot;accessToken&quot;: &quot;eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjEyNTk4ODEsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTI2MzQ4MSwiaWF0IjoxNjIxMjU5ODgyLCJqdGkiOiI0OWQzZGE2YS0wZjQ1LTRhMTctYWQ3ZC1lZjRlMzYyYzY1OWIiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIn0.MVZWmX1wwxZX4X2r63Om5FBMoDgfw8hv-EXGgmI-Rhvp5DRRJkne1cCYTujavymD62dN8-lROZjqxIhKxtx57bOU560kaAeyq4NBNEh9NOIdWLiB5RHGdoqoDGSwbAKJnQqB2piFDAqoThtEVEIOHkmKFSYYliXyQBWXrtHkDETPwb-i7-upwPCa98q7euTbBYM-mXgP1yGF7zGqAGgFyw7LGNkGOGKQU_kspEsDbnmEtlAMH_LJ3v8_JjRd_tBOJYrmHERTH1IWG1o9jiTKBsuc225MWu6aIB-1H9K7U7QwN5tA-Bcy6pX7M-RnHVmVPWkl30YvyziYkrYUtQt9HQ&quot;,
  &quot;tokenType&quot;: &quot;Bearer&quot;,
  &quot;refreshToken&quot;: &quot;eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.cEIO8gPpGDudi4GhhmY2UGJ3KJOvUCBqqG5SmudulUfLr8iedG38eOMnqgfYOupYexpAiOGi2P_ygsrV_4Ji37eZiuKGIo19iqT1ztD13PPdWEf7eXdyKtwL4d19fPHiLtcGIV6LKdNCRUoB1Cy-6QVlW7fQ9HwmA09EAZXCQGhQWVW3TozOjLmIxIIj9-UkOlDmNROFOf7GyJikllVv01Q8S0ewdBjN53vKjpGXVgR_IaSdne0yj8-jalQxsbltT6P94Vtg11TkYC_2B6De5VvXFChVPx0xxH0KrI9sJhCJ5528-kPLV0as-W0JXePG0DG7ybEWglk5oM6CzU8lyQ.9eZ1y5HCu8EwO6vg.vv5JQHsgc1La1hI4iQo5yq9epOYhAaWHziLJ8fXh5wcRoDjxBqi8mgTD54idxn7kdHKjULnYInRkJ7SEQKrRem9zIhLjbf9FgBP-TsWKW7c9wHNrE9dPcU9Byejfo6M7IjKNSy0btQkPGhaW3BcBwWhe650sQZLUWq58fTIchjZkjdCrGr5Oo-QrzQb3ih-Peni4hRkB6FF00ILj4M1BBakMp30unnkzOxyhV7QQqq62pagGCrn9Lw2pj1N7FHPrPEajQxQHHrjMM6ppGAa672mL9X_rPPJbpZ6X_rzIbfjPkoMlldNGPKhaP43MqT5bwajSNxOWmT4nRLWhztapU7n0HTSko0JNvTZSI7Dr4akl8nSpjSGYGLzNSp0VrzJtatvMYOFHVO9jiqXuXK-MOKzIwK5YW3XHNMfps6G23rQvmYglSUTgFtcjzrH-FhfB8rkrnx7ym_Aata9PwLfL9-svJjfZzG0PF8jOEBQeFpo3FnXCMb9mThmJ836P2aTPNAizkM4McKfcuSbCQxow4PV5RnKeUzhru1wsgpwNPAOtsvj42dNZXZxpnjQGGAOBTThp7UJQbAYuUnyz6e0wX7VFAkTJbj9CTshyZSNeT3FbNz-TrDjrhm7e1jEaxVYDd_rO5P4j-cbkbePW6iV1zqurymrk1J52iKbuw81Zh6Omws6Asw5KIdszDMouTqnK58siR-DeQ-fjkzGs3AukhVvVe0CkCILoxGBvcf5NhgcHj2Tya4ZPbSHPC-TqTZIcR_L7Y1XHkUylXYJym7BKM__tYHhWKBz6VuVNS5rfNHShZ_E0JMDgVvsLDBkDqdLPaMokJHi11ki5uJ4CfJVoEAdY3qUs4RZLwCixtBFwujCnic4A6N6XUfA5sekyd-cmTpHSF6a_4ueO8EiEW7MuihVCEvekUdKHd_oeR1UMP5hcZYBPZ6BKR5UXg6cPx_KvPdTSeCKvLfG4a_ax9TKjyc3HdOoDPcHmFqyrPHYCbJCBoUXPAwNy35UUgIWRoun86nHI_TYdvkbX-4mVyJSTP-UiLuMY9kUrxpjBcDYx4du4qMysXftqCrd3lFqnnxarjV3-akac03ViCyX-HYxkTTaxeso8AgSPXWo3i5qzGhnCTyEu3qXSBsSRTwoHQfa3k1lmHPG4gN3SoSj980OwAkMjSc4_uXes6F2wQshm78rlUDhaq7CVDzbFDbQoTdFiF0_O0cdsAlUpZYq8h6-GeccVEDCzyOnkzKKlcbUKBefn5TyT5cTZpq6Wm7XIKaq4J3ieKi08TcYrcTJyS1kBn6EzfqgL3CQGTF2s_iIAK7kdzZvlrY-gAAv_c0kAePM.QyzhA8fb1g3wekfl8TbqYw&quot;
}
 
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#### Create the Authorization header</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.20">
      <div class="step-ref passed">20</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def idToken = signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.21">
      <div class="step-ref passed">21</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def user_header = &quot;Bearer &quot; + idToken</span>
      </div>
    </div>
    <div class="time-cell passed">5</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#### An user can create a new customer</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.25">
      <div class="step-ref passed">25</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.25">read(&#39;SaveCustomer.graphql&#39;)</div>

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># JSON file with the new user&#39;s datas</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># In this case, the photoUrl field isn&#39;t filled</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.31">
      <div class="step-ref passed">31</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def new_customerNoPhoto = read(&#39;NewCustomerNoPhoto.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.33">
      <div class="step-ref passed">33</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.34">
      <div class="step-ref passed">34</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.35">
      <div class="step-ref passed">35</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39;,  variables: &#39;#(new_customerNoPhoto)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.36">
      <div class="step-ref passed">36</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">233</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.36">15:58:01.654 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 284
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;photo&quot;:&quot;&quot;,&quot;id&quot;:&quot;20000000nophoto&quot;},&quot;query&quot;:&quot;mutation SaveCustomer($id: ID, $name: String, $surname: String, $photo: String) {\r\n    SaveCustomer(input: {id: $id, name: $name, surname: $surname, photo: $photo})\r\n} &quot;}

15:58:01.884 response time in milliseconds: 229
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 30
1 &lt; Connection: keep-alive
1 &lt; Date: Mon, 17 May 2021 13:58:02 GMT
1 &lt; x-amzn-RequestId: 0a1f1726-4ac3-458e-ba3e-fdf5cf6a2d41
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fedwnEdJjoEFf6A=
1 &lt; X-Amzn-Trace-Id: Root=1-60a2766a-12f92b304138fd651647f4b3;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 4ddf42f206fdf10afe67b89baac28c46.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD51-C2
1 &lt; X-Amz-Cf-Id: KnPc95iV9frGU1Fz7IqXoVNqfkQdF6yBFEtUxieqA6zOg_TPB5FVlg==
{&quot;data&quot;:{&quot;SaveCustomer&quot;:true}}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.37">
      <div class="step-ref passed">37</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Introduce a pause so the user can be saved before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.39">
      <div class="step-ref passed">39</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4027</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.41">
      <div class="step-ref passed">41</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># If the customer is saved, the response shouldn&#39;t contain a field &quot;error&quot;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.43">
      <div class="step-ref passed">43</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">5</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># This time, the photoUrl is filled</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.46">
      <div class="step-ref passed">46</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def new_customerPhoto = read(&#39;NewCustomerPhoto.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.48">
      <div class="step-ref passed">48</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.49">
      <div class="step-ref passed">49</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.50">
      <div class="step-ref passed">50</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39;,  variables: &#39;#(new_customerPhoto)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.51">
      <div class="step-ref passed">51</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">192</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.51">15:58:05.924 request:
2 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
2 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw
2 &gt; Content-Type: application/json; charset=UTF-8
2 &gt; Content-Length: 290
2 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
2 &gt; Connection: Keep-Alive
2 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
2 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;photo&quot;:&quot;photo.jpg&quot;,&quot;id&quot;:&quot;2000000photo&quot;},&quot;query&quot;:&quot;mutation SaveCustomer($id: ID, $name: String, $surname: String, $photo: String) {\r\n    SaveCustomer(input: {id: $id, name: $name, surname: $surname, photo: $photo})\r\n} &quot;}

15:58:06.113 response time in milliseconds: 188
2 &lt; 200
2 &lt; Content-Type: application/json
2 &lt; Content-Length: 30
2 &lt; Connection: keep-alive
2 &lt; Date: Mon, 17 May 2021 13:58:06 GMT
2 &lt; x-amzn-RequestId: d2859b22-6bfb-4715-a4f3-0ca482747620
2 &lt; Access-Control-Allow-Origin: *
2 &lt; x-amz-apigw-id: fedxRHHRjoEFqaQ=
2 &lt; X-Amzn-Trace-Id: Root=1-60a2766e-061bd56d4eba82dd4450e42f;Sampled=0
2 &lt; X-Cache: Miss from cloudfront
2 &lt; Via: 1.1 09a2315feedfb8ccf5e3835ff7abd08a.cloudfront.net (CloudFront)
2 &lt; X-Amz-Cf-Pop: MAD51-C2
2 &lt; X-Amz-Cf-Id: PiQTYm45VUtu5E7JuhcVJ4_0hDHbmA6jgiU_sxDjuAvmnYNEXAkl1g==
{&quot;data&quot;:{&quot;SaveCustomer&quot;:true}}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.52">
      <div class="step-ref passed">52</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Introduce a pause so the user can be saved before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.54">
      <div class="step-ref passed">54</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4004</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.56">
      <div class="step-ref passed">56</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># If the customer is saved, the response shouldn&#39;t contain a field &quot;error&quot;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.58">
      <div class="step-ref passed">58</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#### Now, list the customers previously saved by id and check if datas are correct</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.62">
      <div class="step-ref passed">62</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.62">read(&#39;CustomerReadModel.graphql&#39;)</div>

  

  <div class="preformatted" data-parent="0.62">15:58:10.121 over-writing existing variable &#39;query&#39; with new value: read(&#39;CustomerReadModel.graphql&#39;)
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Get the id of the customer previously saved without photo</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.67">
      <div class="step-ref passed">67</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def customer_savedNoPhoto = read(&#39;NewCustomerNoPhoto.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.69">
      <div class="step-ref passed">69</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.70">
      <div class="step-ref passed">70</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.71">
      <div class="step-ref passed">71</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39;, variables: &#39;#(customer_savedNoPhoto)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.72">
      <div class="step-ref passed">72</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">183</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.72">15:58:10.125 request:
3 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
3 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw
3 &gt; Content-Type: application/json; charset=UTF-8
3 &gt; Content-Length: 284
3 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
3 &gt; Connection: Keep-Alive
3 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
3 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;photo&quot;:&quot;&quot;,&quot;id&quot;:&quot;20000000nophoto&quot;},&quot;query&quot;:&quot;query CustomerReadModel($id: ID!) {\r\n    CustomerReadModel(id: $id) {\r\n        id\r\n        name\r\n        surname\r\n        photoUrl\r\n        userId\r\n    }\r\n}&quot;}

15:58:10.306 response time in milliseconds: 180
3 &lt; 200
3 &lt; Content-Type: application/json
3 &lt; Content-Length: 147
3 &lt; Connection: keep-alive
3 &lt; Date: Mon, 17 May 2021 13:58:10 GMT
3 &lt; x-amzn-RequestId: bac3b8a4-daa9-490c-9a36-283fb09bf8af
3 &lt; Access-Control-Allow-Origin: *
3 &lt; x-amz-apigw-id: fedx7EpPDoEFfLw=
3 &lt; X-Amzn-Trace-Id: Root=1-60a27672-4d89a5466a7465ec12ffc98f;Sampled=0
3 &lt; X-Cache: Miss from cloudfront
3 &lt; Via: 1.1 ed24ed7fbec751651346c1accbcfe3e5.cloudfront.net (CloudFront)
3 &lt; X-Amz-Cf-Pop: MAD51-C2
3 &lt; X-Amz-Cf-Id: eTXHpgI9WMQ_kRR1yKHEnv7oudCUNqU6a5Cv-1VMfMnvObCGVHUP8g==
{&quot;data&quot;:{&quot;CustomerReadModel&quot;:{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;id&quot;:&quot;20000000nophoto&quot;,&quot;userId&quot;:&quot;user8@test.com&quot;}}}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.73">
      <div class="step-ref passed">73</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.75">
      <div class="step-ref passed">75</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Check that the datas of the customer are the same as we saved and it has the Id of the user who created it, in this case, the same as it&#39;s signed</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.77">
      <div class="step-ref passed">77</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.data.CustomerReadModel == {id: &#39;#(customer_savedNoPhoto.id)&#39;, name: &#39;#(customer_savedNoPhoto.name)&#39;, surname: &#39;#(customer_savedNoPhoto.surname)&#39;, photoUrl: &#39;#(customer_savedNoPhoto.photo)&#39;, userId: &#39;#(datas.username)&#39; }</span>
      </div>
    </div>
    <div class="time-cell passed">4</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Get the id of the customer previously saved with photo</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.80">
      <div class="step-ref passed">80</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def customer_savedPhoto = read(&#39;NewCustomerPhoto.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.82">
      <div class="step-ref passed">82</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.83">
      <div class="step-ref passed">83</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.84">
      <div class="step-ref passed">84</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39;, variables: &#39;#(customer_savedPhoto)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.85">
      <div class="step-ref passed">85</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">234</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.85">15:58:10.315 request:
4 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
4 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw
4 &gt; Content-Type: application/json; charset=UTF-8
4 &gt; Content-Length: 290
4 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
4 &gt; Connection: Keep-Alive
4 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
4 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;photo&quot;:&quot;photo.jpg&quot;,&quot;id&quot;:&quot;2000000photo&quot;},&quot;query&quot;:&quot;query CustomerReadModel($id: ID!) {\r\n    CustomerReadModel(id: $id) {\r\n        id\r\n        name\r\n        surname\r\n        photoUrl\r\n        userId\r\n    }\r\n}&quot;}

15:58:10.547 response time in milliseconds: 232
4 &lt; 200
4 &lt; Content-Type: application/json
4 &lt; Content-Length: 144
4 &lt; Connection: keep-alive
4 &lt; Date: Mon, 17 May 2021 13:58:10 GMT
4 &lt; x-amzn-RequestId: 656991ab-f910-41e2-a3e5-5c092dcbe82a
4 &lt; Access-Control-Allow-Origin: *
4 &lt; x-amz-apigw-id: fedx-FDMDoEFYnw=
4 &lt; X-Amzn-Trace-Id: Root=1-60a27672-3bfbd6537b964b7c085c9ec7;Sampled=0
4 &lt; X-Cache: Miss from cloudfront
4 &lt; Via: 1.1 71a0472adc0e71a3b21b29ba3bec35f2.cloudfront.net (CloudFront)
4 &lt; X-Amz-Cf-Pop: MAD51-C2
4 &lt; X-Amz-Cf-Id: GfDI7BCqW7FFBHzDlonNUfdynbS5Xxq0UtrywNJgb4aMiZBCQ-41pw==
{&quot;data&quot;:{&quot;CustomerReadModel&quot;:{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;id&quot;:&quot;2000000photo&quot;,&quot;userId&quot;:&quot;user8@test.com&quot;}}}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.86">
      <div class="step-ref passed">86</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.88">
      <div class="step-ref passed">88</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Check that the datas of the customer are the same as we saved and it has the Id of the user who created it, in this case, the same as it&#39;s signed</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">####  * match response.data.CustomerReadModel == {id: &#39;#(customer_savedPhoto.id)&#39;, name: &#39;#(customer_savedPhoto.name)&#39;, surname: &#39;#(customer_savedPhoto.surname)&#39;, photoUrl: &#39;#(customer_savedPhoto.photo)&#39;, userId: &#39;#(datas.username)&#39; }</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#### Users can list all the customers</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.94">
      <div class="step-ref passed">94</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.94">read(&#39;CustomerReadModels.graphql&#39;)</div>

  

  <div class="preformatted" data-parent="0.94">15:58:10.549 over-writing existing variable &#39;query&#39; with new value: read(&#39;CustomerReadModels.graphql&#39;)
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.99">
      <div class="step-ref passed">99</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.100">
      <div class="step-ref passed">100</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.101">
      <div class="step-ref passed">101</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.102">
      <div class="step-ref passed">102</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">157</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.102">15:58:10.553 request:
5 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
5 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw
5 &gt; Content-Type: application/json; charset=UTF-8
5 &gt; Content-Length: 167
5 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
5 &gt; Connection: Keep-Alive
5 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
5 &gt; Accept-Encoding: gzip,deflate
{&quot;query&quot;:&quot;query CustomerReadModels {\r\n    CustomerReadModels {\r\n        id\r\n        name\r\n        surname\r\n        photoUrl\r\n        userId\r\n    }\r\n}&quot;}

15:58:10.707 response time in milliseconds: 153
5 &lt; 200
5 &lt; Content-Type: application/json
5 &lt; Content-Length: 960
5 &lt; Connection: keep-alive
5 &lt; Date: Mon, 17 May 2021 13:58:11 GMT
5 &lt; x-amzn-RequestId: 3694180b-225a-4b28-afd1-c2b1152c195e
5 &lt; Access-Control-Allow-Origin: *
5 &lt; x-amz-apigw-id: fedx_EYxjoEFYrg=
5 &lt; X-Amzn-Trace-Id: Root=1-60a27673-2aeba5de5669313f586c3173;Sampled=0
5 &lt; X-Cache: Miss from cloudfront
5 &lt; Via: 1.1 552a19732149a49fbfc2659a98c93d87.cloudfront.net (CloudFront)
5 &lt; X-Amz-Cf-Pop: MAD51-C2
5 &lt; X-Amz-Cf-Id: qB5hpHD_On4QcSTsdJ1BlaqM93Q53Zxu4Ln87wlxkK9EHdkrLnq9ag==
{&quot;data&quot;:{&quot;CustomerReadModels&quot;:[{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;id&quot;:&quot;2000000011a&quot;,&quot;userId&quot;:&quot;user8@test.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer2 Surname&quot;,&quot;name&quot;:&quot;Customer2&quot;,&quot;id&quot;:&quot;2&quot;,&quot;userId&quot;:&quot;admin@theagilemonkeys.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;id&quot;:&quot;20000000aa&quot;,&quot;userId&quot;:&quot;admin@theagilemonkeys.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer4 surname&quot;,&quot;name&quot;:&quot;Customer4 name&quot;,&quot;id&quot;:&quot;20000000bb&quot;,&quot;userId&quot;:&quot;admin@theagilemonkeys.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;id&quot;:&quot;2000000012a&quot;,&quot;userId&quot;:&quot;user8@test.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;id&quot;:&quot;2000000photo&quot;,&quot;userId&quot;:&quot;user8@test.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer3 Surname&quot;,&quot;name&quot;:&quot;Customer3&quot;,&quot;id&quot;:&quot;3&quot;,&quot;userId&quot;:&quot;admin@theagilemonkeys.com&quot;},{&quot;photoUrl&quot;:&quot;&quot;,&quot;surname&quot;:&quot;Customer surname&quot;,&quot;name&quot;:&quot;Customer name&quot;,&quot;id&quot;:&quot;20000000nophoto&quot;,&quot;userId&quot;:&quot;user8@test.com&quot;}]}}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.103">
      <div class="step-ref passed">103</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.105">
      <div class="step-ref passed">105</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Check that the response doesn&#39;t contains a field &quot;error&quot;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.107">
      <div class="step-ref passed">107</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.errors == &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.108">
      <div class="step-ref passed">108</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.data.CustomerReadModels contains {id: &#39;#ignore&#39;, name: &#39;#ignore&#39;, surname: &#39;#ignore&#39;, photoUrl: &#39;#ignore&#39;, userId: &#39;#ignore&#39; }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Save the body of the response</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.110">
      <div class="step-ref passed">110</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def list_customers = response.data.CustomerReadModels</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.111">
      <div class="step-ref passed">111</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print list_customers</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.111">15:58:10.711 [print] [
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer surname&quot;,
    &quot;name&quot;: &quot;Customer name&quot;,
    &quot;id&quot;: &quot;2000000011a&quot;,
    &quot;userId&quot;: &quot;user8@test.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer2 Surname&quot;,
    &quot;name&quot;: &quot;Customer2&quot;,
    &quot;id&quot;: &quot;2&quot;,
    &quot;userId&quot;: &quot;admin@theagilemonkeys.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer surname&quot;,
    &quot;name&quot;: &quot;Customer name&quot;,
    &quot;id&quot;: &quot;20000000aa&quot;,
    &quot;userId&quot;: &quot;admin@theagilemonkeys.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer4 surname&quot;,
    &quot;name&quot;: &quot;Customer4 name&quot;,
    &quot;id&quot;: &quot;20000000bb&quot;,
    &quot;userId&quot;: &quot;admin@theagilemonkeys.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer surname&quot;,
    &quot;name&quot;: &quot;Customer name&quot;,
    &quot;id&quot;: &quot;2000000012a&quot;,
    &quot;userId&quot;: &quot;user8@test.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer surname&quot;,
    &quot;name&quot;: &quot;Customer name&quot;,
    &quot;id&quot;: &quot;2000000photo&quot;,
    &quot;userId&quot;: &quot;user8@test.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer3 Surname&quot;,
    &quot;name&quot;: &quot;Customer3&quot;,
    &quot;id&quot;: &quot;3&quot;,
    &quot;userId&quot;: &quot;admin@theagilemonkeys.com&quot;
  },
  {
    &quot;photoUrl&quot;: &quot;&quot;,
    &quot;surname&quot;: &quot;Customer surname&quot;,
    &quot;name&quot;: &quot;Customer name&quot;,
    &quot;id&quot;: &quot;20000000nophoto&quot;,
    &quot;userId&quot;: &quot;user8@test.com&quot;
  }
]
 
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#### List a customers by Id that doesn&#39;t exist</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.115">
      <div class="step-ref passed">115</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.115">read(&#39;CustomerReadModel.graphql&#39;)</div>

  

  <div class="preformatted" data-parent="0.115">15:58:10.711 over-writing existing variable &#39;query&#39; with new value: read(&#39;CustomerReadModel.graphql&#39;)
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Define the id of a customer to list</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.120">
      <div class="step-ref passed">120</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def customer_no_exist = read(&#39;CustomerReadModelNoExist.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.121">
      <div class="step-ref passed">121</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def id =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.121">{ 
   &quot;id&quot;: &quot;#(customer_no_exist.id)&quot;
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.127">
      <div class="step-ref passed">127</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.128">
      <div class="step-ref passed">128</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.129">
      <div class="step-ref passed">129</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39;, variables: &#39;#(id)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.130">
      <div class="step-ref passed">130</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">196</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.130">15:58:10.716 request:
6 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
6 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjZhYTI3M2EwLTQyMGMtNGI1MC04MmZiLWE4ZTJmYzE4ZjFlNSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMjU5ODgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjYzNDgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjEyNTk4ODIsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.utMbxvOpyFoEd7dpafD46R5tfet9XT61a7Wuey2jTXPa3H6CyGw0pJk53936GuTVkOyRmQaEXuEIFXF00lzzy7Vu1dpz-zxs7dUoFZY-lCVt4KmjjpOD70ZxlhUZ4_L_Dj7kFeTpzRt36qb_HvQXraQLLrl0pMRAKWOkibRqvELOK3U25WEKCYBuk7JutbCvczP0oKvh0XAO90anR5eVeKeHR3BKr4ldTYkskGIbeSCxnubpPa4KeLys2NqIVSKsM1AfE5T5raaomvz1yLI2zZS3lpDeARBVIxsGELJm1DbXiciF1VqBJ8XC9HLaGsMdVOMSlsfPpO5S56LUyqgrVw
6 &gt; Content-Type: application/json; charset=UTF-8
6 &gt; Content-Length: 219
6 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
6 &gt; Connection: Keep-Alive
6 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
6 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;id&quot;:&quot;20aassadfasfd&quot;},&quot;query&quot;:&quot;query CustomerReadModel($id: ID!) {\r\n    CustomerReadModel(id: $id) {\r\n        id\r\n        name\r\n        surname\r\n        photoUrl\r\n        userId\r\n    }\r\n}&quot;}

15:58:10.910 response time in milliseconds: 194
6 &lt; 200
6 &lt; Content-Type: application/json
6 &lt; Content-Length: 35
6 &lt; Connection: keep-alive
6 &lt; Date: Mon, 17 May 2021 13:58:11 GMT
6 &lt; x-amzn-RequestId: f704eda7-26cc-4ec7-a957-29cca89cd03d
6 &lt; Access-Control-Allow-Origin: *
6 &lt; x-amz-apigw-id: fedyBEOkDoEFXeQ=
6 &lt; X-Amzn-Trace-Id: Root=1-60a27673-0705cf02286be7300f84dd6e;Sampled=0
6 &lt; X-Cache: Miss from cloudfront
6 &lt; Via: 1.1 c1f1733266ff22358c2c3dd7a5454d9d.cloudfront.net (CloudFront)
6 &lt; X-Amz-Cf-Pop: MAD51-C2
6 &lt; X-Amz-Cf-Id: t1WX2yBLzqXmUgaRwcvFabpxXOkJeW1vrM5f9lbz3WY1BURoq_HM0A==
{&quot;data&quot;:{&quot;CustomerReadModel&quot;:null}}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.131">
      <div class="step-ref passed">131</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.133">
      <div class="step-ref passed">133</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Check that the response contains an error</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.135">
      <div class="step-ref passed">135</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.data.CustomerReadModel != {id: &#39;#(customer_no_exist.id)&#39;, name: &#39;#ignore&#39;, surname: &#39;#ignore&#39;, photoUrl: &#39;&#39;, userId: &#39;#ignore&#39; }</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#### Users can update a customer</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Get a customer to update from the list of customer &#39;list_customers&#39;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.141">
      <div class="step-ref passed">141</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def fun = function(json){ return(json[0]) }</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.142">
      <div class="step-ref passed">142</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def customer_inList = call fun list_customers</span>
      </div>
    </div>
    <div class="time-cell passed">3</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.143">
      <div class="step-ref passed">143</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print fun</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.143">15:58:10.918 [print] function(json){ return(json[0]) } 
</div>   

  

</div>
</div>
        </div>
      </div>
    </div>
  </body>
</html>

