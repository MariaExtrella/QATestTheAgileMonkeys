{"failedCount":5,"prefixedPath":"classpath:examples\/users\/TestUserNoAdminCannotDo2.feature","packageQualifiedName":"examples.users.TestUserNoAdminCannotDo2","loopIndex":-1,"relativePath":"examples\/users\/TestUserNoAdminCannotDo2.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":1193100,"millis":1.1931,"status":"passed"},"step":{"comments":["# Define a function to introduce a sleep in the test"],"background":true,"line":6,"prefix":"*","index":0,"text":"def wait = function(pause){ java.lang.Thread.sleep(pause) }"},"stepLog":"10:20:25.648 karate.env system property was: prod \n"},{"result":{"nanos":29700,"millis":0.0297,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":1,"text":"url httpUrl"}},{"result":{"nanos":28534100,"millis":28.5341,"status":"passed"},"step":{"comments":["# The user to test this feature is read from a json file"],"background":true,"line":11,"prefix":"*","index":2,"text":"def jsonUserTest = read('UserTest.json')"}},{"result":{"nanos":1204600,"millis":1.2046,"status":"passed"},"step":{"endLine":19,"line":16,"prefix":"*","docString":"read('UserReadModels.graphql')","index":0,"text":"def queryUserReadModels ="}},{"result":{"nanos":3960800,"millis":3.9608,"status":"passed"},"step":{"line":20,"prefix":"Given","index":1,"text":"path 'graphql'"}},{"result":{"nanos":9523400,"errorMessage":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:21","millis":9.5234,"status":"failed"},"step":{"line":21,"prefix":"And","index":2,"text":"header Authorization = newToken.tokenType + ' ' + newToken.idToken"},"stepLog":"10:20:25.714 classpath:examples\/users\/TestUserNoAdminCannotDo2.feature:21\nAnd header Authorization = newToken.tokenType + ' ' + newToken.idToken\n>>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:21\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":22,"prefix":"And","index":3,"text":"header Content-Type = 'application\/json'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":23,"prefix":"And","index":4,"text":"request { query: '#(queryUserReadModels)' }"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":24,"prefix":"When","index":5,"text":"method post"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":25,"prefix":"Then","index":6,"text":"status 200"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":28,"prefix":"*","index":7,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# As the user is not admin, the response contains a field \"error\" and it is printed"],"line":30,"prefix":"*","index":8,"text":"match response.errors != '#notpresent'"}}],"line":14,"description":"","durationMillis":44.4457,"failed":true,"error":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:21","executorName":"main","name":"List all the users. Only an admin user can, so the test shouldn't retrun datas","startTime":1621326025538,"refId":"[1:14]","endTime":1621326025714,"exampleIndex":-1},{"sectionIndex":1,"stepResults":[{"result":{"nanos":253700,"millis":0.2537,"status":"passed"},"step":{"comments":["# Define a function to introduce a sleep in the test"],"background":true,"line":6,"prefix":"*","index":0,"text":"def wait = function(pause){ java.lang.Thread.sleep(pause) }"},"stepLog":"10:20:25.728 karate.env system property was: prod \n"},{"result":{"nanos":6900,"millis":0.0069,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":1,"text":"url httpUrl"}},{"result":{"nanos":557000,"millis":0.557,"status":"passed"},"step":{"comments":["# The user to test this feature is read from a json file"],"background":true,"line":11,"prefix":"*","index":2,"text":"def jsonUserTest = read('UserTest.json')"}},{"result":{"nanos":888900,"millis":0.8889,"status":"passed"},"step":{"endLine":37,"line":34,"prefix":"*","docString":"read('SaveUser.graphql')","index":0,"text":"def query ="}},{"result":{"nanos":343100,"millis":0.3431,"status":"passed"},"step":{"line":39,"prefix":"Given","index":1,"text":"path 'graphql'"}},{"result":{"nanos":1275300,"errorMessage":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:40","millis":1.2753,"status":"failed"},"step":{"line":40,"prefix":"And","index":2,"text":"header Authorization = newToken.tokenType + ' ' + newToken.idToken"},"stepLog":"10:20:25.733 classpath:examples\/users\/TestUserNoAdminCannotDo2.feature:40\nAnd header Authorization = newToken.tokenType + ' ' + newToken.idToken\n>>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:40\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":41,"prefix":"And","index":3,"text":"request { query: '#(query)',  variables: '#(jsonUserTest)'}"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":42,"prefix":"When","index":4,"text":"method post"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":43,"prefix":"Then","index":5,"text":"status 200"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# Introduce a pause so the user can be saved before the next test"],"line":45,"prefix":"*","index":6,"text":"wait(4000)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":48,"prefix":"*","index":7,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# As the user is not admin, the response must contains a field \"error\""],"line":50,"prefix":"*","index":8,"text":"match response.errors != '#notpresent'"}}],"line":33,"description":"","durationMillis":3.3249,"failed":true,"error":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:40","executorName":"main","name":"The user not admin can't create a new user","startTime":1621326025727,"refId":"[2:33]","endTime":1621326025733,"exampleIndex":-1},{"sectionIndex":2,"stepResults":[{"result":{"nanos":280000,"millis":0.28,"status":"passed"},"step":{"comments":["# Define a function to introduce a sleep in the test"],"background":true,"line":6,"prefix":"*","index":0,"text":"def wait = function(pause){ java.lang.Thread.sleep(pause) }"},"stepLog":"10:20:25.740 karate.env system property was: prod \n"},{"result":{"nanos":10400,"millis":0.0104,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":1,"text":"url httpUrl"}},{"result":{"nanos":694900,"millis":0.6949,"status":"passed"},"step":{"comments":["# The user to test this feature is read from a json file"],"background":true,"line":11,"prefix":"*","index":2,"text":"def jsonUserTest = read('UserTest.json')"}},{"result":{"nanos":1113700,"millis":1.1137,"status":"passed"},"step":{"endLine":58,"comments":["# Get the query from a .graphql file"],"line":55,"prefix":"*","docString":"read('UserReadModel.graphql')","index":0,"text":"def query ="}},{"result":{"nanos":1465000,"millis":1.465,"status":"passed"},"step":{"endLine":65,"comments":["# Define the username of the user to list"],"line":60,"prefix":"*","docString":"{ \n   \"id\": \"#(jsonUserTest.username)\"\n}","index":1,"text":"def id ="}},{"result":{"nanos":4210600,"millis":4.2106,"status":"passed"},"step":{"line":66,"prefix":"*","index":2,"text":"print id"},"stepLog":"10:20:25.749 [print] {\n  \"id\": \"user35@test.com\"\n}\n \n"},{"result":{"nanos":253600,"millis":0.2536,"status":"passed"},"step":{"line":68,"prefix":"Given","index":3,"text":"path 'graphql'"}},{"result":{"nanos":822600,"errorMessage":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:69","millis":0.8226,"status":"failed"},"step":{"line":69,"prefix":"And","index":4,"text":"header Authorization = newToken.tokenType + ' ' + newToken.idToken"},"stepLog":"10:20:25.751 classpath:examples\/users\/TestUserNoAdminCannotDo2.feature:69\nAnd header Authorization = newToken.tokenType + ' ' + newToken.idToken\n>>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:69\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":70,"prefix":"And","index":5,"text":"header Content-Type = 'application\/json'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":71,"prefix":"And","index":6,"text":"request { query: '#(query)', variables: '#(id)' }"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":72,"prefix":"When","index":7,"text":"method post"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":73,"prefix":"Then","index":8,"text":"status 200"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# As the user is not admin, the response of the query shouldn't contain the datas of the user tryed to saved"],"line":76,"prefix":"*","index":9,"text":"match response.data.UserReadModel != {id: '#(jsonUserTest.username)', role: '#(jsonUserTest.role)' }"}}],"line":53,"description":"","durationMillis":8.8508,"failed":true,"error":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:69","executorName":"main","name":"The user can't list a user by id","startTime":1621326025739,"refId":"[3:53]","endTime":1621326025751,"exampleIndex":-1},{"sectionIndex":3,"stepResults":[{"result":{"nanos":353300,"millis":0.3533,"status":"passed"},"step":{"comments":["# Define a function to introduce a sleep in the test"],"background":true,"line":6,"prefix":"*","index":0,"text":"def wait = function(pause){ java.lang.Thread.sleep(pause) }"},"stepLog":"10:20:25.756 karate.env system property was: prod \n"},{"result":{"nanos":17700,"millis":0.0177,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":1,"text":"url httpUrl"}},{"result":{"nanos":658300,"millis":0.6583,"status":"passed"},"step":{"comments":["# The user to test this feature is read from a json file"],"background":true,"line":11,"prefix":"*","index":2,"text":"def jsonUserTest = read('UserTest.json')"}},{"result":{"nanos":1187600,"millis":1.1876,"status":"passed"},"step":{"endLine":83,"line":80,"prefix":"*","docString":"read('ChangeUserRole.graphql')","index":0,"text":"def query ="}},{"result":{"nanos":1619200,"millis":1.6192,"status":"passed"},"step":{"line":84,"prefix":"*","index":1,"text":"set jsonUserTest.role = \"changed role\""}},{"result":{"nanos":347800,"millis":0.3478,"status":"passed"},"step":{"line":86,"prefix":"Given","index":2,"text":"path 'graphql'"}},{"result":{"nanos":840400,"errorMessage":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:87","millis":0.8404,"status":"failed"},"step":{"line":87,"prefix":"And","index":3,"text":"header Authorization = newToken.tokenType + ' ' + newToken.idToken"},"stepLog":"10:20:25.763 classpath:examples\/users\/TestUserNoAdminCannotDo2.feature:87\nAnd header Authorization = newToken.tokenType + ' ' + newToken.idToken\n>>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:87\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":88,"prefix":"And","index":4,"text":"request { query: '#(query)',  variables: '#(jsonUserTest)'}"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":89,"prefix":"When","index":5,"text":"method post"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":90,"prefix":"Then","index":6,"text":"status 200"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# Introduce a pause so the user can be saved before the next test"],"line":92,"prefix":"*","index":7,"text":"wait(4000)"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# if the response status is not 200, the test finish"],"line":95,"prefix":"*","index":8,"text":"if (responseStatus != 200) karate.abort()"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# As the user is not admin, the response must contain a field \"error\""],"line":97,"prefix":"*","index":9,"text":"match response.errors != '#notpresent'"}}],"line":79,"description":"","durationMillis":5.0243,"failed":true,"error":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:87","executorName":"main","name":"An user no admin can't change the role of other user","startTime":1621326025756,"refId":"[4:79]","endTime":1621326025763,"exampleIndex":-1},{"sectionIndex":4,"stepResults":[{"result":{"nanos":329100,"millis":0.3291,"status":"passed"},"step":{"comments":["# Define a function to introduce a sleep in the test"],"background":true,"line":6,"prefix":"*","index":0,"text":"def wait = function(pause){ java.lang.Thread.sleep(pause) }"},"stepLog":"10:20:25.771 karate.env system property was: prod \n"},{"result":{"nanos":13700,"millis":0.0137,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":1,"text":"url httpUrl"}},{"result":{"nanos":698100,"millis":0.6981,"status":"passed"},"step":{"comments":["# The user to test this feature is read from a json file"],"background":true,"line":11,"prefix":"*","index":2,"text":"def jsonUserTest = read('UserTest.json')"}},{"result":{"nanos":1167200,"millis":1.1672,"status":"passed"},"step":{"endLine":105,"comments":["# Get the query from a .graphql file"],"line":102,"prefix":"*","docString":"read('DeleteUser.graphql')","index":0,"text":"def query ="}},{"result":{"nanos":462600,"millis":0.4626,"status":"passed"},"step":{"endLine":112,"comments":["# Define the username of the user to delete"],"line":107,"prefix":"*","docString":"{ \n   \"id\": \"#(jsonUserTest.username)\"\n}","index":1,"text":"def id ="}},{"result":{"nanos":616300,"millis":0.6163,"status":"passed"},"step":{"line":113,"prefix":"*","index":2,"text":"print id"},"stepLog":"10:20:25.776 [print] {\n  \"id\": \"user35@test.com\"\n}\n \n"},{"result":{"nanos":241900,"millis":0.2419,"status":"passed"},"step":{"line":115,"prefix":"Given","index":3,"text":"path 'graphql'"}},{"result":{"nanos":951500,"errorMessage":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:116","millis":0.9515,"status":"failed"},"step":{"line":116,"prefix":"And","index":4,"text":"header Authorization = newToken.tokenType + ' ' + newToken.idToken"},"stepLog":"10:20:25.778 classpath:examples\/users\/TestUserNoAdminCannotDo2.feature:116\nAnd header Authorization = newToken.tokenType + ' ' + newToken.idToken\n>>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:116\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":117,"prefix":"And","index":5,"text":"header Content-Type = 'application\/json'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":118,"prefix":"And","index":6,"text":"request { query: '#(query)', variables: '#(id)' }"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":119,"prefix":"When","index":7,"text":"method post"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":120,"prefix":"Then","index":8,"text":"status 200"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"comments":["# As the user is not admin, the response of the query shouldn't contain the datas of the user tryed to saved"],"line":123,"prefix":"*","index":9,"text":"match response.errors != '#notpresent'"}}],"line":100,"description":"","durationMillis":4.4804,"failed":true,"error":">>>> js failed:\n01: newToken.tokenType + ' ' + newToken.idToken\n<<<<\norg.graalvm.polyglot.PolyglotException: ReferenceError: \"newToken\" is not defined\n- <js>.:program(Unnamed:1)\n\nclasspath:examples\/users\/TestUserNoAdminCannotDo2.feature:116","executorName":"main","name":"The user can't delete other users","startTime":1621326025771,"refId":"[5:100]","endTime":1621326025778,"exampleIndex":-1}],"callDepth":0,"name":"Test that an user not admin isn't allowed to do admin functions in the environment set from the java class","description":"","resultDate":"2021-05-18 10:20:25 a.Â m.","durationMillis":66.1261,"passedCount":0}