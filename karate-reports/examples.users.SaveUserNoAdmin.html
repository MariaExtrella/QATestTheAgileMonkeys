<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="res/bootstrap.min.css" type="text/css"/>
    <link rel="stylesheet" href="res/karate-report.css" type="text/css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <script type="text/javascript" src="res/jquery.min.js"></script>
    <script type="text/javascript" src="res/jquery.tablesorter.min.js"></script>
    <script type="text/javascript" src="res/bootstrap.min.js"></script>
    <script type="text/javascript" src="res/karate-report.js"></script>
    <title>examples.users.SaveUserNoAdmin</title>  
  </head>
  <body>   
    <div id="root-container">
      <div id="leftnav">
                
        <div>
  <div class="nav-logo">
    <a href="karate-summary.html">
      <img src="karate-logo.svg" alt="Karate"/>
    </a>
    <div class="nav-count">
      <div id="nav-pass" class="bg-success">1</div>
      <div id="nav-fail" class="bg-danger">0</div>
    </div>
  </div>
  <div id="nav-type">
    <div>Scenarios</div>
  </div>         
  <div id="nav-date">
    <div>2021-05-16 10:24:45 p.Â m.</div>
  </div>        
</div>

        <div class="nav-container">
          <div class="nav-item passed">
            <a href="#[1:22]"><span>[1:22]</span> <span>List all the users. Only an admin user can, so the test shouldn&#39;t retrun datas</span></a>
          </div>
        </div>
      </div>
      <div id="content">
        <div class="page-heading alert alert-primary">
          <a href="karate-summary.html">Summary</a><span class="feature-label">|</span>
          <a href="karate-tags.html">Tags</a><span class="feature-label">|</span>
          <span class="feature-label">Feature:</span>
          <span class="feature-path">examples/users/SaveUserNoAdmin.feature</span><span class="feature-label">|</span>
          <span class="feature-name">Test the creation of users by an user not admin in the environment set from the java class</span>
          <span class="feature-description"></span>
        </div>
        <div class="scenario">
          <div class="scenario-heading" id="[1:22]">
            <div class="heading-container">
              <div class="scenario-tags">
                
              </div>
              <div class="scenario-keyword">
                Scenario: <span>[1:22]</span>
                <span class="scenario-name">List all the users. Only an admin user can, so the test shouldn&#39;t retrun datas</span>
                <span></span>
              </div>
            </div>
            <div class="scenario-time passed">
              <span>ms:</span>&nbsp;<span>5793</span>
            </div>
          </div>
          <div class="step-row">
            <div class="step-container" id="[1:22]bg">
              <div class="step-ref bg-step">&gt;&gt;</div>
              <div class="step-cell passed">Background:</div>
            </div>
            <div class="time-cell passed"></div>
          </div>
          <div data-parent="[1:22]bg"><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Define a function to introduce a sleep in the test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.6">
      <div class="step-ref bg-step">6</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def wait = function(pause){ java.lang.Thread.sleep(pause) }</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.6">22:24:40.119 karate.env system property was: prod 
</div>   

  

</div>
</div>
          <div data-parent="[1:22]bg"><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.8">
      <div class="step-ref bg-step">8</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div data-parent="[1:22]bg"><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Get the idToken for one of the user created by the admin</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.11">
      <div class="step-ref bg-step">11</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def datas = read(&#39;signinDatasUserNoAdmin.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">35</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div data-parent="[1:22]bg"><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Call the feature to sign in the API with the JSON file that contains the user&#39;s datas</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.14">
      <div class="step-ref bg-step">14</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def signIn = call read(&#39;signin.feature&#39;) datas</span>
      </div>
    </div>
    <div class="time-cell passed">874</div>
  </div>

   
  
  

  

     

  <div>
        
    <div class="step-row">
      <div class="step-container" id="0.14.0.call">
        <div class="step-ref bg-step">&gt;&gt;</div>
        <div class="step-indent"></div>
        <div class="step-cell passed">examples.users.signin</div>
      </div>
      <div class="time-cell passed">848</div>
    </div>
    <div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.4">
      <div class="step-ref bg-step">4</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>url httpUrl</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.7">
      <div class="step-ref bg-step">7</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.14.0.call.0.7">{
  		&quot;clientId&quot;: &quot;#(clientId)&quot;,
        &quot;username&quot;: &quot;#(username)&quot;,
  		&quot;password&quot;: &quot;#(password)&quot;
	}</div>

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.15">
      <div class="step-ref bg-step">15</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print query</span>
      </div>
    </div>
    <div class="time-cell passed">3</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.14.0.call.0.15">22:24:40.211 [print] {
  &quot;clientId&quot;: &quot;799hogucm363v55l7dk2n1l5u0&quot;,
  &quot;username&quot;: &quot;user8@test.com&quot;,
  &quot;password&quot;: &quot;Password_1&quot;
}
 
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.17">
      <div class="step-ref bg-step">17</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;/auth/sign-in&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">5</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.18">
      <div class="step-ref bg-step">18</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request query</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.19">
      <div class="step-ref bg-step">19</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Content-Type = &#39;application/json&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.20">
      <div class="step-ref bg-step">20</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">834</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.14.0.call.0.20">22:24:40.422 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/auth/sign-in
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 93
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;password&quot;:&quot;Password_1&quot;,&quot;clientId&quot;:&quot;799hogucm363v55l7dk2n1l5u0&quot;,&quot;username&quot;:&quot;user8@test.com&quot;}

22:24:41.047 response time in milliseconds: 619
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 3994
1 &lt; Connection: keep-alive
1 &lt; Date: Sun, 16 May 2021 20:24:41 GMT
1 &lt; x-amzn-RequestId: 5b9d2036-f109-4773-b404-e9114be07b2c
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fcDddFONjoEF1Ww=
1 &lt; X-Amzn-Trace-Id: Root=1-60a17f89-7c0ba4e56816bfde7d5f28fd
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 3f18bbc133cf4ddae8afcd8a83c77a98.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD50-C1
1 &lt; X-Amz-Cf-Id: -6VWXjxGSPwSZeMsCveJ331kBPYe4zWMT6e1-R79vqvHRnASN_66Zw==
{&quot;expiresIn&quot;:&quot;3600&quot;,&quot;idToken&quot;:&quot;eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMTk2NjgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjAwMjgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjExOTY2ODEsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.Isfer2EG1B7XtJ8Me5nJKScjRNcm4oIM4WfC4YtR1XweDLXP1Ul9M3xhDtB2GCRQZZFdRbr8qgw-otdiq_a6jFvOlkf0Cszq-4-XrSdRcsBR7D5Wn9VxR3s9ulrkhOYbrMs0YZdEutLDfYFxXyfUfv0grzi_Ck0buXrFFny56QzRe5Rw7sV4ZvTcDffsa_aKZw1YtzV8otfKvRXbMesngp2U7BtJ2_u1AuHEAQpeeeFIZ42DasN9QH3ffTz5b0ogGj49_hhRlZu3D4sM4d6gNY6LqZGOv1Hz6bpE-9xPgdGGxLMJENtsF3MnBi1gCPPVL45J9z8jh5Bo9emZext7LQ&quot;,&quot;accessToken&quot;:&quot;eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjExOTY2ODEsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTIwMDI4MSwiaWF0IjoxNjIxMTk2NjgxLCJqdGkiOiI2MTUwMzZmMi05ZmE1LTRiMDEtYjRhZC0wM2NiMTJiM2VhNzQiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIn0.qiv9qldKm2cuHujvclsEkuFu2SfOYwrX-CGR6JAVEx1Oo_joRwYMv18eavdrehGzgKalWF-C3lbCMJZYI9lmmngU6rVsz0E7DOnGZpHsKXiHAYhgtZMIHQgGiFK68R6Ayi9k_nstWiFsVJoXi6S0FUaagfTdeDGBjKSvP9nIo77a1WPb2BN2BNrWB6IJLiy8RFo_P1f0Lei8RZ00x3oWG1wlLmHnJZtRQ_exA5e76a7cQxku-ACA4gWygCNgd9zLz2gGKEiFKkf0TWELEUTTTKrYYK-vb-Q78qCqppYAFgxB9OVrxyn5JeGqGPcwUGSNAi-njl1JIEoeluNxaSWHvA&quot;,&quot;tokenType&quot;:&quot;Bearer&quot;,&quot;refreshToken&quot;:&quot;eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.Wx-f2NFTysQ5GJO111hyq2U1z2zc4_crOkQMXdO3zTK_LHu0WtAX7ilCECyZ02qf_q1pvl_QoWany5_XA4woNMpt9ZB4Zj2b9gWv0AemMB7wjYDJEyLBiBi2DLsPb2wOrTDMjgX4aN9gEWTwSBuUMSwnCyWu9W0RHP_CedBvTTkvevtA-h8Xrs-LI8upb9NLoVn5qCczI1eX3Giyibq61PRxGMaM-E9ULYZcqUjmX1qCDma6-c7XP6zVZw6EkqTWHHhvaY8mKWruiKtQLpJg_VhGVbBwNhnoKHesfgIQdmfUdD1rePiYboca0uxcpUqzNNiR9naWWMS0TJDEJzHlxA.n9zMkQFHfWrC1hII.izgXkWxgsN2e6jU16kFx2n4Q2YliCekl75f0M61w1MdE2ZV2yWX4jBcAgzSVQIOuyxM7gmZPLt5s_5rrEEns4lPagZMDZh7pbua211dQ4yH9RzitAA2-txcyK9KhQOCVv0vcn2MrPR0PuM3TyuliC66gsutuUTaXJdiOrlyUhpziwgTWWDRF_kemPsRxFXurkLf3jXoy0WaJJ4z1Ds0VhYksUCLHo3mYtU60q6c48s1EC0sx5QOwuz4Knf6ZPnbEB6_IQm89SrsX-pqtBhW-oUShmRG8hdBNSUk1OygpNaMxCddZGkiEa5Hy8DTWneyH0RuVu7i7oIwDSf74mTi8wFnI_svpdc3jY62ldPxTZX3WyDF3UiEpvW5Mx-4p7yhVVHo5eKJ0x2cy0X_rWNowntXvOfgM8C1NjSniP93tevmkNjH3LKtIdeQPBPub5GMvuE7h3vXA7lWmtqwWdVtgoDfSQCpvbVLtK1IHE_9Hgf08RhLZvZ75fiYGyN7t_Qe3HsCO6OJt8BIxDHOv-npPkwooUvxoBNGB7qgVsgtfhyj0Ysy0yuUUIfq3fVzK6NKFploPh8O7f_kUIVJLbPUFPUe5meY8zVqHANm6u_z_Tm9xREHVJNgnjfgo-aO4zE_RkAXbuq_GFiyypQthnt-miaD_J9Qy9-uCaagK-yIJY41KmjugW1SKMjvEy-M6QiNiqffUdDrIQs7lrzz0lkBeEVprEsN-_S_3p2pBJYdOuxAylJbikgzhqASLeLQleZlZlaGUqbuXgDbFak_fn3sAxTKPojUdP4IS3rYYHMNU-GKkuecFPZSnqLm7OUHQ3tpUUshnzjmQ1eQfgf3WW3LsVmR7QVPn0a9ClWIMvvBy5QRVQeYw3xTRzgD8fksubWBE8_-q893Z4QjpLpKez7gK6fPO31aehI_rVa588Cf-6nM2Hw3tp406xaTIFyShz6h2p3MGlzsmF-yUacCSIBw0n6Zn_lANzd6UoyW59sGzmPIFM98mqVnxswPLTNL5CAEdn0vzSEKoCwxRPJmOnxVOIer0Tq2EZR7XVP1QzNertNF_3DxygWwYeka-J0fyS2_RnWL4j9ows641f98KKSbNeN6n7natq-uht8Ay1VAzbTW79ZwkuDDnZFBch0uGYyxgRTZOgISQs95bBjKKAQKc_FpqoLl0TxWVlGGRUqpM0ircx9Z46PBQHCvWNjkVaMNE8cY851iDzBBwmtgOV6DVkbYREvPS2hen5j7XcgujLqXbflMzqgIsrQLSLcjGBNM7cognpNsTbQ1XH2fa9T5DRFnogbJZw5eBudKlL_YlZCpPBP6pl5UFVr9-42cOCFo.dppdPhIXgTd5nvZhJ8zJ6w&quot;}
</div>   

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.21">
      <div class="step-ref bg-step">21</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container">
      <div class="step-ref passed"></div>
      <div class="step-indent"></div>
      <div class="step-cell comment">#Get the idToken for the user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.24">
      <div class="step-ref bg-step">24</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def tokenid = response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
      <div><div>
  

  

  <div class="step-row" data-parent="0.14.0.call">
    <div class="step-container" id="0.14.0.call.0.25">
      <div class="step-ref bg-step">25</div>
      <div class="step-indent"></div>
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print tokenid</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.14.0.call.0.25">22:24:41.054 [print] eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMTk2NjgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjAwMjgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjExOTY2ODEsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.Isfer2EG1B7XtJ8Me5nJKScjRNcm4oIM4WfC4YtR1XweDLXP1Ul9M3xhDtB2GCRQZZFdRbr8qgw-otdiq_a6jFvOlkf0Cszq-4-XrSdRcsBR7D5Wn9VxR3s9ulrkhOYbrMs0YZdEutLDfYFxXyfUfv0grzi_Ck0buXrFFny56QzRe5Rw7sV4ZvTcDffsa_aKZw1YtzV8otfKvRXbMesngp2U7BtJ2_u1AuHEAQpeeeFIZ42DasN9QH3ffTz5b0ogGj49_hhRlZu3D4sM4d6gNY6LqZGOv1Hz6bpE-9xPgdGGxLMJENtsF3MnBi1gCPPVL45J9z8jh5Bo9emZext7LQ 
</div>   

  

</div>
</div>
    </div>    
  </div>

</div>
</div>
          <div data-parent="[1:22]bg"><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.15">
      <div class="step-ref bg-step">15</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print signIn.response</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.15">22:24:41.060 [print] {
  &quot;expiresIn&quot;: &quot;3600&quot;,
  &quot;idToken&quot;: &quot;eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMTk2NjgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjAwMjgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjExOTY2ODEsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.Isfer2EG1B7XtJ8Me5nJKScjRNcm4oIM4WfC4YtR1XweDLXP1Ul9M3xhDtB2GCRQZZFdRbr8qgw-otdiq_a6jFvOlkf0Cszq-4-XrSdRcsBR7D5Wn9VxR3s9ulrkhOYbrMs0YZdEutLDfYFxXyfUfv0grzi_Ck0buXrFFny56QzRe5Rw7sV4ZvTcDffsa_aKZw1YtzV8otfKvRXbMesngp2U7BtJ2_u1AuHEAQpeeeFIZ42DasN9QH3ffTz5b0ogGj49_hhRlZu3D4sM4d6gNY6LqZGOv1Hz6bpE-9xPgdGGxLMJENtsF3MnBi1gCPPVL45J9z8jh5Bo9emZext7LQ&quot;,
  &quot;accessToken&quot;: &quot;eyJraWQiOiJIcWFQSnUyR1YzN1F5TnBnVlIwSXRHRHJqQ3huZk41aEFvK1ZmZGNtNDBVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE2MjExOTY2ODEsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC5ldS13ZXN0LTEuYW1hem9uYXdzLmNvbVwvZXUtd2VzdC0xX21IdWVBcjJRdSIsImV4cCI6MTYyMTIwMDI4MSwiaWF0IjoxNjIxMTk2NjgxLCJqdGkiOiI2MTUwMzZmMi05ZmE1LTRiMDEtYjRhZC0wM2NiMTJiM2VhNzQiLCJjbGllbnRfaWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsInVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIn0.qiv9qldKm2cuHujvclsEkuFu2SfOYwrX-CGR6JAVEx1Oo_joRwYMv18eavdrehGzgKalWF-C3lbCMJZYI9lmmngU6rVsz0E7DOnGZpHsKXiHAYhgtZMIHQgGiFK68R6Ayi9k_nstWiFsVJoXi6S0FUaagfTdeDGBjKSvP9nIo77a1WPb2BN2BNrWB6IJLiy8RFo_P1f0Lei8RZ00x3oWG1wlLmHnJZtRQ_exA5e76a7cQxku-ACA4gWygCNgd9zLz2gGKEiFKkf0TWELEUTTTKrYYK-vb-Q78qCqppYAFgxB9OVrxyn5JeGqGPcwUGSNAi-njl1JIEoeluNxaSWHvA&quot;,
  &quot;tokenType&quot;: &quot;Bearer&quot;,
  &quot;refreshToken&quot;: &quot;eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.Wx-f2NFTysQ5GJO111hyq2U1z2zc4_crOkQMXdO3zTK_LHu0WtAX7ilCECyZ02qf_q1pvl_QoWany5_XA4woNMpt9ZB4Zj2b9gWv0AemMB7wjYDJEyLBiBi2DLsPb2wOrTDMjgX4aN9gEWTwSBuUMSwnCyWu9W0RHP_CedBvTTkvevtA-h8Xrs-LI8upb9NLoVn5qCczI1eX3Giyibq61PRxGMaM-E9ULYZcqUjmX1qCDma6-c7XP6zVZw6EkqTWHHhvaY8mKWruiKtQLpJg_VhGVbBwNhnoKHesfgIQdmfUdD1rePiYboca0uxcpUqzNNiR9naWWMS0TJDEJzHlxA.n9zMkQFHfWrC1hII.izgXkWxgsN2e6jU16kFx2n4Q2YliCekl75f0M61w1MdE2ZV2yWX4jBcAgzSVQIOuyxM7gmZPLt5s_5rrEEns4lPagZMDZh7pbua211dQ4yH9RzitAA2-txcyK9KhQOCVv0vcn2MrPR0PuM3TyuliC66gsutuUTaXJdiOrlyUhpziwgTWWDRF_kemPsRxFXurkLf3jXoy0WaJJ4z1Ds0VhYksUCLHo3mYtU60q6c48s1EC0sx5QOwuz4Knf6ZPnbEB6_IQm89SrsX-pqtBhW-oUShmRG8hdBNSUk1OygpNaMxCddZGkiEa5Hy8DTWneyH0RuVu7i7oIwDSf74mTi8wFnI_svpdc3jY62ldPxTZX3WyDF3UiEpvW5Mx-4p7yhVVHo5eKJ0x2cy0X_rWNowntXvOfgM8C1NjSniP93tevmkNjH3LKtIdeQPBPub5GMvuE7h3vXA7lWmtqwWdVtgoDfSQCpvbVLtK1IHE_9Hgf08RhLZvZ75fiYGyN7t_Qe3HsCO6OJt8BIxDHOv-npPkwooUvxoBNGB7qgVsgtfhyj0Ysy0yuUUIfq3fVzK6NKFploPh8O7f_kUIVJLbPUFPUe5meY8zVqHANm6u_z_Tm9xREHVJNgnjfgo-aO4zE_RkAXbuq_GFiyypQthnt-miaD_J9Qy9-uCaagK-yIJY41KmjugW1SKMjvEy-M6QiNiqffUdDrIQs7lrzz0lkBeEVprEsN-_S_3p2pBJYdOuxAylJbikgzhqASLeLQleZlZlaGUqbuXgDbFak_fn3sAxTKPojUdP4IS3rYYHMNU-GKkuecFPZSnqLm7OUHQ3tpUUshnzjmQ1eQfgf3WW3LsVmR7QVPn0a9ClWIMvvBy5QRVQeYw3xTRzgD8fksubWBE8_-q893Z4QjpLpKez7gK6fPO31aehI_rVa588Cf-6nM2Hw3tp406xaTIFyShz6h2p3MGlzsmF-yUacCSIBw0n6Zn_lANzd6UoyW59sGzmPIFM98mqVnxswPLTNL5CAEdn0vzSEKoCwxRPJmOnxVOIer0Tq2EZR7XVP1QzNertNF_3DxygWwYeka-J0fyS2_RnWL4j9ows641f98KKSbNeN6n7natq-uht8Ay1VAzbTW79ZwkuDDnZFBch0uGYyxgRTZOgISQs95bBjKKAQKc_FpqoLl0TxWVlGGRUqpM0ircx9Z46PBQHCvWNjkVaMNE8cY851iDzBBwmtgOV6DVkbYREvPS2hen5j7XcgujLqXbflMzqgIsrQLSLcjGBNM7cognpNsTbQ1XH2fa9T5DRFnogbJZw5eBudKlL_YlZCpPBP6pl5UFVr9-42cOCFo.dppdPhIXgTd5nvZhJ8zJ6w&quot;
}
 
</div>   

  

</div>
</div>
          <div data-parent="[1:22]bg"><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Create the Authorization header</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.18">
      <div class="step-ref bg-step">18</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def idToken = signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div data-parent="[1:22]bg"><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.19">
      <div class="step-ref bg-step">19</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def user_header = &quot;Bearer &quot; + idToken</span>
      </div>
    </div>
    <div class="time-cell passed">9</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div data-parent="[1:22]bg"><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.20">
      <div class="step-ref bg-step">20</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print user_header</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.20">22:24:41.070 [print] Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMTk2NjgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjAwMjgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjExOTY2ODEsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.Isfer2EG1B7XtJ8Me5nJKScjRNcm4oIM4WfC4YtR1XweDLXP1Ul9M3xhDtB2GCRQZZFdRbr8qgw-otdiq_a6jFvOlkf0Cszq-4-XrSdRcsBR7D5Wn9VxR3s9ulrkhOYbrMs0YZdEutLDfYFxXyfUfv0grzi_Ck0buXrFFny56QzRe5Rw7sV4ZvTcDffsa_aKZw1YtzV8otfKvRXbMesngp2U7BtJ2_u1AuHEAQpeeeFIZ42DasN9QH3ffTz5b0ogGj49_hhRlZu3D4sM4d6gNY6LqZGOv1Hz6bpE-9xPgdGGxLMJENtsF3MnBi1gCPPVL45J9z8jh5Bo9emZext7LQ 
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Get the query from a .feature field</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.25">
      <div class="step-ref passed">25</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.25">read(&#39;UserReadModels.graphql&#39;)</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.30">
      <div class="step-ref passed">30</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.31">
      <div class="step-ref passed">31</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.32">
      <div class="step-ref passed">32</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Content-Type = &#39;application/json&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.33">
      <div class="step-ref passed">33</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39; }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.34">
      <div class="step-ref passed">34</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">258</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.34">22:24:41.077 request:
1 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
1 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMTk2NjgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjAwMjgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjExOTY2ODEsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.Isfer2EG1B7XtJ8Me5nJKScjRNcm4oIM4WfC4YtR1XweDLXP1Ul9M3xhDtB2GCRQZZFdRbr8qgw-otdiq_a6jFvOlkf0Cszq-4-XrSdRcsBR7D5Wn9VxR3s9ulrkhOYbrMs0YZdEutLDfYFxXyfUfv0grzi_Ck0buXrFFny56QzRe5Rw7sV4ZvTcDffsa_aKZw1YtzV8otfKvRXbMesngp2U7BtJ2_u1AuHEAQpeeeFIZ42DasN9QH3ffTz5b0ogGj49_hhRlZu3D4sM4d6gNY6LqZGOv1Hz6bpE-9xPgdGGxLMJENtsF3MnBi1gCPPVL45J9z8jh5Bo9emZext7LQ
1 &gt; Content-Type: application/json; charset=UTF-8
1 &gt; Content-Length: 102
1 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
1 &gt; Connection: Keep-Alive
1 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
1 &gt; Accept-Encoding: gzip,deflate
{&quot;query&quot;:&quot;query UserReadModels {\r\n    UserReadModels {\r\n        id\r\n        role\r\n    }\r\n}&quot;}

22:24:41.330 response time in milliseconds: 252
1 &lt; 200
1 &lt; Content-Type: application/json
1 &lt; Content-Length: 162
1 &lt; Connection: keep-alive
1 &lt; Date: Sun, 16 May 2021 20:24:41 GMT
1 &lt; x-amzn-RequestId: 6cbf2d4b-653b-4900-902f-4bc945fd2c0e
1 &lt; Access-Control-Allow-Origin: *
1 &lt; x-amz-apigw-id: fcDdiFTfjoEF7Tg=
1 &lt; X-Amzn-Trace-Id: Root=1-60a17f89-24552fba3cfcdd862271c380;Sampled=0
1 &lt; X-Cache: Miss from cloudfront
1 &lt; Via: 1.1 0ef74e866fd3a98abc576c37ab84cf4f.cloudfront.net (CloudFront)
1 &lt; X-Amz-Cf-Pop: MAD50-C1
1 &lt; X-Amz-Cf-Id: mCy0ePx8dLybANQJr7HkyG5X_VV7HP3mzIihPkmvNJuAmUuFGnUKrw==
{&quot;data&quot;:{&quot;UserReadModels&quot;:null},&quot;errors&quot;:[{&quot;path&quot;:[&quot;UserReadModels&quot;],&quot;locations&quot;:[{&quot;line&quot;:2,&quot;column&quot;:5}],&quot;message&quot;:&quot;Access denied for read model UserReadModel&quot;}]}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.35">
      <div class="step-ref passed">35</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.38">
      <div class="step-ref passed">38</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">7</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># As the user is not admin, the response contains a field &quot;error&quot; and it is printed</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.41">
      <div class="step-ref passed">41</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.errors != &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">13</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#Scenario: The user not admin create a new user</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.45">
      <div class="step-ref passed">45</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">4</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.45">read(&#39;SaveUser.graphql&#39;)</div>

  

  <div class="preformatted" data-parent="0.45">22:24:41.354 over-writing existing variable &#39;query&#39; with new value: read(&#39;SaveUser.graphql&#39;)
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># JSON file with the new user&#39;s datas</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.50">
      <div class="step-ref passed">50</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def user_datas = read(&#39;NewUser.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.52">
      <div class="step-ref passed">52</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.53">
      <div class="step-ref passed">53</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.54">
      <div class="step-ref passed">54</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39;,  variables: &#39;#(user_datas)&#39;}</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.55">
      <div class="step-ref passed">55</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">277</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.55">22:24:41.361 request:
2 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
2 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMTk2NjgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjAwMjgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjExOTY2ODEsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.Isfer2EG1B7XtJ8Me5nJKScjRNcm4oIM4WfC4YtR1XweDLXP1Ul9M3xhDtB2GCRQZZFdRbr8qgw-otdiq_a6jFvOlkf0Cszq-4-XrSdRcsBR7D5Wn9VxR3s9ulrkhOYbrMs0YZdEutLDfYFxXyfUfv0grzi_Ck0buXrFFny56QzRe5Rw7sV4ZvTcDffsa_aKZw1YtzV8otfKvRXbMesngp2U7BtJ2_u1AuHEAQpeeeFIZ42DasN9QH3ffTz5b0ogGj49_hhRlZu3D4sM4d6gNY6LqZGOv1Hz6bpE-9xPgdGGxLMJENtsF3MnBi1gCPPVL45J9z8jh5Bo9emZext7LQ
2 &gt; Content-Type: application/json; charset=UTF-8
2 &gt; Content-Length: 249
2 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
2 &gt; Connection: Keep-Alive
2 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
2 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;password&quot;:&quot;Password1&quot;,&quot;role&quot;:&quot;User&quot;,&quot;username&quot;:&quot;user9@test.com&quot;},&quot;query&quot;:&quot;mutation SaveUser($username: String, $password: String, $role: String) {\r\n    SaveUser(input: {username: $username, password: $password, role: $role})\r\n} &quot;}

22:24:41.635 response time in milliseconds: 273
2 &lt; 200
2 &lt; Content-Type: application/json
2 &lt; Content-Length: 144
2 &lt; Connection: keep-alive
2 &lt; Date: Sun, 16 May 2021 20:24:42 GMT
2 &lt; x-amzn-RequestId: 9f43037c-bae4-4a38-b1d9-a48ba6818aec
2 &lt; Access-Control-Allow-Origin: *
2 &lt; x-amz-apigw-id: fcDdlEp1joEFsgQ=
2 &lt; X-Amzn-Trace-Id: Root=1-60a17f8a-39224d8a13009e370d21e6b4;Sampled=0
2 &lt; X-Cache: Miss from cloudfront
2 &lt; Via: 1.1 9bac09758c086d613f2c0a80dd66c7a6.cloudfront.net (CloudFront)
2 &lt; X-Amz-Cf-Pop: MAD50-C1
2 &lt; X-Amz-Cf-Id: zWtoosoN9zwape8uLRoaLSOd_hApuX0oR1Ej6WtjTiBQOpGs98Fo6A==
{&quot;data&quot;:{&quot;SaveUser&quot;:null},&quot;errors&quot;:[{&quot;path&quot;:[&quot;SaveUser&quot;],&quot;locations&quot;:[{&quot;line&quot;:2,&quot;column&quot;:5}],&quot;message&quot;:&quot;Access denied for command &#39;SaveUser&#39;&quot;}]}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.56">
      <div class="step-ref passed">56</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Introduce a pause so the user can be saved before the next test</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.59">
      <div class="step-ref passed">59</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>wait(4000)</span>
      </div>
    </div>
    <div class="time-cell passed">4027</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># if the response status is not 200, the test finish</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.62">
      <div class="step-ref passed">62</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>if (responseStatus != 200) karate.abort()</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># As the user is not admin, the response must contains a field &quot;error&quot;</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.65">
      <div class="step-ref passed">65</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.errors != &#39;#notpresent&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment">#Scenario: List the new user by id</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Get the query from a .graphql file</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.71">
      <div class="step-ref passed">71</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def query =</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.71">read(&#39;UserReadModel.graphql&#39;)</div>

  

  <div class="preformatted" data-parent="0.71">22:24:45.665 over-writing existing variable &#39;query&#39; with new value: read(&#39;UserReadModel.graphql&#39;)
</div>   

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># Define the username of the user to list</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.77">
      <div class="step-ref passed">77</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def newUser = read(&#39;NewUser.json&#39;)</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.78">
      <div class="step-ref passed">78</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>def id =</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  <div class="preformatted" data-parent="0.78">{ 
   &quot;id&quot;: &quot;#(newUser.username)&quot;
}</div>

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.84">
      <div class="step-ref passed">84</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>print id</span>
      </div>
    </div>
    <div class="time-cell passed">1</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.84">22:24:45.669 [print] {
  &quot;id&quot;: &quot;user9@test.com&quot;
}
 
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.86">
      <div class="step-ref passed">86</div>
      
      <div class="step-cell passed">
        <span>Given</span>&nbsp;<span>path &#39;graphql&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.88">
      <div class="step-ref passed">88</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Authorization = signIn.response.tokenType + &#39; &#39; + signIn.response.idToken</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.89">
      <div class="step-ref passed">89</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>header Content-Type = &#39;application/json&#39;</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.90">
      <div class="step-ref passed">90</div>
      
      <div class="step-cell passed">
        <span>And</span>&nbsp;<span>request { query: &#39;#(query)&#39;, variables: &#39;#(id)&#39; }</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.91">
      <div class="step-ref passed">91</div>
      
      <div class="step-cell passed">
        <span>When</span>&nbsp;<span>method post</span>
      </div>
    </div>
    <div class="time-cell passed">269</div>
  </div>

   
  
  

  

  <div class="preformatted" data-parent="0.91">22:24:45.671 request:
3 &gt; POST https://pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com/test-qa-estrella-prod/graphql
3 &gt; Authorization: Bearer eyJraWQiOiJHa3NQT29DVkd3b2NMV0ROZ0tvNVE0R3ViRFNUV0xNeDhHYVJmSFZcL0U3QT0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyYWQ2MWM2Yi02OTNjLTQ3OTgtYjJjZS01NGRiOWFiMDdhMGEiLCJhdWQiOiI3OTlob2d1Y20zNjN2NTVsN2RrMm4xbDV1MCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJldmVudF9pZCI6IjA2ODdmYzZlLWFhNjYtNDNlZS04ZGJiLWVjZDQ4ZjIyYjZhNCIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxNjIxMTk2NjgxLCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuZXUtd2VzdC0xLmFtYXpvbmF3cy5jb21cL2V1LXdlc3QtMV9tSHVlQXIyUXUiLCJjb2duaXRvOnVzZXJuYW1lIjoiMmFkNjFjNmItNjkzYy00Nzk4LWIyY2UtNTRkYjlhYjA3YTBhIiwiZXhwIjoxNjIxMjAwMjgxLCJjdXN0b206cm9sZSI6InVzZXIiLCJpYXQiOjE2MjExOTY2ODEsImVtYWlsIjoidXNlcjhAdGVzdC5jb20ifQ.Isfer2EG1B7XtJ8Me5nJKScjRNcm4oIM4WfC4YtR1XweDLXP1Ul9M3xhDtB2GCRQZZFdRbr8qgw-otdiq_a6jFvOlkf0Cszq-4-XrSdRcsBR7D5Wn9VxR3s9ulrkhOYbrMs0YZdEutLDfYFxXyfUfv0grzi_Ck0buXrFFny56QzRe5Rw7sV4ZvTcDffsa_aKZw1YtzV8otfKvRXbMesngp2U7BtJ2_u1AuHEAQpeeeFIZ42DasN9QH3ffTz5b0ogGj49_hhRlZu3D4sM4d6gNY6LqZGOv1Hz6bpE-9xPgdGGxLMJENtsF3MnBi1gCPPVL45J9z8jh5Bo9emZext7LQ
3 &gt; Content-Type: application/json; charset=UTF-8
3 &gt; Content-Length: 155
3 &gt; Host: pnbbxqm2y9.execute-api.eu-west-1.amazonaws.com
3 &gt; Connection: Keep-Alive
3 &gt; User-Agent: Apache-HttpClient/4.5.13 (Java/16.0.1)
3 &gt; Accept-Encoding: gzip,deflate
{&quot;variables&quot;:{&quot;id&quot;:&quot;user9@test.com&quot;},&quot;query&quot;:&quot;query UserReadModel($id: ID!) {\r\n    UserReadModel(id: $id) {\r\n        id\r\n        role\r\n    }\r\n}&quot;}

22:24:45.938 response time in milliseconds: 267
3 &lt; 200
3 &lt; Content-Type: application/json
3 &lt; Content-Length: 160
3 &lt; Connection: keep-alive
3 &lt; Date: Sun, 16 May 2021 20:24:46 GMT
3 &lt; x-amzn-RequestId: bdab4d12-edf6-419a-97f2-cfed9a5e885f
3 &lt; Access-Control-Allow-Origin: *
3 &lt; x-amz-apigw-id: fcDeQGP4joEFcMw=
3 &lt; X-Amzn-Trace-Id: Root=1-60a17f8e-2adcfe6b792ed9151eb928b9;Sampled=0
3 &lt; X-Cache: Miss from cloudfront
3 &lt; Via: 1.1 adaa7e69b304066aa4eaf0d2190ecfd7.cloudfront.net (CloudFront)
3 &lt; X-Amz-Cf-Pop: MAD50-C1
3 &lt; X-Amz-Cf-Id: 8ffN6GduTQE8I84NGJ5CQDbjucO5UB3l7dXCsWcdQGecYphka7o8LQ==
{&quot;data&quot;:{&quot;UserReadModel&quot;:null},&quot;errors&quot;:[{&quot;path&quot;:[&quot;UserReadModel&quot;],&quot;locations&quot;:[{&quot;line&quot;:2,&quot;column&quot;:5}],&quot;message&quot;:&quot;Access denied for read model UserReadModel&quot;}]}
</div>   

  

</div>
</div>
          <div><div>
  

  

  <div class="step-row">
    <div class="step-container" id="0.92">
      <div class="step-ref passed">92</div>
      
      <div class="step-cell passed">
        <span>Then</span>&nbsp;<span>status 200</span>
      </div>
    </div>
    <div class="time-cell passed">0</div>
  </div>

   
  
  

  

     

  

</div>
</div>
          <div><div>
  

  <div class="step-row">
    <div class="step-container">
      <div class="step-ref passed"></div>
      
      <div class="step-cell comment"># As the user is not admin, the response of the query shouldn&#39;t contain the datas of the user tryed to saved</div>
    </div>
    <div class="time-cell comment"></div>            
  </div>

  <div class="step-row">
    <div class="step-container" id="0.95">
      <div class="step-ref passed">95</div>
      
      <div class="step-cell passed">
        <span>*</span>&nbsp;<span>match response.data.UserReadModel != {id: &#39;#(newUser.username)&#39;, role: &#39;#(newUser.role)&#39; }</span>
      </div>
    </div>
    <div class="time-cell passed">2</div>
  </div>

   
  
  

  

     

  

</div>
</div>
        </div>
      </div>
    </div>
  </body>
</html>

